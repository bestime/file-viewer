!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).jUtilsBase={})}(this,(function(t){"use strict";var e="undefined"!=typeof document?document.currentScript:null;function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function i(t){if(Array.isArray(t))return t}function r(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function a(t){var e,n,i,r=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,i=Symbol.iterator);r--;){if(n&&null!=(e=t[n]))return e.call(t);if(i&&null!=(e=t[i]))return new s(e.call(t));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}function s(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return s=function(t){this.s=t,this.n=t.next},s.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},"return":function(t){var n=this.s["return"];return void 0===n?Promise.resolve({value:t,done:!0}):e(n.apply(this.s,arguments))},"throw":function(t){var n=this.s["return"];return void 0===n?Promise.reject(t):e(n.apply(this.s,arguments))}},new s(t)}function o(t,e,n,i,r,a,s){try{var o=t[a](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function s(t){o(a,i,r,s,l,"next",t)}function l(t){o(a,i,r,s,l,"throw",t)}s(void 0)}))}}function u(t,e,n){return e=A(e),function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,x()?Reflect.construct(e,n||[],A(t).constructor):e.apply(t,n))}function h(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){return t.get(r(t,e))}function f(t,e,n){h(t,e),e.set(t,n)}function v(t,e,n){return t.set(r(t,e),n),n}function p(t,e,n){return n(r(t,e))}function g(t,e){h(t,e),e.add(t)}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,N(i.key),i)}}function m(t,e,n){return e&&y(t.prototype,e),n&&y(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function w(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=j(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==n["return"]||n["return"]()}finally{if(o)throw a}}}}function b(t,e,n){return(e=N(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k(){return k="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=A(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},k.apply(null,arguments)}function A(t){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},A(t)}function _(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&I(t,e)}function x(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(x=function(){return!!t})()}function S(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function E(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(Object(n),!0).forEach((function(e){b(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function T(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var t,e,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function a(n,i,r,a){var l=i&&i.prototype instanceof o?i:o,u=Object.create(l.prototype);return R(u,"_invoke",function(n,i,r){var a,o,l,u=0,h=r||[],c=!1,d={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return a=e,o=0,l=t,d.n=n,s}};function f(n,i){for(o=n,l=i,e=0;!c&&u&&!r&&e<h.length;e++){var r,a=h[e],f=d.p,v=a[2];n>3?(r=v===i)&&(l=a[(o=a[4])?5:(o=3,3)],a[4]=a[5]=t):a[0]<=f&&((r=n<2&&f<a[1])?(o=0,d.v=i,d.n=a[1]):f<v&&(r=n<3||a[0]>i||i>v)&&(a[4]=n,a[5]=i,d.n=v,o=0))}if(r||n>1)return s;throw c=!0,i}return function(r,h,v){if(u>1)throw TypeError("Generator is already running");for(c&&1===h&&f(h,v),o=h,l=v;(e=o<2?t:l)||!c;){a||(o?o<3?(o>1&&(d.n=-1),f(o,l)):d.n=l:d.v=l);try{if(u=2,a){if(o||(r="next"),e=a[r]){if(!(e=e.call(a,l)))throw TypeError("iterator result is not an object");if(!e.done)return e;l=e.value,o<2&&(o=0)}else 1===o&&(e=a["return"])&&e.call(a),o<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),o=1);a=t}else if((e=(c=d.n<0)?l:n.call(i,d))!==s)break}catch(e){a=t,o=1,l=e}finally{u=1}}return{value:e,done:c}}}(n,r,a),!0),u}var s={};function o(){}function l(){}function u(){}e=Object.getPrototypeOf;var h=[][i]?e(e([][i]())):(R(e={},i,(function(){return this})),e),c=u.prototype=o.prototype=Object.create(h);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,R(t,r,"GeneratorFunction")),t.prototype=Object.create(c),t}return l.prototype=u,R(c,"constructor",u),R(u,"constructor",l),l.displayName="GeneratorFunction",R(u,r,"GeneratorFunction"),R(c),R(c,r,"Generator"),R(c,i,(function(){return this})),R(c,"toString",(function(){return"[object Generator]"})),(T=function(){return{w:a,m:d}})()}function R(t,e,n,i){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}R=function(t,e,n,i){if(e)r?r(t,e,{value:n,enumerable:!i,configurable:!i,writable:!i}):t[e]=n;else{function a(e,n){R(t,e,(function(t){return this._invoke(e,n,t)}))}a("next",0),a("throw",1),a("return",2)}},R(t,e,n,i)}function P(t){var e=Object(t),n=[];for(var i in e)n.unshift(i);return function r(){for(;n.length;)if((i=n.pop())in e)return r.value=i,r.done=!1,r;return r.done=!0,r}}function I(t,e){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},I(t,e)}function D(t,e){return i(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){u=!0,r=t}finally{try{if(!l&&null!=n["return"]&&(s=n["return"](),Object(s)!==s))return}finally{if(u)throw r}}return o}}(t,e)||j(t,e)||E()}function L(t,e,n,i){var r=k(A(1&i?t.prototype:t),e,n);return 2&i&&"function"==typeof r?function(t){return r.apply(n,t)}:r}function O(t){return i(t)||S(t)||j(t)||E()}function F(t){return function(t){if(Array.isArray(t))return n(t)}(t)||S(t)||j(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}function W(t,e,n){e||(e=[]);var i=e.length++;return Object.defineProperty({},"_",{set:function(r){e[i]=r,t.apply(n,e)}})}function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function j(t,e){if(t){if("string"==typeof t)return n(t,e);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}}var H,U,z="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},G={};function V(){if(U)return H;U=1;var t=function(t){return t&&t.Math===Math&&t};return H=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof z&&z)||t("object"==typeof H&&H)||function(){return this}()||Function("return this")()}var q,X,Y,K,Q,J,Z,$,tt={};function et(){return X?q:(X=1,q=function(t){try{return!!t()}catch(e){return!0}})}function nt(){if(K)return Y;K=1;var t=et();return Y=!t((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))}function it(){if(J)return Q;J=1;var t=et();return Q=!t((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))}function rt(){if($)return Z;$=1;var t=it(),e=Function.prototype.call;return Z=t?e.bind(e):function(){return e.apply(e,arguments)},Z}var at,st,ot,lt,ut,ht,ct,dt,ft,vt,pt,gt,yt,mt,wt,bt,kt,At,_t,xt,St,Et,Mt,Ct,Tt,Rt,Pt,It,Dt,Lt,Ot,Ft,Nt,Wt,Bt,jt,Ht,Ut,zt,Gt,Vt,qt={};function Xt(){return ot?st:(ot=1,st=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}})}function Yt(){if(ut)return lt;ut=1;var t=it(),e=Function.prototype,n=e.call,i=t&&e.bind.bind(n,n);return lt=t?i:function(t){return function(){return n.apply(t,arguments)}},lt}function Kt(){if(ft)return dt;ft=1;var t=Yt(),e=et(),n=function(){if(ct)return ht;ct=1;var t=Yt(),e=t({}.toString),n=t("".slice);return ht=function(t){return n(e(t),8,-1)}}(),i=Object,r=t("".split);return dt=e((function(){return!i("z").propertyIsEnumerable(0)}))?function(t){return"String"===n(t)?r(t,""):i(t)}:i}function Qt(){return pt?vt:(pt=1,vt=function(t){return null===t||t===undefined})}function Jt(){if(yt)return gt;yt=1;var t=Qt(),e=TypeError;return gt=function(n){if(t(n))throw new e("Can't call method on "+n);return n}}function Zt(){if(wt)return mt;wt=1;var t=Kt(),e=Jt();return mt=function(n){return t(e(n))}}function $t(){if(kt)return bt;kt=1;var t="object"==typeof document&&document.all;return bt=void 0===t&&t!==undefined?function(e){return"function"==typeof e||e===t}:function(t){return"function"==typeof t}}function te(){if(_t)return At;_t=1;var t=$t();return At=function(e){return"object"==typeof e?null!==e:t(e)}}function ee(){if(St)return xt;St=1;var t=V(),e=$t();return xt=function(n,i){return arguments.length<2?(r=t[n],e(r)?r:undefined):t[n]&&t[n][i];var r},xt}function ne(){if(Pt)return Rt;Pt=1;var t,e,n=V(),i=function(){if(Tt)return Ct;Tt=1;var t=V().navigator,e=t&&t.userAgent;return Ct=e?String(e):""}(),r=n.process,a=n.Deno,s=r&&r.versions||a&&a.version,o=s&&s.v8;return o&&(e=(t=o.split("."))[0]>0&&t[0]<4?1:+(t[0]+t[1])),!e&&i&&(!(t=i.match(/Edge\/(\d+)/))||t[1]>=74)&&(t=i.match(/Chrome\/(\d+)/))&&(e=+t[1]),Rt=e}function ie(){if(Dt)return It;Dt=1;var t=ne(),e=et(),n=V().String;return It=!!Object.getOwnPropertySymbols&&!e((function(){var e=Symbol("symbol detection");return!n(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&t&&t<41}))}function re(){if(Ot)return Lt;Ot=1;var t=ie();return Lt=t&&!Symbol.sham&&"symbol"==typeof Symbol.iterator}function ae(){if(Nt)return Ft;Nt=1;var t=ee(),e=$t(),n=function(){if(Mt)return Et;Mt=1;var t=Yt();return Et=t({}.isPrototypeOf)}(),i=re(),r=Object;return Ft=i?function(t){return"symbol"==typeof t}:function(i){var a=t("Symbol");return e(a)&&n(a.prototype,r(i))}}function se(){if(Bt)return Wt;Bt=1;var t=String;return Wt=function(e){try{return t(e)}catch(n){return"Object"}}}function oe(){if(Ht)return jt;Ht=1;var t=$t(),e=se(),n=TypeError;return jt=function(i){if(t(i))return i;throw new n(e(i)+" is not a function")}}function le(){if(zt)return Ut;zt=1;var t=oe(),e=Qt();return Ut=function(n,i){var r=n[i];return e(r)?undefined:t(r)}}function ue(){if(Vt)return Gt;Vt=1;var t=rt(),e=$t(),n=te(),i=TypeError;return Gt=function(r,a){var s,o;if("string"===a&&e(s=r.toString)&&!n(o=t(s,r)))return o;if(e(s=r.valueOf)&&!n(o=t(s,r)))return o;if("string"!==a&&e(s=r.toString)&&!n(o=t(s,r)))return o;throw new i("Can't convert object to primitive value")}}var he,ce,de,fe,ve,pe,ge,ye,me,we,be,ke,Ae,_e,xe,Se,Ee,Me,Ce,Te,Re,Pe,Ie,De,Le={exports:{}};function Oe(){if(fe)return de;fe=1;var t=V(),e=Object.defineProperty;return de=function(n,i){try{e(t,n,{value:i,configurable:!0,writable:!0})}catch(r){t[n]=i}return i}}function Fe(){if(ve)return Le.exports;ve=1;var t=ce?he:(ce=1,he=!1),e=V(),n=Oe(),i="__core-js_shared__",r=Le.exports=e[i]||n(i,{});return(r.versions||(r.versions=[])).push({version:"3.44.0",mode:t?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.44.0/LICENSE",source:"https://github.com/zloirock/core-js"}),Le.exports}function Ne(){if(ge)return pe;ge=1;var t=Fe();return pe=function(e,n){return t[e]||(t[e]=n||{})}}function We(){if(me)return ye;me=1;var t=Jt(),e=Object;return ye=function(n){return e(t(n))}}function Be(){if(be)return we;be=1;var t=Yt(),e=We(),n=t({}.hasOwnProperty);return we=Object.hasOwn||function(t,i){return n(e(t),i)}}function je(){if(Ae)return ke;Ae=1;var t=Yt(),e=0,n=Math.random(),i=t(1.1.toString);return ke=function(t){return"Symbol("+(t===undefined?"":t)+")_"+i(++e+n,36)}}function He(){if(xe)return _e;xe=1;var t=V(),e=Ne(),n=Be(),i=je(),r=ie(),a=re(),s=t.Symbol,o=e("wks"),l=a?s["for"]||s:s&&s.withoutSetter||i;return _e=function(t){return n(o,t)||(o[t]=r&&n(s,t)?s[t]:l("Symbol."+t)),o[t]}}function Ue(){if(Ee)return Se;Ee=1;var t=rt(),e=te(),n=ae(),i=le(),r=ue(),a=He(),s=TypeError,o=a("toPrimitive");return Se=function(a,l){if(!e(a)||n(a))return a;var u,h=i(a,o);if(h){if(l===undefined&&(l="default"),u=t(h,a,l),!e(u)||n(u))return u;throw new s("Can't convert object to primitive value")}return l===undefined&&(l="number"),r(a,l)}}function ze(){if(Ce)return Me;Ce=1;var t=Ue(),e=ae();return Me=function(n){var i=t(n,"string");return e(i)?i:i+""}}function Ge(){if(Re)return Te;Re=1;var t=V(),e=te(),n=t.document,i=e(n)&&e(n.createElement);return Te=function(t){return i?n.createElement(t):{}}}function Ve(){if(Ie)return Pe;Ie=1;var t=nt(),e=et(),n=Ge();return Pe=!t&&!e((function(){return 7!==Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a}))}function qe(){if(De)return tt;De=1;var t=nt(),e=rt(),n=function(){if(at)return qt;at=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return qt.f=n?function(t){var n=e(this,t);return!!n&&n.enumerable}:t,qt}(),i=Xt(),r=Zt(),a=ze(),s=Be(),o=Ve(),l=Object.getOwnPropertyDescriptor;return tt.f=t?l:function(t,u){if(t=r(t),u=a(u),o)try{return l(t,u)}catch(h){}if(s(t,u))return i(!e(n.f,t,u),t[u])},tt}var Xe,Ye,Ke,Qe,Je,Ze,$e,tn={};function en(){if(Ye)return Xe;Ye=1;var t=nt(),e=et();return Xe=t&&e((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))}function nn(){if(Qe)return Ke;Qe=1;var t=te(),e=String,n=TypeError;return Ke=function(i){if(t(i))return i;throw new n(e(i)+" is not an object")}}function rn(){if(Je)return tn;Je=1;var t=nt(),e=Ve(),n=en(),i=nn(),r=ze(),a=TypeError,s=Object.defineProperty,o=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",h="writable";return tn.f=t?n?function(t,e,n){if(i(t),e=r(e),i(n),"function"==typeof t&&"prototype"===e&&"value"in n&&h in n&&!n[h]){var a=o(t,e);a&&a[h]&&(t[e]=n.value,n={configurable:u in n?n[u]:a[u],enumerable:l in n?n[l]:a[l],writable:!1})}return s(t,e,n)}:s:function(t,n,o){if(i(t),n=r(n),i(o),e)try{return s(t,n,o)}catch(l){}if("get"in o||"set"in o)throw new a("Accessors not supported");return"value"in o&&(t[n]=o.value),t},tn}function an(){if($e)return Ze;$e=1;var t=nt(),e=rn(),n=Xt();return Ze=t?function(t,i,r){return e.f(t,i,n(1,r))}:function(t,e,n){return t[e]=n,t}}var sn,on,ln,un,hn,cn,dn,fn,vn,pn,gn,yn,mn,wn,bn,kn={exports:{}};function An(){if(un)return ln;un=1;var t=Yt(),e=$t(),n=Fe(),i=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(t){return i(t)}),ln=n.inspectSource}function _n(){if(fn)return dn;fn=1;var t=Ne(),e=je(),n=t("keys");return dn=function(t){return n[t]||(n[t]=e(t))}}function xn(){return pn?vn:(pn=1,vn={})}function Sn(){if(yn)return gn;yn=1;var t,e,n,i=function(){if(cn)return hn;cn=1;var t=V(),e=$t(),n=t.WeakMap;return hn=e(n)&&/native code/.test(String(n))}(),r=V(),a=te(),s=an(),o=Be(),l=Fe(),u=_n(),h=xn(),c="Object already initialized",d=r.TypeError,f=r.WeakMap;if(i||l.state){var v=l.state||(l.state=new f);v.get=v.get,v.has=v.has,v.set=v.set,t=function(t,e){if(v.has(t))throw new d(c);return e.facade=t,v.set(t,e),e},e=function(t){return v.get(t)||{}},n=function(t){return v.has(t)}}else{var p=u("state");h[p]=!0,t=function(t,e){if(o(t,p))throw new d(c);return e.facade=t,s(t,p,e),e},e=function(t){return o(t,p)?t[p]:{}},n=function(t){return o(t,p)}}return gn={set:t,get:e,has:n,enforce:function(i){return n(i)?e(i):t(i,{})},getterFor:function(t){return function(n){var i;if(!a(n)||(i=e(n)).type!==t)throw new d("Incompatible receiver, "+t+" required");return i}}}}function En(){if(mn)return kn.exports;mn=1;var t=Yt(),e=et(),n=$t(),i=Be(),r=nt(),a=function(){if(on)return sn;on=1;var t=nt(),e=Be(),n=Function.prototype,i=t&&Object.getOwnPropertyDescriptor,r=e(n,"name"),a=r&&"something"===function(){}.name,s=r&&(!t||t&&i(n,"name").configurable);return sn={EXISTS:r,PROPER:a,CONFIGURABLE:s}}().CONFIGURABLE,s=An(),o=Sn(),l=o.enforce,u=o.get,h=String,c=Object.defineProperty,d=t("".slice),f=t("".replace),v=t([].join),p=r&&!e((function(){return 8!==c((function(){}),"length",{value:8}).length})),g=String(String).split("String"),y=kn.exports=function(t,e,n){"Symbol("===d(h(e),0,7)&&(e="["+f(h(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!i(t,"name")||a&&t.name!==e)&&(r?c(t,"name",{value:e,configurable:!0}):t.name=e),p&&n&&i(n,"arity")&&t.length!==n.arity&&c(t,"length",{value:n.arity});try{n&&i(n,"constructor")&&n.constructor?r&&c(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=undefined)}catch(o){}var s=l(t);return i(s,"source")||(s.source=v(g,"string"==typeof e?e:"")),t};return Function.prototype.toString=y((function(){return n(this)&&u(this).source||s(this)}),"toString"),kn.exports}function Mn(){if(bn)return wn;bn=1;var t=$t(),e=rn(),n=En(),i=Oe();return wn=function(r,a,s,o){o||(o={});var l=o.enumerable,u=o.name!==undefined?o.name:a;if(t(s)&&n(s,u,o),o.global)l?r[a]=s:i(a,s);else{try{o.unsafe?r[a]&&(l=!0):delete r[a]}catch(h){}l?r[a]=s:e.f(r,a,{value:s,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return r}}var Cn,Tn,Rn,Pn,In,Dn,Ln,On,Fn,Nn,Wn,Bn,jn,Hn,Un,zn,Gn,Vn={};function qn(){if(Pn)return Rn;Pn=1;var t=function(){if(Tn)return Cn;Tn=1;var t=Math.ceil,e=Math.floor;return Cn=Math.trunc||function(n){var i=+n;return(i>0?e:t)(i)}}();return Rn=function(e){var n=+e;return n!=n||0===n?0:t(n)}}function Xn(){if(Dn)return In;Dn=1;var t=qn(),e=Math.max,n=Math.min;return In=function(i,r){var a=t(i);return a<0?e(a+r,0):n(a,r)}}function Yn(){if(On)return Ln;On=1;var t=qn(),e=Math.min;return Ln=function(n){var i=t(n);return i>0?e(i,9007199254740991):0}}function Kn(){if(Nn)return Fn;Nn=1;var t=Yn();return Fn=function(e){return t(e.length)}}function Qn(){if(Hn)return jn;Hn=1;var t=Yt(),e=Be(),n=Zt(),i=function(){if(Bn)return Wn;Bn=1;var t=Zt(),e=Xn(),n=Kn(),i=function(i){return function(r,a,s){var o=t(r),l=n(o);if(0===l)return!i&&-1;var u,h=e(s,l);if(i&&a!=a){for(;l>h;)if((u=o[h++])!=u)return!0}else for(;l>h;h++)if((i||h in o)&&o[h]===a)return i||h||0;return!i&&-1}};return Wn={includes:i(!0),indexOf:i(!1)}}().indexOf,r=xn(),a=t([].push);return jn=function(t,s){var o,l=n(t),u=0,h=[];for(o in l)!e(r,o)&&e(l,o)&&a(h,o);for(;s.length>u;)e(l,o=s[u++])&&(~i(h,o)||a(h,o));return h}}function Jn(){return zn?Un:(zn=1,Un=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"])}var Zn,$n,ti,ei,ni,ii,ri,ai,si,oi={};function li(){if(ti)return $n;ti=1;var t=ee(),e=Yt(),n=function(){if(Gn)return Vn;Gn=1;var t=Qn(),e=Jn().concat("length","prototype");return Vn.f=Object.getOwnPropertyNames||function(n){return t(n,e)},Vn}(),i=(Zn||(Zn=1,oi.f=Object.getOwnPropertySymbols),oi),r=nn(),a=e([].concat);return $n=t("Reflect","ownKeys")||function(t){var e=n.f(r(t)),s=i.f;return s?a(e,s(t)):e}}function ui(){if(ni)return ei;ni=1;var t=Be(),e=li(),n=qe(),i=rn();return ei=function(r,a,s){for(var o=e(a),l=i.f,u=n.f,h=0;h<o.length;h++){var c=o[h];t(r,c)||s&&t(s,c)||l(r,c,u(a,c))}}}function hi(){if(si)return ai;si=1;var t=V(),e=qe().f,n=an(),i=Mn(),r=Oe(),a=ui(),s=function(){if(ri)return ii;ri=1;var t=et(),e=$t(),n=/#|\.prototype\./,i=function(n,i){var l=a[r(n)];return l===o||l!==s&&(e(i)?t(i):!!i)},r=i.normalize=function(t){return String(t).replace(n,".").toLowerCase()},a=i.data={},s=i.NATIVE="N",o=i.POLYFILL="P";return ii=i}();return ai=function(o,l){var u,h,c,d,f,v=o.target,p=o.global,g=o.stat;if(u=p?t:g?t[v]||r(v,{}):t[v]&&t[v].prototype)for(h in l){if(d=l[h],c=o.dontCallGetSet?(f=e(u,h))&&f.value:u[h],!s(p?h:v+(g?".":"#")+h,o.forced)&&c!==undefined){if(typeof d==typeof c)continue;a(d,c)}(o.sham||c&&c.sham)&&n(d,"sham",!0),i(u,h,d,o)}}}var ci,di,fi,vi,pi,gi,yi,mi,wi,bi,ki,Ai,_i,xi,Si,Ei,Mi,Ci,Ti,Ri,Pi,Ii,Di,Li,Oi,Fi={};function Ni(){if(di)return ci;di=1;var t=Qn(),e=Jn();return ci=Object.keys||function(n){return t(n,e)}}function Wi(){if(pi)return vi;pi=1;var t=ee();return vi=t("document","documentElement")}function Bi(){if(yi)return gi;yi=1;var t,e=nn(),n=function(){if(fi)return Fi;fi=1;var t=nt(),e=en(),n=rn(),i=nn(),r=Zt(),a=Ni();return Fi.f=t&&!e?Object.defineProperties:function(t,e){i(t);for(var s,o=r(e),l=a(e),u=l.length,h=0;u>h;)n.f(t,s=l[h++],o[s]);return t},Fi}(),i=Jn(),r=xn(),a=Wi(),s=Ge(),o=_n(),l="prototype",u="script",h=o("IE_PROTO"),c=function(){},d=function(t){return"<"+u+">"+t+"</"+u+">"},f=function(t){t.write(d("")),t.close();var e=t.parentWindow.Object;return t=null,e},v=function(){try{t=new ActiveXObject("htmlfile")}catch(h){}var e,n,r;v="undefined"!=typeof document?document.domain&&t?f(t):(n=s("iframe"),r="java"+u+":",n.style.display="none",a.appendChild(n),n.src=String(r),(e=n.contentWindow.document).open(),e.write(d("document.F=Object")),e.close(),e.F):f(t);for(var o=i.length;o--;)delete v[l][i[o]];return v()};return r[h]=!0,gi=Object.create||function(t,i){var r;return null!==t?(c[l]=e(t),r=new c,c[l]=null,r[h]=t):r=v(),i===undefined?r:n.f(r,i)}}function ji(){if(wi)return mi;wi=1;var t=He(),e=Bi(),n=rn().f,i=t("unscopables"),r=Array.prototype;return r[i]===undefined&&n(r,i,{configurable:!0,value:e(null)}),mi=function(t){r[i][t]=!0}}!function(){if(bi)return G;bi=1;var t=hi(),e=We(),n=Kn(),i=qn(),r=ji();t({target:"Array",proto:!0},{at:function(t){var r=e(this),a=n(r),s=i(t),o=s>=0?s:a+s;return o<0||o>=a?undefined:r[o]}}),r("at")}();
/**
 * @licstart The following is the entire license notice for the
 * JavaScript code in this page
 *
 * Copyright 2024 Mozilla Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * @licend The above is the entire license notice for the
 * JavaScript code in this page
 */var Hi={34:function(t,e,n){var i=n(4901);t.exports=function(t){return"object"==B(t)?null!==t:i(t)}},81:function(t,e,n){var i=n(9565),r=n(9306),a=n(8551),s=n(6823),o=n(851),l=TypeError;t.exports=function(t,e){var n=arguments.length<2?o(t):e;if(r(n))return a(i(n,t));throw new l(s(t)+" is not iterable")}},283:function(t,e,n){var i=n(9504),r=n(9039),a=n(4901),s=n(9297),o=n(3724),l=n(350).CONFIGURABLE,u=n(3706),h=n(1181),c=h.enforce,d=h.get,f=String,v=Object.defineProperty,p=i("".slice),g=i("".replace),y=i([].join),m=o&&!r((function(){return 8!==v((function(){}),"length",{value:8}).length})),w=String(String).split("String"),b=t.exports=function(t,e,n){"Symbol("===p(f(e),0,7)&&(e="["+g(f(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!s(t,"name")||l&&t.name!==e)&&(o?v(t,"name",{value:e,configurable:!0}):t.name=e),m&&n&&s(n,"arity")&&t.length!==n.arity&&v(t,"length",{value:n.arity});try{n&&s(n,"constructor")&&n.constructor?o&&v(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=undefined)}catch(r){}var i=c(t);return s(i,"source")||(i.source=y(w,"string"==typeof e?e:"")),t};Function.prototype.toString=b((function(){return a(this)&&d(this).source||u(this)}),"toString")},350:function(t,e,n){var i=n(3724),r=n(9297),a=Function.prototype,s=i&&Object.getOwnPropertyDescriptor,o=r(a,"name"),l=o&&"something"===function(){}.name,u=o&&(!i||i&&s(a,"name").configurable);t.exports={EXISTS:o,PROPER:l,CONFIGURABLE:u}},397:function(t,e,n){var i=n(7751);t.exports=i("document","documentElement")},421:function(t){t.exports={}},507:function(t,e,n){var i=n(9565);t.exports=function(t,e,n){for(var r,a,s=n?t:t.iterator,o=t.next;!(r=i(o,s)).done;)if((a=e(r.value))!==undefined)return a}},531:function(t,e,n){var i=n(6518),r=n(9565),a=n(9306),s=n(8551),o=n(1767),l=n(8646),u=n(9462),h=n(9539),c=n(6395),d=n(684),f=n(4549),v=!c&&!d("flatMap",(function(){})),p=!c&&!v&&f("flatMap",TypeError),g=c||v||p,y=u((function(){for(var t,e,n=this.iterator,i=this.mapper;;){if(e=this.inner)try{if(!(t=s(r(e.next,e.iterator))).done)return t.value;this.inner=null}catch(a){h(n,"throw",a)}if(t=s(r(this.next,n)),this.done=!!t.done)return;try{this.inner=l(i(t.value,this.counter++),!1)}catch(a){h(n,"throw",a)}}}));i({target:"Iterator",proto:!0,real:!0,forced:g},{flatMap:function(t){s(this);try{a(t)}catch(e){h(this,"throw",e)}return p?r(p,this,t):new y(o(this),{mapper:t,inner:null})}})},616:function(t,e,n){var i=n(9039);t.exports=!i((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},655:function(t,e,n){var i=n(6955),r=String;t.exports=function(t){if("Symbol"===i(t))throw new TypeError("Cannot convert a Symbol value to a string");return r(t)}},679:function(t,e,n){var i=n(1625),r=TypeError;t.exports=function(t,e){if(i(e,t))return t;throw new r("Incorrect invocation")}},684:function(t){t.exports=function(t,e){var n="function"==typeof Iterator&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch(i){return!0}}},741:function(t){var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var i=+t;return(i>0?n:e)(i)}},757:function(t,e,n){var i=n(7751),r=n(4901),a=n(1625),s=n(7040),o=Object;t.exports=s?function(t){return"symbol"==B(t)}:function(t){var e=i("Symbol");return r(e)&&a(e.prototype,o(t))}},851:function(t,e,n){var i=n(6955),r=n(5966),a=n(4117),s=n(6269),o=n(8227)("iterator");t.exports=function(t){if(!a(t))return r(t,o)||r(t,"@@iterator")||s[i(t)]}},944:function(t){var e=TypeError;t.exports=function(t){var n=t&&t.alphabet;if(n===undefined||"base64"===n||"base64url"===n)return n||"base64";throw new e("Incorrect `alphabet` option")}},1072:function(t,e,n){var i=n(1828),r=n(8727);t.exports=Object.keys||function(t){return i(t,r)}},1103:function(t){t.exports=function(t){try{return{error:!1,value:t()}}catch(e){return{error:!0,value:e}}}},1108:function(t,e,n){var i=n(6955);t.exports=function(t){var e=i(t);return"BigInt64Array"===e||"BigUint64Array"===e}},1148:function(t,e,n){var i=n(6518),r=n(9565),a=n(2652),s=n(9306),o=n(8551),l=n(1767),u=n(9539),h=n(4549)("every",TypeError);i({target:"Iterator",proto:!0,real:!0,forced:h},{every:function(t){o(this);try{s(t)}catch(i){u(this,"throw",i)}if(h)return r(h,this,t);var e=l(this),n=0;return!a(e,(function(e,i){if(!t(e,n++))return i()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},1181:function(t,e,n){var i,r,a,s=n(8622),o=n(4576),l=n(34),u=n(6699),h=n(9297),c=n(7629),d=n(6119),f=n(421),v="Object already initialized",p=o.TypeError,g=o.WeakMap;if(s||c.state){var y=c.state||(c.state=new g);y.get=y.get,y.has=y.has,y.set=y.set,i=function(t,e){if(y.has(t))throw new p(v);return e.facade=t,y.set(t,e),e},r=function(t){return y.get(t)||{}},a=function(t){return y.has(t)}}else{var m=d("state");f[m]=!0,i=function(t,e){if(h(t,m))throw new p(v);return e.facade=t,u(t,m,e),e},r=function(t){return h(t,m)?t[m]:{}},a=function(t){return h(t,m)}}t.exports={set:i,get:r,has:a,enforce:function(t){return a(t)?r(t):i(t,{})},getterFor:function(t){return function(e){var n;if(!l(e)||(n=r(e)).type!==t)throw new p("Incompatible receiver, "+t+" required");return n}}}},1291:function(t,e,n){var i=n(741);t.exports=function(t){var e=+t;return e!=e||0===e?0:i(e)}},1385:function(t,e,n){var i=n(9539);t.exports=function(t,e,n){for(var r=t.length-1;r>=0;r--)if(t[r]!==undefined)try{n=i(t[r].iterator,e,n)}catch(a){e="throw",n=a}if("throw"===e)throw n;return n}},1548:function(t,e,n){var i=n(4576),r=n(9039),a=n(9519),s=n(4215),o=i.structuredClone;t.exports=!!o&&!r((function(){if("DENO"===s&&a>92||"NODE"===s&&a>94||"BROWSER"===s&&a>97)return!1;var t=new ArrayBuffer(8),e=o(t,{transfer:[t]});return 0!==t.byteLength||8!==e.byteLength}))},1549:function(t,e,n){var i=n(6518),r=n(4576),a=n(9143),s=n(4154),o=r.Uint8Array,l=!o||!o.prototype.setFromBase64||!function(){var t=new o([255,255,255,255,255]);try{return void t.setFromBase64("",null)}catch(e){}try{t.setFromBase64("MjYyZg===")}catch(e){return 50===t[0]&&54===t[1]&&50===t[2]&&255===t[3]&&255===t[4]}}();o&&i({target:"Uint8Array",proto:!0,forced:l},{setFromBase64:function(t){s(this);var e=a(t,arguments.length>1?arguments[1]:undefined,this,this.length);return{read:e.read,written:e.written}}})},1625:function(t,e,n){var i=n(9504);t.exports=i({}.isPrototypeOf)},1689:function(t,e,n){var i=n(6518),r=n(4576),a=n(8745),s=n(7680),o=n(6043),l=n(9306),u=n(1103),h=r.Promise,c=!1;i({target:"Promise",stat:!0,forced:!h||!h["try"]||u((function(){h["try"]((function(t){c=8===t}),8)})).error||!c},{"try":function(t){var e=arguments.length>1?s(arguments,1):[],n=o.f(this),i=u((function(){return a(l(t),undefined,e)}));return(i.error?n.reject:n.resolve)(i.value),n.promise}})},1698:function(t,e,n){var i=n(6518),r=n(4204),a=n(9835);i({target:"Set",proto:!0,real:!0,forced:!n(4916)("union")||!a("union")},{union:r})},1701:function(t,e,n){var i=n(6518),r=n(9565),a=n(9306),s=n(8551),o=n(1767),l=n(9462),u=n(6319),h=n(9539),c=n(684),d=n(4549),f=n(6395),v=!f&&!c("map",(function(){})),p=!f&&!v&&d("map",TypeError),g=f||v||p,y=l((function(){var t=this.iterator,e=s(r(this.next,t));if(!(this.done=!!e.done))return u(t,this.mapper,[e.value,this.counter++],!0)}));i({target:"Iterator",proto:!0,real:!0,forced:g},{map:function(t){s(this);try{a(t)}catch(e){h(this,"throw",e)}return p?r(p,this,t):new y(o(this),{mapper:t})}})},1767:function(t){t.exports=function(t){return{iterator:t,next:t.next,done:!1}}},1828:function(t,e,n){var i=n(9504),r=n(9297),a=n(5397),s=n(9617).indexOf,o=n(421),l=i([].push);t.exports=function(t,e){var n,i=a(t),u=0,h=[];for(n in i)!r(o,n)&&r(i,n)&&l(h,n);for(;e.length>u;)r(i,n=e[u++])&&(~s(h,n)||l(h,n));return h}},2106:function(t,e,n){var i=n(283),r=n(4913);t.exports=function(t,e,n){return n.get&&i(n.get,e,{getter:!0}),n.set&&i(n.set,e,{setter:!0}),r.f(t,e,n)}},2140:function(t,e,n){var i={};i[n(8227)("toStringTag")]="z",t.exports="[object z]"===String(i)},2195:function(t,e,n){var i=n(9504),r=i({}.toString),a=i("".slice);t.exports=function(t){return a(r(t),8,-1)}},2211:function(t,e,n){var i=n(9039);t.exports=!i((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},2303:function(t,e,n){var i=n(4576),r=n(9504),a=i.Uint8Array,s=i.SyntaxError,o=i.parseInt,l=Math.min,u=/[^\da-f]/i,h=r(u.exec),c=r("".slice);t.exports=function(t,e){var n=t.length;if(n%2!=0)throw new s("String should be an even number of characters");for(var i=e?l(e.length,n/2):n/2,r=e||new a(i),d=0,f=0;f<i;){var v=c(t,d,d+=2);if(h(u,v))throw new s("String should only contain hex characters");r[f++]=o(v,16)}return{bytes:r,read:d}}},2360:function(t,e,n){var i,r=n(8551),a=n(6801),s=n(8727),o=n(421),l=n(397),u=n(4055),h=n(6119),c="prototype",d="script",f=h("IE_PROTO"),v=function(){},p=function(t){return"<"+d+">"+t+"</"+d+">"},g=function(t){t.write(p("")),t.close();var e=t.parentWindow.Object;return t=null,e},y=function(){try{i=new ActiveXObject("htmlfile")}catch(a){}var t,e,n;y="undefined"!=typeof document?document.domain&&i?g(i):(e=u("iframe"),n="java"+d+":",e.style.display="none",l.appendChild(e),e.src=String(n),(t=e.contentWindow.document).open(),t.write(p("document.F=Object")),t.close(),t.F):g(i);for(var r=s.length;r--;)delete y[c][s[r]];return y()};o[f]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(v[c]=r(t),n=new v,v[c]=null,n[f]=t):n=y(),e===undefined?n:a.f(n,e)}},2475:function(t,e,n){var i=n(6518),r=n(8527);i({target:"Set",proto:!0,real:!0,forced:!n(4916)("isSupersetOf",(function(t){return!t}))},{isSupersetOf:r})},2489:function(t,e,n){var i=n(6518),r=n(9565),a=n(9306),s=n(8551),o=n(1767),l=n(9462),u=n(6319),h=n(6395),c=n(9539),d=n(684),f=n(4549),v=!h&&!d("filter",(function(){})),p=!h&&!v&&f("filter",TypeError),g=h||v||p,y=l((function(){for(var t,e,n=this.iterator,i=this.predicate,a=this.next;;){if(t=s(r(a,n)),this.done=!!t.done)return;if(e=t.value,u(n,i,[e,this.counter++],!0))return e}}));i({target:"Iterator",proto:!0,real:!0,forced:g},{filter:function(t){s(this);try{a(t)}catch(e){c(this,"throw",e)}return p?r(p,this,t):new y(o(this),{predicate:t})}})},2529:function(t){t.exports=function(t,e){return{value:t,done:e}}},2603:function(t,e,n){var i=n(655);t.exports=function(t,e){return t===undefined?arguments.length<2?"":e:i(t)}},2652:function(t,e,n){var i=n(6080),r=n(9565),a=n(8551),s=n(6823),o=n(4209),l=n(6198),u=n(1625),h=n(81),c=n(851),d=n(9539),f=TypeError,v=function(t,e){this.stopped=t,this.result=e},p=v.prototype;t.exports=function(t,e,n){var g,y,m,w,b,k,A,_=n&&n.that,x=!(!n||!n.AS_ENTRIES),S=!(!n||!n.IS_RECORD),E=!(!n||!n.IS_ITERATOR),M=!(!n||!n.INTERRUPTED),C=i(e,_),T=function(t){return g&&d(g,"normal"),new v(!0,t)},R=function(t){return x?(a(t),M?C(t[0],t[1],T):C(t[0],t[1])):M?C(t,T):C(t)};if(S)g=t.iterator;else if(E)g=t;else{if(!(y=c(t)))throw new f(s(t)+" is not iterable");if(o(y)){for(m=0,w=l(t);w>m;m++)if((b=R(t[m]))&&u(p,b))return b;return new v(!1)}g=h(t,y)}for(k=S?t.next:g.next;!(A=r(k,g)).done;){try{b=R(A.value)}catch(P){d(g,"throw",P)}if("object"==B(b)&&b&&u(p,b))return b}return new v(!1)}},2777:function(t,e,n){var i=n(9565),r=n(34),a=n(757),s=n(5966),o=n(4270),l=n(8227),u=TypeError,h=l("toPrimitive");t.exports=function(t,e){if(!r(t)||a(t))return t;var n,l=s(t,h);if(l){if(e===undefined&&(e="default"),n=i(l,t,e),!r(n)||a(n))return n;throw new u("Can't convert object to primitive value")}return e===undefined&&(e="number"),o(t,e)}},2787:function(t,e,n){var i=n(9297),r=n(4901),a=n(8981),s=n(6119),o=n(2211),l=s("IE_PROTO"),u=Object,h=u.prototype;t.exports=o?u.getPrototypeOf:function(t){var e=a(t);if(i(e,l))return e[l];var n=e.constructor;return r(n)&&e instanceof n?n.prototype:e instanceof u?h:null}},2796:function(t,e,n){var i=n(9039),r=n(4901),a=/#|\.prototype\./,s=function(t,e){var n=l[o(t)];return n===h||n!==u&&(r(e)?i(e):!!e)},o=s.normalize=function(t){return String(t).replace(a,".").toLowerCase()},l=s.data={},u=s.NATIVE="N",h=s.POLYFILL="P";t.exports=s},2804:function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=e+"+/",i=e+"-_",r=function(t){for(var e={},n=0;n<64;n++)e[t.charAt(n)]=n;return e};t.exports={i2c:n,c2i:r(n),i2cUrl:i,c2iUrl:r(i)}},2812:function(t){var e=TypeError;t.exports=function(t,n){if(t<n)throw new e("Not enough arguments");return t}},2839:function(t,e,n){var i=n(4576).navigator,r=i&&i.userAgent;t.exports=r?String(r):""},2967:function(t,e,n){var i=n(6706),r=n(34),a=n(7750),s=n(3506);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=i(Object.prototype,"__proto__","set"))(n,[]),e=n instanceof Array}catch(o){}return function(n,i){return a(n),s(i),r(n)?(e?t(n,i):n.__proto__=i,n):n}}():undefined)},3167:function(t,e,n){var i=n(4901),r=n(34),a=n(2967);t.exports=function(t,e,n){var s,o;return a&&i(s=e.constructor)&&s!==n&&r(o=s.prototype)&&o!==n.prototype&&a(t,o),t}},3238:function(t,e,n){var i=n(4576),r=n(7811),a=n(7394),s=i.DataView;t.exports=function(t){if(!r||0!==a(t))return!1;try{return new s(t),!1}catch(e){return!0}}},3392:function(t,e,n){var i=n(9504),r=0,a=Math.random(),s=i(1.1.toString);t.exports=function(t){return"Symbol("+(t===undefined?"":t)+")_"+s(++r+a,36)}},3440:function(t,e,n){var i=n(7080),r=n(4402),a=n(9286),s=n(5170),o=n(3789),l=n(8469),u=n(507),h=r.has,c=r.remove;t.exports=function(t){var e=i(this),n=o(t),r=a(e);return s(e)<=n.size?l(e,(function(t){n.includes(t)&&c(r,t)})):u(n.getIterator(),(function(t){h(r,t)&&c(r,t)})),r}},3463:function(t){var e=TypeError;t.exports=function(t){if("string"==typeof t)return t;throw new e("Argument is not a string")}},3506:function(t,e,n){var i=n(3925),r=String,a=TypeError;t.exports=function(t){if(i(t))return t;throw new a("Can't set "+r(t)+" as a prototype")}},3579:function(t,e,n){var i=n(6518),r=n(9565),a=n(2652),s=n(9306),o=n(8551),l=n(1767),u=n(9539),h=n(4549)("some",TypeError);i({target:"Iterator",proto:!0,real:!0,forced:h},{some:function(t){o(this);try{s(t)}catch(i){u(this,"throw",i)}if(h)return r(h,this,t);var e=l(this),n=0;return a(e,(function(e,i){if(t(e,n++))return i()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},3650:function(t,e,n){var i=n(7080),r=n(4402),a=n(9286),s=n(3789),o=n(507),l=r.add,u=r.has,h=r.remove;t.exports=function(t){var e=i(this),n=s(t).getIterator(),r=a(e);return o(n,(function(t){u(e,t)?h(r,t):l(r,t)})),r}},3706:function(t,e,n){var i=n(9504),r=n(4901),a=n(7629),s=i(Function.toString);r(a.inspectSource)||(a.inspectSource=function(t){return s(t)}),t.exports=a.inspectSource},3717:function(t,e){e.f=Object.getOwnPropertySymbols},3724:function(t,e,n){var i=n(9039);t.exports=!i((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},3789:function(t,e,n){var i=n(9306),r=n(8551),a=n(9565),s=n(1291),o=n(1767),l="Invalid size",u=RangeError,h=TypeError,c=Math.max,d=function(t,e){this.set=t,this.size=c(e,0),this.has=i(t.has),this.keys=i(t.keys)};d.prototype={getIterator:function(){return o(r(a(this.keys,this.set)))},includes:function(t){return a(this.has,this.set,t)}},t.exports=function(t){r(t);var e=+t.size;if(e!=e)throw new h(l);var n=s(e);if(n<0)throw new u(l);return new d(t,n)}},3838:function(t,e,n){var i=n(7080),r=n(5170),a=n(8469),s=n(3789);t.exports=function(t){var e=i(this),n=s(t);return!(r(e)>n.size)&&!1!==a(e,(function(t){if(!n.includes(t))return!1}),!0)}},3853:function(t,e,n){var i=n(6518),r=n(4449);i({target:"Set",proto:!0,real:!0,forced:!n(4916)("isDisjointFrom",(function(t){return!t}))},{isDisjointFrom:r})},3925:function(t,e,n){var i=n(34);t.exports=function(t){return i(t)||null===t}},3972:function(t,e,n){var i=n(34),r=String,a=TypeError;t.exports=function(t){if(t===undefined||i(t))return t;throw new a(r(t)+" is not an object or undefined")}},4055:function(t,e,n){var i=n(4576),r=n(34),a=i.document,s=r(a)&&r(a.createElement);t.exports=function(t){return s?a.createElement(t):{}}},4114:function(t,e,n){var i=n(6518),r=n(8981),a=n(6198),s=n(4527),o=n(6837);i({target:"Array",proto:!0,arity:1,forced:n(9039)((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}()},{push:function(t){var e=r(this),n=a(e),i=arguments.length;o(n+i);for(var l=0;l<i;l++)e[n]=arguments[l],n++;return s(e,n),n}})},4117:function(t){t.exports=function(t){return null===t||t===undefined}},4149:function(t){var e=RangeError;t.exports=function(t){if(t==t)return t;throw new e("NaN is not allowed")}},4154:function(t,e,n){var i=n(6955),r=TypeError;t.exports=function(t){if("Uint8Array"===i(t))return t;throw new r("Argument is not an Uint8Array")}},4204:function(t,e,n){var i=n(7080),r=n(4402).add,a=n(9286),s=n(3789),o=n(507);t.exports=function(t){var e=i(this),n=s(t).getIterator(),l=a(e);return o(n,(function(t){r(l,t)})),l}},4209:function(t,e,n){var i=n(8227),r=n(6269),a=i("iterator"),s=Array.prototype;t.exports=function(t){return t!==undefined&&(r.Array===t||s[a]===t)}},4215:function(t,e,n){var i=n(4576),r=n(2839),a=n(2195),s=function(t){return r.slice(0,t.length)===t};t.exports=s("Bun/")?"BUN":s("Cloudflare-Workers")?"CLOUDFLARE":s("Deno/")?"DENO":s("Node.js/")?"NODE":i.Bun&&"string"==typeof Bun.version?"BUN":i.Deno&&"object"==B(Deno.version)?"DENO":"process"===a(i.process)?"NODE":i.window&&i.document?"BROWSER":"REST"},4235:function(t,e,n){var i=n(6518),r=n(9504),a=n(2652),s=RangeError,o=TypeError,l=Infinity,u=NaN,h=Math.abs,c=Math.pow,d=r([].push),f=c(2,1023),v=c(2,53)-1,p=Number.MAX_VALUE,g=c(2,971),y={},m={},w={},b={},k={},A=function(t,e){var n=t+e;return{hi:n,lo:e-(n-t)}};i({target:"Math",stat:!0},{sumPrecise:function(t){var e=[],n=0,i=b;switch(a(t,(function(t){if(++n>=v)throw new s("Maximum allowed index exceeded");if("number"!=typeof t)throw new o("Value is not a number");i!==y&&(t!=t?i=y:t===l?i=i===m?y:w:t===-l?i=i===w?y:m:0===t&&1/t!==l||i!==b&&i!==k||(i=k,d(e,t)))})),i){case y:return u;case m:return-l;case w:return l;case b:return-0}for(var r,c,_,x,S,E,M=[],C=0,T=0;T<e.length;T++){r=e[T];for(var R=0,P=0;P<M.length;P++){if(c=M[P],h(r)<h(c)&&(E=r,r=c,c=E),x=(_=A(r,c)).hi,S=_.lo,h(x)===l){var I=x===l?1:-1;C+=I,h(r=r-I*f-I*f)<h(c)&&(E=r,r=c,c=E),x=(_=A(r,c)).hi,S=_.lo}0!==S&&(M[R++]=S),r=x}M.length=R,0!==r&&d(M,r)}var D=M.length-1;if(x=0,S=0,0!==C){var L=D>=0?M[D]:0;if(D--,h(C)>1||C>0&&L>0||C<0&&L<0)return C>0?l:-l;if(x=(_=A(C*f,L/2)).hi,S=_.lo,S*=2,h(2*x)===l)return x>0?x===f&&S===-g/2&&D>=0&&M[D]<0?p:l:x===-f&&S===g/2&&D>=0&&M[D]>0?-p:-l;0!==S&&(M[++D]=S,S=0),x*=2}for(;D>=0&&(x=(_=A(x,M[D--])).hi,0===(S=_.lo)););return D>=0&&(S<0&&M[D]<0||S>0&&M[D]>0)&&(c=2*S)===(r=x+c)-x&&(x=r),x}})},4270:function(t,e,n){var i=n(9565),r=n(4901),a=n(34),s=TypeError;t.exports=function(t,e){var n,o;if("string"===e&&r(n=t.toString)&&!a(o=i(n,t)))return o;if(r(n=t.valueOf)&&!a(o=i(n,t)))return o;if("string"!==e&&r(n=t.toString)&&!a(o=i(n,t)))return o;throw new s("Can't convert object to primitive value")}},4376:function(t,e,n){var i=n(2195);t.exports=Array.isArray||function(t){return"Array"===i(t)}},4402:function(t,e,n){var i=n(9504),r=Set.prototype;t.exports={Set:Set,add:i(r.add),has:i(r.has),remove:i(r["delete"]),proto:r}},4449:function(t,e,n){var i=n(7080),r=n(4402).has,a=n(5170),s=n(3789),o=n(8469),l=n(507),u=n(9539);t.exports=function(t){var e=i(this),n=s(t);if(a(e)<=n.size)return!1!==o(e,(function(t){if(n.includes(t))return!1}),!0);var h=n.getIterator();return!1!==l(h,(function(t){if(r(e,t))return u(h,"normal",!1)}))}},4483:function(t,e,n){var i,r,a,s,o=n(4576),l=n(9429),u=n(1548),h=o.structuredClone,c=o.ArrayBuffer,d=o.MessageChannel,f=!1;if(u)f=function(t){h(t,{transfer:[t]})};else if(c)try{d||(i=l("worker_threads"))&&(d=i.MessageChannel),d&&(r=new d,a=new c(2),s=function(t){r.port1.postMessage(null,[t])},2===a.byteLength&&(s(a),0===a.byteLength&&(f=s)))}catch(v){}t.exports=f},4495:function(t,e,n){var i=n(9519),r=n(9039),a=n(4576).String;t.exports=!!Object.getOwnPropertySymbols&&!r((function(){var t=Symbol("symbol detection");return!a(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},4527:function(t,e,n){var i=n(3724),r=n(4376),a=TypeError,s=Object.getOwnPropertyDescriptor,o=i&&!function(){if(this!==undefined)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=o?function(t,e){if(r(t)&&!s(t,"length").writable)throw new a("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},4549:function(t,e,n){var i=n(4576);t.exports=function(t,e){var n=i.Iterator,r=n&&n.prototype,a=r&&r[t],s=!1;if(a)try{a.call({next:function(){return{done:!0}},"return":function(){s=!0}},-1)}catch(o){o instanceof e||(s=!1)}if(!s)return a}},4576:function(t){var e=function(t){return t&&t.Math===Math&&t};t.exports=e("object"==("undefined"==typeof globalThis?"undefined":B(globalThis))&&globalThis)||e("object"==("undefined"==typeof window?"undefined":B(window))&&window)||e("object"==("undefined"==typeof self?"undefined":B(self))&&self)||e("object"==("undefined"==typeof global?"undefined":B(global))&&global)||e("object"==B(this)&&this)||function(){return this}()||Function("return this")()},4603:function(t,e,n){var i=n(6840),r=n(9504),a=n(655),s=n(2812),o=URLSearchParams,l=o.prototype,u=r(l.append),h=r(l["delete"]),c=r(l.forEach),d=r([].push),f=new o("a=1&a=2&b=3");f["delete"]("a",1),f["delete"]("b",undefined),f+""!="a=2"&&i(l,"delete",(function(t){var e=arguments.length,n=e<2?undefined:arguments[1];if(e&&n===undefined)return h(this,t);var i=[];c(this,(function(t,e){d(i,{key:e,value:t})})),s(e,1);for(var r,o=a(t),l=a(n),f=0,v=0,p=!1,g=i.length;f<g;)r=i[f++],p||r.key===o?(p=!0,h(this,r.key)):v++;for(;v<g;)(r=i[v++]).key===o&&r.value===l||u(this,r.key,r.value)}),{enumerable:!0,unsafe:!0})},4628:function(t,e,n){var i=n(6518),r=n(6043);i({target:"Promise",stat:!0},{withResolvers:function(){var t=r.f(this);return{promise:t.promise,resolve:t.resolve,reject:t.reject}}})},4644:function(t,e,n){var i,r,a,s=n(7811),o=n(3724),l=n(4576),u=n(4901),h=n(34),c=n(9297),d=n(6955),f=n(6823),v=n(6699),p=n(6840),g=n(2106),y=n(1625),m=n(2787),w=n(2967),b=n(8227),k=n(3392),A=n(1181),_=A.enforce,x=A.get,S=l.Int8Array,E=S&&S.prototype,M=l.Uint8ClampedArray,C=M&&M.prototype,T=S&&m(S),R=E&&m(E),P=Object.prototype,I=l.TypeError,D=b("toStringTag"),L=k("TYPED_ARRAY_TAG"),O="TypedArrayConstructor",F=s&&!!w&&"Opera"!==d(l.opera),N=!1,W={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},B={BigInt64Array:8,BigUint64Array:8},j=function(t){var e=m(t);if(h(e)){var n=x(e);return n&&c(n,O)?n[O]:j(e)}},H=function(t){if(!h(t))return!1;var e=d(t);return c(W,e)||c(B,e)};for(i in W)(a=(r=l[i])&&r.prototype)?_(a)[O]=r:F=!1;for(i in B)(a=(r=l[i])&&r.prototype)&&(_(a)[O]=r);if((!F||!u(T)||T===Function.prototype)&&(T=function(){throw new I("Incorrect invocation")},F))for(i in W)l[i]&&w(l[i],T);if((!F||!R||R===P)&&(R=T.prototype,F))for(i in W)l[i]&&w(l[i].prototype,R);if(F&&m(C)!==R&&w(C,R),o&&!c(R,D))for(i in N=!0,g(R,D,{configurable:!0,get:function(){return h(this)?this[L]:undefined}}),W)l[i]&&v(l[i],L,i);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:F,TYPED_ARRAY_TAG:N&&L,aTypedArray:function(t){if(H(t))return t;throw new I("Target is not a typed array")},aTypedArrayConstructor:function(t){if(u(t)&&(!w||y(T,t)))return t;throw new I(f(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,n,i){if(o){if(n)for(var r in W){var a=l[r];if(a&&c(a.prototype,t))try{delete a.prototype[t]}catch(s){try{a.prototype[t]=e}catch(u){}}}R[t]&&!n||p(R,t,n?e:F&&E[t]||e,i)}},exportTypedArrayStaticMethod:function(t,e,n){var i,r;if(o){if(w){if(n)for(i in W)if((r=l[i])&&c(r,t))try{delete r[t]}catch(a){}if(T[t]&&!n)return;try{return p(T,t,n?e:F&&T[t]||e)}catch(a){}}for(i in W)!(r=l[i])||r[t]&&!n||p(r,t,e)}},getTypedArrayConstructor:j,isView:function(t){if(!h(t))return!1;var e=d(t);return"DataView"===e||c(W,e)||c(B,e)},isTypedArray:H,TypedArray:T,TypedArrayPrototype:R}},4659:function(t,e,n){var i=n(3724),r=n(4913),a=n(6980);t.exports=function(t,e,n){i?r.f(t,e,a(0,n)):t[e]=n}},4901:function(t){var e="object"==("undefined"==typeof document?"undefined":B(document))&&document.all;t.exports=void 0===e&&e!==undefined?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},4913:function(t,e,n){var i=n(3724),r=n(5917),a=n(8686),s=n(8551),o=n(6969),l=TypeError,u=Object.defineProperty,h=Object.getOwnPropertyDescriptor,c="enumerable",d="configurable",f="writable";e.f=i?a?function(t,e,n){if(s(t),e=o(e),s(n),"function"==typeof t&&"prototype"===e&&"value"in n&&f in n&&!n[f]){var i=h(t,e);i&&i[f]&&(t[e]=n.value,n={configurable:d in n?n[d]:i[d],enumerable:c in n?n[c]:i[c],writable:!1})}return u(t,e,n)}:u:function(t,e,n){if(s(t),e=o(e),s(n),r)try{return u(t,e,n)}catch(i){}if("get"in n||"set"in n)throw new l("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},4916:function(t,e,n){var i=n(7751),r=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},a=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}};t.exports=function(t,e){var n=i("Set");try{(new n)[t](r(0));try{return(new n)[t](r(-1)),!1}catch(o){if(!e)return!0;try{return(new n)[t](a(-Infinity)),!1}catch(l){var s=new n;return s.add(1),s.add(2),e(s[t](a(Infinity)))}}}catch(l){return!1}}},4979:function(t,e,n){var i=n(6518),r=n(4576),a=n(7751),s=n(6980),o=n(4913).f,l=n(9297),u=n(679),h=n(3167),c=n(2603),d=n(5002),f=n(8574),v=n(3724),p=n(6395),g="DOMException",y=a("Error"),m=a(g),w=function(){u(this,b);var t=arguments.length,e=c(t<1?undefined:arguments[0]),n=c(t<2?undefined:arguments[1],"Error"),i=new m(e,n),r=new y(e);return r.name=g,o(i,"stack",s(1,f(r.stack,1))),h(i,this,w),i},b=w.prototype=m.prototype,k="stack"in new y(g),A="stack"in new m(1,2),_=m&&v&&Object.getOwnPropertyDescriptor(r,g),x=!(!_||_.writable&&_.configurable),S=k&&!x&&!A;i({global:!0,constructor:!0,forced:p||S},{DOMException:S?w:m});var E=a(g),M=E.prototype;if(M.constructor!==E)for(var C in p||o(M,"constructor",s(1,E)),d)if(l(d,C)){var T=d[C],R=T.s;l(E,R)||o(E,R,s(6,T.c))}},5002:function(t){t.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},5024:function(t,e,n){var i=n(6518),r=n(3650),a=n(9835);i({target:"Set",proto:!0,real:!0,forced:!n(4916)("symmetricDifference")||!a("symmetricDifference")},{symmetricDifference:r})},5031:function(t,e,n){var i=n(7751),r=n(9504),a=n(8480),s=n(3717),o=n(8551),l=r([].concat);t.exports=i("Reflect","ownKeys")||function(t){var e=a.f(o(t)),n=s.f;return n?l(e,n(t)):e}},5169:function(t,e,n){var i=n(3238),r=TypeError;t.exports=function(t){if(i(t))throw new r("ArrayBuffer is detached");return t}},5170:function(t,e,n){var i=n(6706),r=n(4402);t.exports=i(r.proto,"size","get")||function(t){return t.size}},5370:function(t,e,n){var i=n(6198);t.exports=function(t,e,n){for(var r=0,a=arguments.length>2?n:i(e),s=new t(a);a>r;)s[r]=e[r++];return s}},5397:function(t,e,n){var i=n(7055),r=n(7750);t.exports=function(t){return i(r(t))}},5610:function(t,e,n){var i=n(1291),r=Math.max,a=Math.min;t.exports=function(t,e){var n=i(t);return n<0?r(n+e,0):a(n,e)}},5623:function(t,e,n){var i=n(6518),r=n(4576),a=n(9504),s=n(4154),o=n(5169),l=a(1.1.toString),u=r.Uint8Array,h=!u||!u.prototype.toHex||!function(){try{return"ffffffffffffffff"===new u([255,255,255,255,255,255,255,255]).toHex()}catch(t){return!1}}();u&&i({target:"Uint8Array",proto:!0,forced:h},{toHex:function(){s(this),o(this.buffer);for(var t="",e=0,n=this.length;e<n;e++){var i=l(this[e],16);t+=1===i.length?"0"+i:i}return t}})},5636:function(t,e,n){var i=n(4576),r=n(9504),a=n(6706),s=n(7696),o=n(5169),l=n(7394),u=n(4483),h=n(1548),c=i.structuredClone,d=i.ArrayBuffer,f=i.DataView,v=Math.min,p=d.prototype,g=f.prototype,y=r(p.slice),m=a(p,"resizable","get"),w=a(p,"maxByteLength","get"),b=r(g.getInt8),k=r(g.setInt8);t.exports=(h||u)&&function(t,e,n){var i,r=l(t),a=e===undefined?r:s(e),p=!m||!m(t);if(o(t),h&&(t=c(t,{transfer:[t]}),r===a&&(n||p)))return t;if(r>=a&&(!n||p))i=y(t,0,a);else{var g=n&&!p&&w?{maxByteLength:w(t)}:undefined;i=new d(a,g);for(var A=new f(t),_=new f(i),x=v(a,r),S=0;S<x;S++)k(_,S,b(A,S))}return h||u(t),i}},5745:function(t,e,n){var i=n(7629);t.exports=function(t,e){return i[t]||(i[t]=e||{})}},5781:function(t,e,n){var i=n(6518),r=n(7751),a=n(2812),s=n(655),o=n(7416),l=r("URL");i({target:"URL",stat:!0,forced:!o},{parse:function(t){var e=a(arguments.length,1),n=s(t),i=e<2||arguments[1]===undefined?undefined:s(arguments[1]);try{return new l(n,i)}catch(r){return null}}})},5854:function(t,e,n){var i=n(2777),r=TypeError;t.exports=function(t){var e=i(t,"number");if("number"==typeof e)throw new r("Can't convert number to bigint");return BigInt(e)}},5876:function(t,e,n){var i=n(6518),r=n(3838);i({target:"Set",proto:!0,real:!0,forced:!n(4916)("isSubsetOf",(function(t){return t}))},{isSubsetOf:r})},5917:function(t,e,n){var i=n(3724),r=n(9039),a=n(4055);t.exports=!i&&!r((function(){return 7!==Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},5966:function(t,e,n){var i=n(9306),r=n(4117);t.exports=function(t,e){var n=t[e];return r(n)?undefined:i(n)}},6043:function(t,e,n){var i=n(9306),r=TypeError,a=function(t){var e,n;this.promise=new t((function(t,i){if(e!==undefined||n!==undefined)throw new r("Bad Promise constructor");e=t,n=i})),this.resolve=i(e),this.reject=i(n)};t.exports.f=function(t){return new a(t)}},6080:function(t,e,n){var i=n(7476),r=n(9306),a=n(616),s=i(i.bind);t.exports=function(t,e){return r(t),e===undefined?t:a?s(t,e):function(){return t.apply(e,arguments)}}},6119:function(t,e,n){var i=n(5745),r=n(3392),a=i("keys");t.exports=function(t){return a[t]||(a[t]=r(t))}},6193:function(t,e,n){var i=n(4215);t.exports="NODE"===i},6198:function(t,e,n){var i=n(8014);t.exports=function(t){return i(t.length)}},6269:function(t){t.exports={}},6279:function(t,e,n){var i=n(6840);t.exports=function(t,e,n){for(var r in e)i(t,r,e[r],n);return t}},6319:function(t,e,n){var i=n(8551),r=n(9539);t.exports=function(t,e,n,a){try{return a?e(i(n)[0],n[1]):e(n)}catch(s){r(t,"throw",s)}}},6395:function(t){t.exports=!1},6518:function(t,e,n){var i=n(4576),r=n(7347).f,a=n(6699),s=n(6840),o=n(9433),l=n(7740),u=n(2796);t.exports=function(t,e){var n,h,c,d,f,v=t.target,p=t.global,g=t.stat;if(n=p?i:g?i[v]||o(v,{}):i[v]&&i[v].prototype)for(h in e){if(d=e[h],c=t.dontCallGetSet?(f=r(n,h))&&f.value:n[h],!u(p?h:v+(g?".":"#")+h,t.forced)&&c!==undefined){if(B(d)==B(c))continue;l(d,c)}(t.sham||c&&c.sham)&&a(d,"sham",!0),s(n,h,d,t)}}},6573:function(t,e,n){var i=n(3724),r=n(2106),a=n(3238),s=ArrayBuffer.prototype;i&&!("detached"in s)&&r(s,"detached",{configurable:!0,get:function(){return a(this)}})},6699:function(t,e,n){var i=n(3724),r=n(4913),a=n(6980);t.exports=i?function(t,e,n){return r.f(t,e,a(1,n))}:function(t,e,n){return t[e]=n,t}},6706:function(t,e,n){var i=n(9504),r=n(9306);t.exports=function(t,e,n){try{return i(r(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(a){}}},6801:function(t,e,n){var i=n(3724),r=n(8686),a=n(4913),s=n(8551),o=n(5397),l=n(1072);e.f=i&&!r?Object.defineProperties:function(t,e){s(t);for(var n,i=o(e),r=l(e),u=r.length,h=0;u>h;)a.f(t,n=r[h++],i[n]);return t}},6823:function(t){var e=String;t.exports=function(t){try{return e(t)}catch(n){return"Object"}}},6837:function(t){var e=TypeError;t.exports=function(t){if(t>9007199254740991)throw e("Maximum allowed index exceeded");return t}},6840:function(t,e,n){var i=n(4901),r=n(4913),a=n(283),s=n(9433);t.exports=function(t,e,n,o){o||(o={});var l=o.enumerable,u=o.name!==undefined?o.name:e;if(i(n)&&a(n,u,o),o.global)l?t[e]=n:s(e,n);else{try{o.unsafe?t[e]&&(l=!0):delete t[e]}catch(h){}l?t[e]=n:r.f(t,e,{value:n,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return t}},6955:function(t,e,n){var i=n(2140),r=n(4901),a=n(2195),s=n(8227)("toStringTag"),o=Object,l="Arguments"===a(function(){return arguments}());t.exports=i?a:function(t){var e,n,i;return t===undefined?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(n){}}(e=o(t),s))?n:l?a(e):"Object"===(i=a(e))&&r(e.callee)?"Arguments":i}},6969:function(t,e,n){var i=n(2777),r=n(757);t.exports=function(t){var e=i(t,"string");return r(e)?e:e+""}},6980:function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},7040:function(t,e,n){var i=n(4495);t.exports=i&&!Symbol.sham&&"symbol"==B(Symbol.iterator)},7055:function(t,e,n){var i=n(9504),r=n(9039),a=n(2195),s=Object,o=i("".split);t.exports=r((function(){return!s("z").propertyIsEnumerable(0)}))?function(t){return"String"===a(t)?o(t,""):s(t)}:s},7080:function(t,e,n){var i=n(4402).has;t.exports=function(t){return i(t),t}},7347:function(t,e,n){var i=n(3724),r=n(9565),a=n(8773),s=n(6980),o=n(5397),l=n(6969),u=n(9297),h=n(5917),c=Object.getOwnPropertyDescriptor;e.f=i?c:function(t,e){if(t=o(t),e=l(e),h)try{return c(t,e)}catch(n){}if(u(t,e))return s(!r(a.f,t,e),t[e])}},7394:function(t,e,n){var i=n(4576),r=n(6706),a=n(2195),s=i.ArrayBuffer,o=i.TypeError;t.exports=s&&r(s.prototype,"byteLength","get")||function(t){if("ArrayBuffer"!==a(t))throw new o("ArrayBuffer expected");return t.byteLength}},7416:function(t,e,n){var i=n(9039),r=n(8227),a=n(3724),s=n(6395),o=r("iterator");t.exports=!i((function(){var t=new URL("b?a=1&b=2&c=3","https://a"),e=t.searchParams,n=new URLSearchParams("a=1&a=2&b=3"),i="";return t.pathname="c%20d",e.forEach((function(t,n){e["delete"]("b"),i+=n+t})),n["delete"]("a",2),n["delete"]("b",undefined),s&&(!t.toJSON||!n.has("a",1)||n.has("a",2)||!n.has("a",undefined)||n.has("b"))||!e.size&&(s||!a)||!e.sort||"https://a/c%20d?a=1&c=3"!==t.href||"3"!==e.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!e[o]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("https://ÑÐµÑÑ").host||"#%D0%B1"!==new URL("https://a#Ð±").hash||"a1c3"!==i||"x"!==new URL("https://x",undefined).host}))},7476:function(t,e,n){var i=n(2195),r=n(9504);t.exports=function(t){if("Function"===i(t))return r(t)}},7566:function(t,e,n){var i=n(6840),r=n(9504),a=n(655),s=n(2812),o=URLSearchParams,l=o.prototype,u=r(l.getAll),h=r(l.has),c=new o("a=1");!c.has("a",2)&&c.has("a",undefined)||i(l,"has",(function(t){var e=arguments.length,n=e<2?undefined:arguments[1];if(e&&n===undefined)return h(this,t);var i=u(this,t);s(e,1);for(var r=a(n),o=0;o<i.length;)if(i[o++]===r)return!0;return!1}),{enumerable:!0,unsafe:!0})},7629:function(t,e,n){var i=n(6395),r=n(4576),a=n(9433),s="__core-js_shared__",o=t.exports=r[s]||a(s,{});(o.versions||(o.versions=[])).push({version:"3.44.0",mode:i?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.44.0/LICENSE",source:"https://github.com/zloirock/core-js"})},7642:function(t,e,n){var i=n(6518),r=n(3440),a=n(9039);i({target:"Set",proto:!0,real:!0,forced:!n(4916)("difference",(function(t){return 0===t.size}))||a((function(){var t={size:1,has:function(){return!0},keys:function(){var t=0;return{next:function(){var n=t++>1;return e.has(1)&&e.clear(),{done:n,value:2}}}}},e=new Set([1,2,3,4]);return 3!==e.difference(t).size}))},{difference:r})},7657:function(t,e,n){var i,r,a,s=n(9039),o=n(4901),l=n(34),u=n(2360),h=n(2787),c=n(6840),d=n(8227),f=n(6395),v=d("iterator"),p=!1;[].keys&&("next"in(a=[].keys())?(r=h(h(a)))!==Object.prototype&&(i=r):p=!0),!l(i)||s((function(){var t={};return i[v].call(t)!==t}))?i={}:f&&(i=u(i)),o(i[v])||c(i,v,(function(){return this})),t.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:p}},7680:function(t,e,n){var i=n(9504);t.exports=i([].slice)},7696:function(t,e,n){var i=n(1291),r=n(8014),a=RangeError;t.exports=function(t){if(t===undefined)return 0;var e=i(t),n=r(e);if(e!==n)throw new a("Wrong length or index");return n}},7740:function(t,e,n){var i=n(9297),r=n(5031),a=n(7347),s=n(4913);t.exports=function(t,e,n){for(var o=r(e),l=s.f,u=a.f,h=0;h<o.length;h++){var c=o[h];i(t,c)||n&&i(n,c)||l(t,c,u(e,c))}}},7750:function(t,e,n){var i=n(4117),r=TypeError;t.exports=function(t){if(i(t))throw new r("Can't call method on "+t);return t}},7751:function(t,e,n){var i=n(4576),r=n(4901);t.exports=function(t,e){return arguments.length<2?(n=i[t],r(n)?n:undefined):i[t]&&i[t][e];var n}},7811:function(t){t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},7936:function(t,e,n){var i=n(6518),r=n(5636);r&&i({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return r(this,arguments.length?arguments[0]:undefined,!1)}})},8004:function(t,e,n){var i=n(6518),r=n(9039),a=n(8750);i({target:"Set",proto:!0,real:!0,forced:!n(4916)("intersection",(function(t){return 2===t.size&&t.has(1)&&t.has(2)}))||r((function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))}))},{intersection:a})},8014:function(t,e,n){var i=n(1291),r=Math.min;t.exports=function(t){var e=i(t);return e>0?r(e,9007199254740991):0}},8100:function(t,e,n){var i=n(6518),r=n(5636);r&&i({target:"ArrayBuffer",proto:!0},{transfer:function(){return r(this,arguments.length?arguments[0]:undefined,!0)}})},8111:function(t,e,n){var i=n(6518),r=n(4576),a=n(679),s=n(8551),o=n(4901),l=n(2787),u=n(2106),h=n(4659),c=n(9039),d=n(9297),f=n(8227),v=n(7657).IteratorPrototype,p=n(3724),g=n(6395),y="constructor",m="Iterator",w=f("toStringTag"),b=TypeError,k=r[m],A=g||!o(k)||k.prototype!==v||!c((function(){k({})})),_=function(){if(a(this,v),l(this)===v)throw new b("Abstract class Iterator not directly constructable")},x=function(t,e){p?u(v,t,{configurable:!0,get:function(){return e},set:function(e){if(s(this),this===v)throw new b("You can't redefine this property");d(this,t)?this[t]=e:h(this,t,e)}}):v[t]=e};d(v,w)||x(w,m),!A&&d(v,y)&&v[y]!==Object||x(y,_),_.prototype=v,i({global:!0,constructor:!0,forced:A},{Iterator:_})},8227:function(t,e,n){var i=n(4576),r=n(5745),a=n(9297),s=n(3392),o=n(4495),l=n(7040),u=i.Symbol,h=r("wks"),c=l?u["for"]||u:u&&u.withoutSetter||s;t.exports=function(t){return a(h,t)||(h[t]=o&&a(u,t)?u[t]:c("Symbol."+t)),h[t]}},8235:function(t,e,n){var i=n(9504),r=n(9297),a=SyntaxError,s=parseInt,o=String.fromCharCode,l=i("".charAt),u=i("".slice),h=i(/./.exec),c={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":"\n","\\r":"\r","\\t":"\t"},d=/^[\da-f]{4}$/i,f=/^[\u0000-\u001F]$/;t.exports=function(t,e){for(var n=!0,i="";e<t.length;){var v=l(t,e);if("\\"===v){var p=u(t,e,e+2);if(r(c,p))i+=c[p],e+=2;else{if("\\u"!==p)throw new a('Unknown escape sequence: "'+p+'"');var g=u(t,e+=2,e+4);if(!h(d,g))throw new a("Bad Unicode escape at: "+e);i+=o(s(g,16)),e+=4}}else{if('"'===v){n=!1,e++;break}if(h(f,v))throw new a("Bad control character in string literal at: "+e);i+=v,e++}}if(n)throw new a("Unterminated string at: "+e);return{value:i,end:e}}},8237:function(t,e,n){var i=n(6518),r=n(2652),a=n(9306),s=n(8551),o=n(1767),l=n(9539),u=n(4549),h=n(8745),c=n(9039),d=TypeError,f=c((function(){[].keys().reduce((function(){}),undefined)})),v=!f&&u("reduce",d);i({target:"Iterator",proto:!0,real:!0,forced:f||v},{reduce:function(t){s(this);try{a(t)}catch(c){l(this,"throw",c)}var e=arguments.length<2,n=e?undefined:arguments[1];if(v)return h(v,this,e?[t]:[t,n]);var i=o(this),u=0;if(r(i,(function(i){e?(e=!1,n=i):n=t(n,i,u),u++}),{IS_RECORD:!0}),e)throw new d("Reduce of empty iterator with no initial value");return n}})},8335:function(t,e,n){var i=n(6518),r=n(3724),a=n(4576),s=n(7751),o=n(9504),l=n(9565),u=n(4901),h=n(34),c=n(4376),d=n(9297),f=n(655),v=n(6198),p=n(4659),g=n(9039),y=n(8235),m=n(4495),w=a.JSON,b=a.Number,k=a.SyntaxError,A=w&&w.parse,_=s("Object","keys"),x=Object.getOwnPropertyDescriptor,S=o("".charAt),E=o("".slice),M=o(/./.exec),C=o([].push),T=/^\d$/,R=/^[1-9]$/,P=/^[\d-]$/,I=/^[\t\n\r ]$/,D=function(t,e,n,i){var r,a,s,o,u,f=t[e],p=i&&f===i.value,g=p&&"string"==typeof i.source?{source:i.source}:{};if(h(f)){var y=c(f),m=p?i.nodes:y?[]:{};if(y)for(r=m.length,s=v(f),o=0;o<s;o++)L(f,o,D(f,""+o,n,o<r?m[o]:undefined));else for(a=_(f),s=v(a),o=0;o<s;o++)u=a[o],L(f,u,D(f,u,n,d(m,u)?m[u]:undefined))}return l(n,t,e,f,g)},L=function(t,e,n){if(r){var i=x(t,e);if(i&&!i.configurable)return}n===undefined?delete t[e]:p(t,e,n)},O=function(t,e,n,i){this.value=t,this.end=e,this.source=n,this.nodes=i},F=function(t,e){this.source=t,this.index=e};F.prototype={fork:function(t){return new F(this.source,t)},parse:function(){var t=this.source,e=this.skip(I,this.index),n=this.fork(e),i=S(t,e);if(M(P,i))return n.number();switch(i){case"{":return n.object();case"[":return n.array();case'"':return n.string();case"t":return n.keyword(!0);case"f":return n.keyword(!1);case"n":return n.keyword(null)}throw new k('Unexpected character: "'+i+'" at: '+e)},node:function(t,e,n,i,r){return new O(e,i,t?null:E(this.source,n,i),r)},object:function(){for(var t=this.source,e=this.index+1,n=!1,i={},r={};e<t.length;){if(e=this.until(['"',"}"],e),"}"===S(t,e)&&!n){e++;break}var a=this.fork(e).string(),s=a.value;e=a.end,e=this.until([":"],e)+1,e=this.skip(I,e),a=this.fork(e).parse(),p(r,s,a),p(i,s,a.value),e=this.until([",","}"],a.end);var o=S(t,e);if(","===o)n=!0,e++;else if("}"===o){e++;break}}return this.node(1,i,this.index,e,r)},array:function(){for(var t=this.source,e=this.index+1,n=!1,i=[],r=[];e<t.length;){if(e=this.skip(I,e),"]"===S(t,e)&&!n){e++;break}var a=this.fork(e).parse();if(C(r,a),C(i,a.value),e=this.until([",","]"],a.end),","===S(t,e))n=!0,e++;else if("]"===S(t,e)){e++;break}}return this.node(1,i,this.index,e,r)},string:function(){var t=this.index,e=y(this.source,this.index+1);return this.node(0,e.value,t,e.end)},number:function(){var t=this.source,e=this.index,n=e;if("-"===S(t,n)&&n++,"0"===S(t,n))n++;else{if(!M(R,S(t,n)))throw new k("Failed to parse number at: "+n);n=this.skip(T,n+1)}if(("."===S(t,n)&&(n=this.skip(T,n+1)),"e"===S(t,n)||"E"===S(t,n))&&(n++,"+"!==S(t,n)&&"-"!==S(t,n)||n++,n===(n=this.skip(T,n))))throw new k("Failed to parse number's exponent value at: "+n);return this.node(0,b(E(t,e,n)),e,n)},keyword:function(t){var e=""+t,n=this.index,i=n+e.length;if(E(this.source,n,i)!==e)throw new k("Failed to parse value at: "+n);return this.node(0,t,n,i)},skip:function(t,e){for(var n=this.source;e<n.length&&M(t,S(n,e));e++);return e},until:function(t,e){e=this.skip(I,e);for(var n=S(this.source,e),i=0;i<t.length;i++)if(t[i]===n)return e;throw new k('Unexpected character: "'+n+'" at: '+e)}};var N=g((function(){var t,e="9007199254740993";return A(e,(function(e,n,i){t=i.source})),t!==e})),W=m&&!g((function(){return 1/A("-0 \t")!=-Infinity}));i({target:"JSON",stat:!0,forced:N},{parse:function(t,e){return W&&!u(e)?A(t):function(t,e){t=f(t);var n=new F(t,0),i=n.parse(),r=i.value,a=n.skip(I,i.end);if(a<t.length)throw new k('Unexpected extra character: "'+S(t,a)+'" after the parsed data at: '+a);return u(e)?D({"":r},"",e,i):r}(t,e)}})},8469:function(t,e,n){var i=n(9504),r=n(507),a=n(4402),s=a.Set,o=a.proto,l=i(o.forEach),u=i(o.keys),h=u(new s).next;t.exports=function(t,e,n){return n?r({iterator:u(t),next:h},e):l(t,e)}},8480:function(t,e,n){var i=n(1828),r=n(8727).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},8527:function(t,e,n){var i=n(7080),r=n(4402).has,a=n(5170),s=n(3789),o=n(507),l=n(9539);t.exports=function(t){var e=i(this),n=s(t);if(a(e)<n.size)return!1;var u=n.getIterator();return!1!==o(u,(function(t){if(!r(e,t))return l(u,"normal",!1)}))}},8551:function(t,e,n){var i=n(34),r=String,a=TypeError;t.exports=function(t){if(i(t))return t;throw new a(r(t)+" is not an object")}},8574:function(t,e,n){var i=n(9504),r=Error,a=i("".replace),s=String(new r("zxcasd").stack),o=/\n\s*at [^:]*:[^\n]*/,l=o.test(s);t.exports=function(t,e){if(l&&"string"==typeof t&&!r.prepareStackTrace)for(;e--;)t=a(t,o,"");return t}},8622:function(t,e,n){var i=n(4576),r=n(4901),a=i.WeakMap;t.exports=r(a)&&/native code/.test(String(a))},8646:function(t,e,n){var i=n(9565),r=n(8551),a=n(1767),s=n(851);t.exports=function(t,e){e&&"string"==typeof t||r(t);var n=s(t);return a(r(n!==undefined?i(n,t):t))}},8686:function(t,e,n){var i=n(3724),r=n(9039);t.exports=i&&r((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8721:function(t,e,n){var i=n(3724),r=n(9504),a=n(2106),s=URLSearchParams.prototype,o=r(s.forEach);i&&!("size"in s)&&a(s,"size",{get:function(){var t=0;return o(this,(function(){t++})),t},configurable:!0,enumerable:!0})},8727:function(t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8745:function(t,e,n){var i=n(616),r=Function.prototype,a=r.apply,s=r.call;t.exports="object"==("undefined"==typeof Reflect?"undefined":B(Reflect))&&Reflect.apply||(i?s.bind(a):function(){return s.apply(a,arguments)})},8750:function(t,e,n){var i=n(7080),r=n(4402),a=n(5170),s=n(3789),o=n(8469),l=n(507),u=r.Set,h=r.add,c=r.has;t.exports=function(t){var e=i(this),n=s(t),r=new u;return a(e)>n.size?l(n.getIterator(),(function(t){c(e,t)&&h(r,t)})):o(e,(function(t){n.includes(t)&&h(r,t)})),r}},8773:function(t,e){var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,r=i&&!n.call({1:2},1);e.f=r?function(t){var e=i(this,t);return!!e&&e.enumerable}:n},8981:function(t,e,n){var i=n(7750),r=Object;t.exports=function(t){return r(i(t))}},9039:function(t){t.exports=function(t){try{return!!t()}catch(e){return!0}}},9143:function(t,e,n){var i=n(4576),r=n(9504),a=n(3972),s=n(3463),o=n(9297),l=n(2804),u=n(944),h=n(5169),c=l.c2i,d=l.c2iUrl,f=i.SyntaxError,v=i.TypeError,p=r("".charAt),g=function(t,e){for(var n=t.length;e<n;e++){var i=p(t,e);if(" "!==i&&"\t"!==i&&"\n"!==i&&"\f"!==i&&"\r"!==i)break}return e},y=function(t,e,n){var i=t.length;i<4&&(t+=2===i?"AA":"A");var r=(e[p(t,0)]<<18)+(e[p(t,1)]<<12)+(e[p(t,2)]<<6)+e[p(t,3)],a=[r>>16&255,r>>8&255,255&r];if(2===i){if(n&&0!==a[1])throw new f("Extra bits");return[a[0]]}if(3===i){if(n&&0!==a[2])throw new f("Extra bits");return[a[0],a[1]]}return a},m=function(t,e,n){for(var i=e.length,r=0;r<i;r++)t[n+r]=e[r];return n+i};t.exports=function(t,e,n,i){s(t),a(e);var r="base64"===u(e)?c:d,l=e?e.lastChunkHandling:undefined;if(l===undefined&&(l="loose"),"loose"!==l&&"strict"!==l&&"stop-before-partial"!==l)throw new v("Incorrect `lastChunkHandling` option");n&&h(n.buffer);var w=n||[],b=0,k=0,A="",_=0;if(i)for(;;){if((_=g(t,_))===t.length){if(A.length>0){if("stop-before-partial"===l)break;if("loose"!==l)throw new f("Missing padding");if(1===A.length)throw new f("Malformed padding: exactly one additional character");b=m(w,y(A,r,!1),b)}k=t.length;break}var x=p(t,_);if(++_,"="===x){if(A.length<2)throw new f("Padding is too early");if(_=g(t,_),2===A.length){if(_===t.length){if("stop-before-partial"===l)break;throw new f("Malformed padding: only one =")}"="===p(t,_)&&(++_,_=g(t,_))}if(_<t.length)throw new f("Unexpected character after padding");b=m(w,y(A,r,"strict"===l),b),k=t.length;break}if(!o(r,x))throw new f("Unexpected character");var S=i-b;if(1===S&&2===A.length||2===S&&3===A.length)break;if(4===(A+=x).length&&(b=m(w,y(A,r,!1),b),A="",k=_,b===i))break}return{bytes:w,read:k,written:b}}},9286:function(t,e,n){var i=n(4402),r=n(8469),a=i.Set,s=i.add;t.exports=function(t){var e=new a;return r(t,(function(t){s(e,t)})),e}},9297:function(t,e,n){var i=n(9504),r=n(8981),a=i({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return a(r(t),e)}},9306:function(t,e,n){var i=n(4901),r=n(6823),a=TypeError;t.exports=function(t){if(i(t))return t;throw new a(r(t)+" is not a function")}},9314:function(t,e,n){var i=n(6518),r=n(9565),a=n(8551),s=n(1767),o=n(4149),l=n(9590),u=n(9539),h=n(9462),c=n(684),d=n(4549),f=n(6395),v=!f&&!c("drop",0),p=!f&&!v&&d("drop",RangeError),g=f||v||p,y=h((function(){for(var t,e=this.iterator,n=this.next;this.remaining;)if(this.remaining--,t=a(r(n,e)),this.done=!!t.done)return;if(t=a(r(n,e)),!(this.done=!!t.done))return t.value}));i({target:"Iterator",proto:!0,real:!0,forced:g},{drop:function(t){var e;a(this);try{e=l(o(+t))}catch(n){u(this,"throw",n)}return p?r(p,this,e):new y(s(this),{remaining:e})}})},9429:function(t,e,n){var i=n(4576),r=n(6193);t.exports=function(t){if(r){try{return i.process.getBuiltinModule(t)}catch(e){}try{return Function('return require("'+t+'")')()}catch(e){}}}},9432:function(t,e,n){var i=n(6518),r=n(4576),a=n(5370),s=n(9143),o=r.Uint8Array,l=!o||!o.fromBase64||!function(){try{o.fromBase64("",null)}catch(t){return!0}}();o&&i({target:"Uint8Array",stat:!0,forced:l},{fromBase64:function(t){var e=s(t,arguments.length>1?arguments[1]:undefined,null,9007199254740991);return a(o,e.bytes)}})},9433:function(t,e,n){var i=n(4576),r=Object.defineProperty;t.exports=function(t,e){try{r(i,t,{value:e,configurable:!0,writable:!0})}catch(n){i[t]=e}return e}},9462:function(t,e,n){var i=n(9565),r=n(2360),a=n(6699),s=n(6279),o=n(8227),l=n(1181),u=n(5966),h=n(7657).IteratorPrototype,c=n(2529),d=n(9539),f=n(1385),v=o("toStringTag"),p="IteratorHelper",g="WrapForValidIterator",y="normal",m="throw",w=l.set,b=function(t){var e=l.getterFor(t?g:p);return s(r(h),{next:function(){var n=e(this);if(t)return n.nextHandler();if(n.done)return c(undefined,!0);try{var i=n.nextHandler();return n.returnHandlerResult?i:c(i,n.done)}catch(r){throw n.done=!0,r}},"return":function(){var n=e(this),r=n.iterator;if(n.done=!0,t){var a=u(r,"return");return a?i(a,r):c(undefined,!0)}if(n.inner)try{d(n.inner.iterator,y)}catch(s){return d(r,m,s)}if(n.openIters)try{f(n.openIters,y)}catch(s){return d(r,m,s)}return r&&d(r,y),c(undefined,!0)}})},k=b(!0),A=b(!1);a(A,v,"Iterator Helper"),t.exports=function(t,e,n){var i=function(i,r){r?(r.iterator=i.iterator,r.next=i.next):r=i,r.type=e?g:p,r.returnHandlerResult=!!n,r.nextHandler=t,r.counter=0,r.done=!1,w(this,r)};return i.prototype=e?k:A,i}},9504:function(t,e,n){var i=n(616),r=Function.prototype,a=r.call,s=i&&r.bind.bind(a,a);t.exports=i?s:function(t){return function(){return a.apply(t,arguments)}}},9519:function(t,e,n){var i,r,a=n(4576),s=n(2839),o=a.process,l=a.Deno,u=o&&o.versions||l&&l.version,h=u&&u.v8;h&&(r=(i=h.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!r&&s&&(!(i=s.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=s.match(/Chrome\/(\d+)/))&&(r=+i[1]),t.exports=r},9539:function(t,e,n){var i=n(9565),r=n(8551),a=n(5966);t.exports=function(t,e,n){var s,o;r(t);try{if(!(s=a(t,"return"))){if("throw"===e)throw n;return n}s=i(s,t)}catch(l){o=!0,s=l}if("throw"===e)throw n;if(o)throw s;return r(s),n}},9565:function(t,e,n){var i=n(616),r=Function.prototype.call;t.exports=i?r.bind(r):function(){return r.apply(r,arguments)}},9577:function(t,e,n){var i=n(9928),r=n(4644),a=n(1108),s=n(1291),o=n(5854),l=r.aTypedArray,u=r.getTypedArrayConstructor,h=r.exportTypedArrayMethod,c=function(){try{new Int8Array(1)["with"](2,{valueOf:function(){throw 8}})}catch(t){return 8===t}}(),d=c&&function(){try{new Int8Array(1)["with"](-.5,1)}catch(t){return!0}}();h("with",{"with":function(t,e){var n=l(this),r=s(t),h=a(n)?o(e):+e;return i(n,u(n),r,h)}}["with"],!c||d)},9590:function(t,e,n){var i=n(1291),r=RangeError;t.exports=function(t){var e=i(t);if(e<0)throw new r("The argument can't be less than 0");return e}},9617:function(t,e,n){var i=n(5397),r=n(5610),a=n(6198),s=function(t){return function(e,n,s){var o=i(e),l=a(o);if(0===l)return!t&&-1;var u,h=r(s,l);if(t&&n!=n){for(;l>h;)if((u=o[h++])!=u)return!0}else for(;l>h;h++)if((t||h in o)&&o[h]===n)return t||h||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},9631:function(t,e,n){var i=n(6518),r=n(4576),a=n(9504),s=n(3972),o=n(4154),l=n(5169),u=n(2804),h=n(944),c=u.i2c,d=u.i2cUrl,f=a("".charAt),v=r.Uint8Array,p=!v||!v.prototype.toBase64||!function(){try{(new v).toBase64(null)}catch(t){return!0}}();v&&i({target:"Uint8Array",proto:!0,forced:p},{toBase64:function(){var t=o(this),e=arguments.length?s(arguments[0]):undefined,n="base64"===h(e)?c:d,i=!!e&&!!e.omitPadding;l(this.buffer);for(var r,a="",u=0,v=t.length,p=function(t){return f(n,r>>6*t&63)};u+2<v;u+=3)r=(t[u]<<16)+(t[u+1]<<8)+t[u+2],a+=p(3)+p(2)+p(1)+p(0);return u+2===v?(r=(t[u]<<16)+(t[u+1]<<8),a+=p(3)+p(2)+p(1)+(i?"":"=")):u+1===v&&(r=t[u]<<16,a+=p(3)+p(2)+(i?"":"==")),a}})},9797:function(t,e,n){var i=n(6518),r=n(4576),a=n(3463),s=n(4154),o=n(5169),l=n(2303);r.Uint8Array&&i({target:"Uint8Array",proto:!0},{setFromHex:function(t){s(this),a(t),o(this.buffer);var e=l(t,this).read;return{read:e,written:e/2}}})},9835:function(t){t.exports=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},i=e[t](n);return 1===i.size&&4===i.values().next().value}catch(r){return!1}}},9928:function(t,e,n){var i=n(6198),r=n(1291),a=RangeError;t.exports=function(t,e,n,s){var o=i(t),l=r(n),u=l<0?o+l:l;if(u>=o||u<0)throw new a("Incorrect index");for(var h=new e(o),c=0;c<o;c++)h[c]=c===u?s:t[c];return h}}},Ui={};function zi(t){var e=Ui[t];if(e!==undefined)return e.exports;var n=Ui[t]={exports:{}};return Hi[t].call(n.exports,n,n.exports,zi),n.exports}zi(4114),zi(6573),zi(8100),zi(7936),zi(8111),zi(8237),zi(1689),zi(9577),zi(4235),zi(9432),zi(1549),zi(9797),zi(9631),zi(5623),zi(4979),zi(5781);var Gi=!("object"!==("undefined"==typeof process?"undefined":B(process))||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type),Vi=[.001,0,0,.001,0,0],qi=1.35,Xi=1,Yi=2,Ki=4,Qi=16,Ji=32,Zi=64,$i=128,tr=256,er={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},nr="pdfjs_internal_editor_",ir={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101,COMMENT:102},rr={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},ar={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},sr=0,or=1,lr=2,ur=3,hr=3,cr=4,dr={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},fr={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},vr=1,pr=2,gr=3,yr=4,mr=5,wr={ERRORS:0,WARNINGS:1,INFOS:5},br={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},kr=0,Ar=1,_r=2,xr=3,Sr={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},Er=wr.WARNINGS;function Mr(t){Number.isInteger(t)&&(Er=t)}function Cr(){return Er}function Tr(t){Er>=wr.INFOS&&console.log("Info: ".concat(t))}function Rr(t){Er>=wr.WARNINGS&&console.log("Warning: ".concat(t))}function Pr(t){throw new Error(t)}function Ir(t,e){t||Pr(e)}function Dr(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null,n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(!t)return null;if(n&&"string"==typeof t){if(n.addDefaultProtocol&&t.startsWith("www.")){var i=t.match(/\./g);(null==i?void 0:i.length)>=2&&(t="http://".concat(t))}if(n.tryConvertEncoding)try{t=decodeURIComponent(escape(t))}catch(a){}}var r=e?URL.parse(t,e):URL.parse(t);return function(t){switch(null==t?void 0:t.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(r)?r:null}function Lr(t,e){var n=arguments.length>2&&arguments[2]!==undefined&&arguments[2],i=URL.parse(t);return i?(i.hash=e,i.href):n&&Dr(t,"http://example.com")?t.split("#",1)[0]+"".concat(e?"#".concat(e):""):""}function Or(t,e,n){var i=arguments.length>3&&arguments[3]!==undefined&&arguments[3];return Object.defineProperty(t,e,{value:n,enumerable:!i,configurable:!0,writable:!1}),n}var Fr=function(){function t(t,e){this.message=t,this.name=e}return t.prototype=new Error,t.constructor=t,t}(),Nr=function(t){function e(t,n){var i;return c(this,e),(i=u(this,e,[t,"PasswordException"])).code=n,i}return _(e,t),m(e)}(Fr),Wr=function(t){function e(t,n){var i;return c(this,e),(i=u(this,e,[t,"UnknownErrorException"])).details=n,i}return _(e,t),m(e)}(Fr),Br=function(t){function e(t){return c(this,e),u(this,e,[t,"InvalidPDFException"])}return _(e,t),m(e)}(Fr),jr=function(t){function e(t,n,i){var r;return c(this,e),(r=u(this,e,[t,"ResponseException"])).status=n,r.missing=i,r}return _(e,t),m(e)}(Fr),Hr=function(t){function e(t){return c(this,e),u(this,e,[t,"FormatError"])}return _(e,t),m(e)}(Fr),Ur=function(t){function e(t){return c(this,e),u(this,e,[t,"AbortException"])}return _(e,t),m(e)}(Fr);function zr(t){"object"===B(t)&&(null==t?void 0:t.length)!==undefined||Pr("Invalid argument for bytesToString");var e=t.length,n=8192;if(e<n)return String.fromCharCode.apply(null,t);for(var i=[],r=0;r<e;r+=n){var a=Math.min(r+n,e),s=t.subarray(r,a);i.push(String.fromCharCode.apply(null,s))}return i.join("")}function Gr(t){"string"!=typeof t&&Pr("Invalid argument for stringToBytes");for(var e=t.length,n=new Uint8Array(e),i=0;i<e;++i)n[i]=255&t.charCodeAt(i);return n}var Vr=function(){return m((function t(){c(this,t)}),null,[{key:"isLittleEndian",get:function(){return Or(this,"isLittleEndian",((t=new Uint8Array(4))[0]=1,1===new Uint32Array(t.buffer,0,1)[0]));var t}},{key:"isEvalSupported",get:function(){return Or(this,"isEvalSupported",function(){try{return new Function(""),!0}catch(t){return!1}}())}},{key:"isOffscreenCanvasSupported",get:function(){return Or(this,"isOffscreenCanvasSupported","undefined"!=typeof OffscreenCanvas)}},{key:"isImageDecoderSupported",get:function(){return Or(this,"isImageDecoderSupported","undefined"!=typeof ImageDecoder)}},{key:"platform",get:function(){var t=navigator,e=t.platform,n=t.userAgent;return Or(this,"platform",{isAndroid:n.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:n.includes("Firefox")})}},{key:"isCSSRoundSupported",get:function(){var t,e;return Or(this,"isCSSRoundSupported",null===(t=globalThis.CSS)||void 0===t||null===(e=t.supports)||void 0===e?void 0:e.call(t,"width: round(1.5px, 1px)"))}}])}(),qr=Array.from(Array(256).keys(),(function(t){return t.toString(16).padStart(2,"0")})),Xr=function(){function t(){c(this,t)}return m(t,null,[{key:"makeHexColor",value:function(t,e,n){return"#".concat(qr[t]).concat(qr[e]).concat(qr[n])}},{key:"scaleMinMax",value:function(t,e){var n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}},{key:"transform",value:function(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}},{key:"applyTransform",value:function(t,e){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,i=t[n],r=t[n+1];t[n]=i*e[0]+r*e[2]+e[4],t[n+1]=i*e[1]+r*e[3]+e[5]}},{key:"applyTransformToBezier",value:function(t,e){for(var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,i=e[0],r=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=0;u<6;u+=2){var h=t[n+u],c=t[n+u+1];t[n+u]=h*i+c*a+o,t[n+u+1]=h*r+c*s+l}}},{key:"applyInverseTransform",value:function(t,e){var n=t[0],i=t[1],r=e[0]*e[3]-e[1]*e[2];t[0]=(n*e[3]-i*e[2]+e[2]*e[5]-e[4]*e[3])/r,t[1]=(-n*e[1]+i*e[0]+e[4]*e[1]-e[5]*e[0])/r}},{key:"axialAlignedBoundingBox",value:function(t,e,n){var i=e[0],r=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=t[0],h=t[1],c=t[2],d=t[3],f=i*u+o,v=f,p=i*c+o,g=p,y=s*h+l,m=y,w=s*d+l,b=w;if(0!==r||0!==a){var k=r*u,A=r*c,_=a*h,x=a*d;f+=_,g+=_,p+=x,v+=x,y+=k,b+=k,w+=A,m+=A}n[0]=Math.min(n[0],f,p,v,g),n[1]=Math.min(n[1],y,w,m,b),n[2]=Math.max(n[2],f,p,v,g),n[3]=Math.max(n[3],y,w,m,b)}},{key:"inverseTransform",value:function(t){var e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}},{key:"singularValueDecompose2dScale",value:function(t,e){var n=t[0],i=t[1],r=t[2],a=t[3],s=Math.pow(n,2)+Math.pow(i,2),o=n*r+i*a,l=Math.pow(r,2)+Math.pow(a,2),u=(s+l)/2,h=Math.sqrt(Math.pow(u,2)-(s*l-Math.pow(o,2)));e[0]=Math.sqrt(u+h||1),e[1]=Math.sqrt(u-h||1)}},{key:"normalizeRect",value:function(t){var e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}},{key:"intersect",value:function(t,e){var n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),i=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>i)return null;var r=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return r>a?null:[n,r,i,a]}},{key:"pointBoundingBox",value:function(t,e,n){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}},{key:"rectBoundingBox",value:function(t,e,n,i,r){r[0]=Math.min(r[0],t,n),r[1]=Math.min(r[1],e,i),r[2]=Math.max(r[2],t,n),r[3]=Math.max(r[3],e,i)}},{key:"bezierBoundingBox",value:function(e,n,i,a,s,o,l,u,h){h[0]=Math.min(h[0],e,l),h[1]=Math.min(h[1],n,u),h[2]=Math.max(h[2],e,l),h[3]=Math.max(h[3],n,u),r(t,this,Kr).call(this,e,i,s,l,n,a,o,u,3*(3*(i-s)-e+l),6*(e-2*i+s),3*(i-e),h),r(t,this,Kr).call(this,e,i,s,l,n,a,o,u,3*(3*(a-o)-n+u),6*(n-2*a+o),3*(a-n),h)}}])}();function Yr(t,e,n,i,r,a,s,o,l,u){if(!(l<=0||l>=1)){var h=1-l,c=l*l,d=c*l,f=h*(h*(h*t+3*l*e)+3*c*n)+d*i,v=h*(h*(h*r+3*l*a)+3*c*s)+d*o;u[0]=Math.min(u[0],f),u[1]=Math.min(u[1],v),u[2]=Math.max(u[2],f),u[3]=Math.max(u[3],v)}}function Kr(t,e,n,i,a,s,o,l,u,h,c,d){if(Math.abs(u)<1e-12)Math.abs(h)>=1e-12&&r(ki,this,Yr).call(this,t,e,n,i,a,s,o,l,-c/h,d);else{var f=Math.pow(h,2)-4*c*u;if(!(f<0)){var v=Math.sqrt(f),p=2*u;r(ki,this,Yr).call(this,t,e,n,i,a,s,o,l,(-h+v)/p,d),r(ki,this,Yr).call(this,t,e,n,i,a,s,o,l,(-h-v)/p,d)}}}ki=Xr;var Qr=null,Jr=null;function Zr(t){return Qr||(Qr=/([\xA0\xB5\u037E\u0EB3\u2000-\u200A\u202F\u2126\uFB00-\uFB04\uFB06\uFB20-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBA1\uFBA4-\uFBA9\uFBAE-\uFBB1\uFBD3-\uFBDC\uFBDE-\uFBE7\uFBEA-\uFBF8\uFBFC\uFBFD\uFC00-\uFC5D\uFC64-\uFCF1\uFCF5-\uFD3D\uFD88\uFDF4\uFDFA\uFDFB\uFE71\uFE77\uFE79\uFE7B\uFE7D]+)|(\uFB05+)/g,Jr=new Map([["ï¬","Å¿t"]])),t.replaceAll(Qr,(function(t,e,n){return e?e.normalize("NFKC"):Jr.get(n)}))}function $r(){if("function"==typeof crypto.randomUUID)return crypto.randomUUID();var t=new Uint8Array(32);return crypto.getRandomValues(t),zr(t)}var ta="pdfjs_internal_id_";function ea(t,e,n){return Math.min(Math.max(t,e),n)}function na(t){return Uint8Array.prototype.toBase64?t.toBase64():btoa(zr(t))}"function"!=typeof Math.sumPrecise&&(Math.sumPrecise=function(t){return t.reduce((function(t,e){return t+e}),0)}),"function"!=typeof AbortSignal.any&&(AbortSignal.any=function(t){var e,n=new AbortController,i=n.signal,r=w(t);try{for(r.s();!(e=r.n()).done;){var a=e.value;if(a.aborted)return n.abort(a.reason),i}}catch(u){r.e(u)}finally{r.f()}var s,o=w(t);try{var l=function(){var t=s.value;t.addEventListener("abort",(function(){n.abort(t.reason)}),{signal:i})};for(o.s();!(s=o.n()).done;)l()}catch(u){o.e(u)}finally{o.f()}return i}),zi(1701),zi(4628),zi(7642),zi(8004),zi(3853),zi(5876),zi(2475),zi(5024),zi(1698),zi(4603),zi(7566),zi(8721),zi(9314),zi(1148),zi(3579),zi(8335);var ia="http://www.w3.org/2000/svg",ra=m((function bb(){c(this,bb)}));function aa(t){return sa.apply(this,arguments)}function sa(){return sa=l(T().m((function t(e){var n,i,r,a=arguments;return T().w((function(t){for(;;)switch(t.n){case 0:if(n=a.length>1&&a[1]!==undefined?a[1]:"text",!va(e,document.baseURI)){t.n=7;break}return t.n=1,fetch(e);case 1:if((i=t.v).ok){t.n=2;break}throw new Error(i.statusText);case 2:r=n,t.n="arraybuffer"===r?3:"blob"===r?4:"json"===r?5:6;break;case 3:return t.a(2,i.arrayBuffer());case 4:return t.a(2,i.blob());case 5:return t.a(2,i.json());case 6:return t.a(2,i.text());case 7:return t.a(2,new Promise((function(t,i){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType=n,r.onreadystatechange=function(){if(r.readyState===XMLHttpRequest.DONE)if(200!==r.status&&0!==r.status)i(new Error(r.statusText));else{switch(n){case"arraybuffer":case"blob":case"json":return void t(r.response)}t(r.responseText)}},r.send(null)})))}}),t)}))),sa.apply(this,arguments)}Ai=ra,b(ra,"CSS",96),b(ra,"PDF",72),b(ra,"PDF_TO_CSS_UNITS",Ai.CSS/Ai.PDF);var oa=function(){function t(e){var n=e.viewBox,i=e.userUnit,r=e.scale,a=e.rotation,s=e.offsetX,o=void 0===s?0:s,l=e.offsetY,u=void 0===l?0:l,h=e.dontFlip,d=void 0!==h&&h;c(this,t),this.viewBox=n,this.userUnit=i,this.scale=r,this.rotation=a,this.offsetX=o,this.offsetY=u,r*=i;var f,v,p,g,y,m,w,b,k=(n[2]+n[0])/2,A=(n[3]+n[1])/2;switch((a%=360)<0&&(a+=360),a){case 180:f=-1,v=0,p=0,g=1;break;case 90:f=0,v=1,p=1,g=0;break;case 270:f=0,v=-1,p=-1,g=0;break;case 0:f=1,v=0,p=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}d&&(p=-p,g=-g),0===f?(y=Math.abs(A-n[1])*r+o,m=Math.abs(k-n[0])*r+u,w=(n[3]-n[1])*r,b=(n[2]-n[0])*r):(y=Math.abs(k-n[0])*r+o,m=Math.abs(A-n[1])*r+u,w=(n[2]-n[0])*r,b=(n[3]-n[1])*r),this.transform=[f*r,v*r,p*r,g*r,y-f*r*k-p*r*A,m-v*r*k-g*r*A],this.width=w,this.height=b}return m(t,[{key:"rawDims",get:function(){var t=this.viewBox;return Or(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}},{key:"clone",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=e.scale,i=void 0===n?this.scale:n,r=e.rotation,a=void 0===r?this.rotation:r,s=e.offsetX,o=void 0===s?this.offsetX:s,l=e.offsetY,u=void 0===l?this.offsetY:l,h=e.dontFlip,c=void 0!==h&&h;return new t({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:i,rotation:a,offsetX:o,offsetY:u,dontFlip:c})}},{key:"convertToViewportPoint",value:function(t,e){var n=[t,e];return Xr.applyTransform(n,this.transform),n}},{key:"convertToViewportRectangle",value:function(t){var e=[t[0],t[1]];Xr.applyTransform(e,this.transform);var n=[t[2],t[3]];return Xr.applyTransform(n,this.transform),[e[0],e[1],n[0],n[1]]}},{key:"convertToPdfPoint",value:function(t,e){var n=[t,e];return Xr.applyInverseTransform(n,this.transform),n}}])}(),la=function(t){function e(t){var n,i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return c(this,e),(n=u(this,e,[t,"RenderingCancelledException"])).extraDelay=i,n}return _(e,t),m(e)}(Fr);function ua(t){for(var e=t.length,n=0;n<e&&""===t[n].trim();)n++;return"data:"===t.substring(n,n+5).toLowerCase()}function ha(t){return"string"==typeof t&&/\.pdf$/i.test(t)}function ca(t){var e=t.split(/[#?]/,1);return(t=D(e,1)[0]).substring(t.lastIndexOf("/")+1)}function da(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"document.pdf";if("string"!=typeof t)return e;if(ua(t))return Rr('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;var n=function(t){try{return new URL(t)}catch(e){try{return new URL(decodeURIComponent(t))}catch(n){try{return new URL(t,"https://foo.bar")}catch(i){try{return new URL(decodeURIComponent(t),"https://foo.bar")}catch(r){return null}}}}}(t);if(!n)return e;var i=function(t){try{var e=decodeURIComponent(t);return e.includes("/")?(e=e.split("/").at(-1)).test(/^\.pdf$/i)?e:t:e}catch(n){return t}},r=/\.pdf$/i,a=n.pathname.split("/").at(-1);if(r.test(a))return i(a);if(n.searchParams.size>0){var s,o=w(Array.from(n.searchParams.values()).reverse());try{for(o.s();!(s=o.n()).done;){var l=s.value;if(r.test(l))return i(l)}}catch(f){o.e(f)}finally{o.f()}var u,h=w(Array.from(n.searchParams.keys()).reverse());try{for(h.s();!(u=h.n()).done;){var c=u.value;if(r.test(c))return i(c)}}catch(f){h.e(f)}finally{h.f()}}if(n.hash){var d=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(d)return i(d[0])}return e}var fa=function(){return m((function t(){c(this,t),b(this,"started",Object.create(null)),b(this,"times",[])}),[{key:"time",value:function(t){t in this.started&&Rr("Timer is already running for ".concat(t)),this.started[t]=Date.now()}},{key:"timeEnd",value:function(t){t in this.started||Rr("Timer has not been started for ".concat(t)),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}},{key:"toString",value:function(){var t,e=[],n=0,i=w(this.times);try{for(i.s();!(t=i.n()).done;){var r=t.value.name;n=Math.max(r.length,n)}}catch(c){i.e(c)}finally{i.f()}var a,s=w(this.times);try{for(s.s();!(a=s.n()).done;){var o=a.value,l=o.name,u=o.start,h=o.end;e.push("".concat(l.padEnd(n)," ").concat(h-u,"ms\n"))}}catch(c){s.e(c)}finally{s.f()}return e.join("")}}])}();function va(t,e){var n=e?URL.parse(t,e):URL.parse(t);return"http:"===(null==n?void 0:n.protocol)||"https:"===(null==n?void 0:n.protocol)}function pa(t){t.preventDefault()}function ga(t){t.preventDefault(),t.stopPropagation()}var ya=function(){function t(){c(this,t)}return m(t,null,[{key:"toDateObject",value:function(e){if(e instanceof Date)return e;if(!e||"string"!=typeof e)return null;r(t,this,ma)._||(ma._=r(t,this,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?")));var n=r(t,this,ma)._.exec(e);if(!n)return null;var i=parseInt(n[1],10),a=parseInt(n[2],10);a=a>=1&&a<=12?a-1:0;var s=parseInt(n[3],10);s=s>=1&&s<=31?s:1;var o=parseInt(n[4],10);o=o>=0&&o<=23?o:0;var l=parseInt(n[5],10);l=l>=0&&l<=59?l:0;var u=parseInt(n[6],10);u=u>=0&&u<=59?u:0;var h=n[7]||"Z",c=parseInt(n[8],10);c=c>=0&&c<=23?c:0;var d=parseInt(n[9],10)||0;return d=d>=0&&d<=59?d:0,"-"===h?(o+=c,l+=d):"+"===h&&(o-=c,l-=d),new Date(Date.UTC(i,a,s,o,l,u))}}])}(),ma={_:void 0};function wa(t,e){var n=e.scale,i=void 0===n?1:n,r=e.rotation,a=void 0===r?0:r,s=t.attributes.style,o=s.width,l=s.height,u=[0,0,parseInt(o),parseInt(l)];return new oa({viewBox:u,userUnit:1,scale:i,rotation:a})}function ba(t){if(t.startsWith("#")){var e=parseInt(t.slice(1),16);return[(16711680&e)>>16,(65280&e)>>8,255&e]}return t.startsWith("rgb(")?t.slice(4,-1).split(",").map((function(t){return parseInt(t)})):t.startsWith("rgba(")?t.slice(5,-1).split(",").map((function(t){return parseInt(t)})).slice(0,3):(Rr('Not a valid color format: "'.concat(t,'"')),[0,0,0])}function ka(t){var e=t.getTransform();return[e.a,e.b,e.c,e.d,e.e,e.f]}function Aa(t){var e=t.getTransform().invertSelf();return[e.a,e.b,e.c,e.d,e.e,e.f]}function _a(t,e){var n=arguments.length>2&&arguments[2]!==undefined&&arguments[2],i=!(arguments.length>3&&arguments[3]!==undefined)||arguments[3];if(e instanceof oa){var r=e.rawDims,a=r.pageWidth,s=r.pageHeight,o=t.style,l=Vr.isCSSRoundSupported,u="var(--total-scale-factor) * ".concat(a,"px"),h="var(--total-scale-factor) * ".concat(s,"px"),c=l?"round(down, ".concat(u,", var(--scale-round-x))"):"calc(".concat(u,")"),d=l?"round(down, ".concat(h,", var(--scale-round-y))"):"calc(".concat(h,")");n&&e.rotation%180!=0?(o.width=d,o.height=c):(o.width=c,o.height=d)}i&&t.setAttribute("data-main-rotation",e.rotation)}var xa=function(){function t(){c(this,t);var e=t.pixelRatio;this.sx=e,this.sy=e}return m(t,[{key:"scaled",get:function(){return 1!==this.sx||1!==this.sy}},{key:"symmetric",get:function(){return this.sx===this.sy}},{key:"limitCanvas",value:function(e,n,i,r){var a=arguments.length>4&&arguments[4]!==undefined?arguments[4]:-1,s=Infinity,o=Infinity,l=Infinity;(i=t.capPixels(i,a))>0&&(s=Math.sqrt(i/(e*n))),-1!==r&&(o=r/e,l=r/n);var u=Math.min(s,o,l);return(this.sx>u||this.sy>u)&&(this.sx=u,this.sy=u,!0)}}],[{key:"pixelRatio",get:function(){return globalThis.devicePixelRatio||1}},{key:"capPixels",value:function(t,e){if(e>=0){var n=Math.ceil(window.screen.availWidth*window.screen.availHeight*Math.pow(this.pixelRatio,2)*(1+e/100));return t>0?Math.min(t,n):n}return t}}])}(),Sa=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"],Ea=new WeakMap,Ma=new WeakMap,Ca=new WeakMap,Ta=new WeakMap,Ra=new WeakMap,Pa=new WeakMap,Ia=new WeakMap,Da=new WeakSet,La=function(){return m((function i(t){c(this,i),g(this,Da),f(this,Ea,null),f(this,Ma,null),f(this,Ca,void 0),f(this,Ta,null),f(this,Ra,null),f(this,Pa,null),f(this,Ia,null),v(Ca,this,t),ja._||(ja._=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}),[{key:"render",value:function(){var t=v(Ea,this,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");var e=d(Ca,this)._uiManager._signal;t.addEventListener("contextmenu",pa,{signal:e}),t.addEventListener("pointerdown",Oa,{signal:e});var n=v(Ta,this,document.createElement("div"));n.className="buttons",t.append(n);var i=d(Ca,this).toolbarPosition;if(i){var r=t.style,a="ltr"===d(Ca,this)._uiManager.direction?1-i[0]:i[0];r.insetInlineEnd="".concat(100*a,"%"),r.top="calc(".concat(100*i[1],"% + var(--editor-toolbar-vert-offset))")}return t}},{key:"div",get:function(){return d(Ea,this)}},{key:"hide",value:function(){var t;d(Ea,this).classList.add("hidden"),null===(t=d(Ma,this))||void 0===t||t.hideDropdown()}},{key:"show",value:function(){var t,e;d(Ea,this).classList.remove("hidden"),null===(t=d(Ra,this))||void 0===t||t.shown(),null===(e=d(Pa,this))||void 0===e||e.shown()}},{key:"addDeleteButton",value:function(){var t=d(Ca,this),e=t.editorType,n=t._uiManager,i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",ja._[e]),r(Da,this,Wa).call(this,i),i.addEventListener("click",(function(t){n["delete"]()}),{signal:n._signal}),d(Ta,this).append(i)}},{key:"addAltText",value:(n=l(T().m((function a(t){var e;return T().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,t.render();case 1:e=n.v,r(Da,this,Wa).call(this,e),d(Ta,this).append(e,p(Da,this,Ba)),v(Ra,this,t);case 2:return n.a(2)}}),a,this)}))),function(t){return n.apply(this,arguments)})},{key:"addComment",value:function(t){if(!d(Pa,this)){var e=t.render();e&&(r(Da,this,Wa).call(this,e),d(Ta,this).prepend(e,p(Da,this,Ba)),v(Pa,this,t),t.toolbar=this)}}},{key:"addColorPicker",value:function(t){if(!d(Ma,this)){v(Ma,this,t);var e=t.renderButton();r(Da,this,Wa).call(this,e),d(Ta,this).append(e,p(Da,this,Ba))}}},{key:"addEditSignatureButton",value:(e=l(T().m((function s(t){var e,n,i,a,o;return T().w((function(s){for(;;)switch(s.n){case 0:return n=v,i=Ia,a=this,s.n=1,t.renderEditButton(d(Ca,this));case 1:o=s.v,e=n(i,a,o),r(Da,this,Wa).call(this,e),d(Ta,this).append(e,p(Da,this,Ba));case 2:return s.a(2)}}),s,this)}))),function(t){return e.apply(this,arguments)})},{key:"addButton",value:(t=l(T().m((function o(t,e){var n;return T().w((function(i){for(;;)switch(i.n){case 0:n=t,i.n="colorPicker"===n?1:"altText"===n?2:"editSignature"===n?4:"delete"===n?6:"comment"===n?7:8;break;case 1:return this.addColorPicker(e),i.a(3,8);case 2:return i.n=3,this.addAltText(e);case 3:case 5:return i.a(3,8);case 4:return i.n=5,this.addEditSignatureButton(e);case 6:return this.addDeleteButton(),i.a(3,8);case 7:return this.addComment(e),i.a(3,8);case 8:return i.a(2)}}),o,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"updateEditSignatureButton",value:function(t){d(Ia,this)&&(d(Ia,this).title=t)}},{key:"remove",value:function(){var t;d(Ea,this).remove(),null===(t=d(Ma,this))||void 0===t||t.destroy(),v(Ma,this,null)}}]);var t,e,n}();function Oa(t){t.stopPropagation()}function Fa(t){d(Ca,this)._focusEventsAllowed=!1,ga(t)}function Na(t){d(Ca,this)._focusEventsAllowed=!0,ga(t)}function Wa(t){var e=d(Ca,this)._uiManager._signal;t.addEventListener("focusin",r(Da,this,Fa).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",r(Da,this,Na).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",pa,{signal:e})}function Ba(t){var e=document.createElement("div");return e.className="divider",e}var ja={_:null},Ha=new WeakMap,Ua=new WeakMap,za=new WeakMap,Ga=new WeakSet,Va=function(){return m((function t(e){c(this,t),g(this,Ga),f(this,Ha,null),f(this,Ua,null),f(this,za,void 0),v(za,this,e)}),[{key:"show",value:function(t,e,n){var i=D(r(Ga,this,Xa).call(this,e,n),2),a=i[0],s=i[1],o=(d(Ua,this)||v(Ua,this,r(Ga,this,qa).call(this))).style;t.append(d(Ua,this)),o.insetInlineEnd="".concat(100*a,"%"),o.top="calc(".concat(100*s,"% + var(--editor-toolbar-vert-offset))")}},{key:"hide",value:function(){d(Ua,this).remove()}}])}();function qa(){var t=this,e=v(Ua,this,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",pa,{signal:d(za,this)._signal});var n=v(Ha,this,document.createElement("div"));return n.className="buttons",e.append(n),d(za,this).hasCommentManager()&&r(Ga,this,Ya).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",(function(){d(za,t).commentSelection("floating_button")})),r(Ga,this,Ya).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",(function(){d(za,t).highlightSelection("floating_button")})),e}function Xa(t,e){var n,i=0,r=0,a=w(t);try{for(a.s();!(n=a.n()).done;){var s=n.value,o=s.y+s.height;if(!(o<i)){var l=s.x+(e?s.width:0);o>i?(r=l,i=o):e?l>r&&(r=l):l<r&&(r=l)}}}catch(u){a.e(u)}finally{a.f()}return[e?1-r:r,i]}function Ya(t,e,n,i){var r=document.createElement("button");r.classList.add("basic",t),r.tabIndex=0,r.setAttribute("data-l10n-id",e);var a=document.createElement("span");r.append(a),a.className="visuallyHidden",a.setAttribute("data-l10n-id",n);var s=d(za,this)._signal;r.addEventListener("contextmenu",pa,{signal:s}),r.addEventListener("click",i,{signal:s}),d(Ha,this).append(r)}function Ka(t,e,n){var i,r=w(n);try{for(r.s();!(i=r.n()).done;){var a=i.value;e.addEventListener(a,t[a].bind(t))}}catch(s){r.e(s)}finally{r.f()}}var Qa=new WeakMap,Ja=function(){return m((function t(){c(this,t),f(this,Qa,0)}),[{key:"id",get:function(){var t,e;return"".concat(nr).concat((v(Qa,this,(t=d(Qa,this),e=t++,t)),e))}}])}(),Za=new WeakMap,$a=new WeakMap,ts=new WeakMap,es=new WeakSet,ns=function(){return m((function a(){c(this,a),g(this,es),f(this,Za,$r()),f(this,$a,0),f(this,ts,null)}),[{key:"getFromFile",value:(i=l(T().m((function s(t){var e,n,i,a;return T().w((function(s){for(;;)if(0===s.n)return e=t.lastModified,n=t.name,i=t.size,a=t.type,s.a(2,r(es,this,is).call(this,"".concat(e,"_").concat(n,"_").concat(i,"_").concat(a),t))}),s,this)}))),function(t){return i.apply(this,arguments)})},{key:"getFromUrl",value:(n=l(T().m((function o(t){return T().w((function(e){for(;;)if(0===e.n)return e.a(2,r(es,this,is).call(this,t,t))}),o,this)}))),function(t){return n.apply(this,arguments)})},{key:"getFromBlob",value:(e=l(T().m((function u(t,e){var n;return T().w((function(i){for(;;)switch(i.n){case 0:return i.n=1,e;case 1:return n=i.v,i.a(2,r(es,this,is).call(this,t,n))}}),u,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"getFromId",value:(t=l(T().m((function h(t){var e,n;return T().w((function(i){for(;;)switch(i.n){case 0:if(d(ts,this)||v(ts,this,new Map),e=d(ts,this).get(t)){i.n=1;break}return i.a(2,null);case 1:if(!e.bitmap){i.n=2;break}return e.refCounter+=1,i.a(2,e);case 2:if(!e.file){i.n=3;break}return i.a(2,this.getFromFile(e.file));case 3:if(!e.blobPromise){i.n=4;break}return n=e.blobPromise,delete e.blobPromise,i.a(2,this.getFromBlob(e.id,n));case 4:return i.a(2,this.getFromUrl(e.url))}}),h,this)}))),function(e){return t.apply(this,arguments)})},{key:"getFromCanvas",value:function(t,e){var n,i,r;d(ts,this)||v(ts,this,new Map);var a=d(ts,this).get(t);if(null!==(r=a)&&void 0!==r&&r.bitmap)return a.refCounter+=1,a;var s=new OffscreenCanvas(e.width,e.height);return s.getContext("2d").drawImage(e,0,0),a={bitmap:s.transferToImageBitmap(),id:"image_".concat(d(Za,this),"_").concat((v($a,this,(n=d($a,this),i=n++,n)),i)),refCounter:1,isSvg:!1},d(ts,this).set(t,a),d(ts,this).set(a.id,a),a}},{key:"getSvgUrl",value:function(t){var e=d(ts,this).get(t);return null!=e&&e.isSvg?e.svgUrl:null}},{key:"deleteId",value:function(t){var e;d(ts,this)||v(ts,this,new Map);var n=d(ts,this).get(t);if(n&&(n.refCounter-=1,0===n.refCounter)){var i=n.bitmap;if(!n.url&&!n.file){var r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),n.blobPromise=r.convertToBlob()}null===(e=i.close)||void 0===e||e.call(i),n.bitmap=null}}},{key:"isValidId",value:function(t){return t.startsWith("image_".concat(d(Za,this),"_"))}}],[{key:"_isSVGFittingCanvas",get:function(){var t=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),e=new Image;return e.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Or(this,"_isSVGFittingCanvas",e.decode().then((function(){return t.drawImage(e,0,0,1,1,0,0,1,3),0===new Uint32Array(t.getImageData(0,0,1,1).data.buffer)[0]})))}}]);var t,e,n,i}();function is(t,e){return rs.apply(this,arguments)}function rs(){return(rs=l(T().m((function t(e,n){var i,r,a,s,o,u,h,c,f;return T().w((function(t){for(;;)switch(t.p=t.n){case 0:if(d(ts,this)||v(ts,this,new Map),null!==(r=d(ts,this).get(e))){t.n=1;break}return t.a(2,null);case 1:if(null===(i=r)||void 0===i||!i.bitmap){t.n=2;break}return r.refCounter+=1,t.a(2,r);case 2:if(t.p=2,r||(r={bitmap:null,id:"image_".concat(d(Za,this),"_").concat((v($a,this,(a=d($a,this),s=a++,a)),s)),refCounter:0,isSvg:!1}),"string"!=typeof n){t.n=4;break}return r.url=n,t.n=3,aa(n,"blob");case 3:o=t.v,t.n=5;break;case 4:n instanceof File?o=r.file=n:n instanceof Blob&&(o=n);case 5:if("image/svg+xml"!==o.type){t.n=7;break}return u=_i._isSVGFittingCanvas,h=new FileReader,c=new Image,f=new Promise((function(t,e){c.onload=function(){r.bitmap=c,r.isSvg=!0,t()},h.onload=l(T().m((function n(){var t,e;return T().w((function(n){for(;;)switch(n.n){case 0:return t=r.svgUrl=h.result,n.n=1,u;case 1:if(!n.v){n.n=2;break}e="".concat(t,"#svgView(preserveAspectRatio(none))"),n.n=3;break;case 2:e=t;case 3:c.src=e;case 4:return n.a(2)}}),n)}))),c.onerror=h.onerror=e})),h.readAsDataURL(o),t.n=6,f;case 6:t.n=9;break;case 7:return t.n=8,createImageBitmap(o);case 8:r.bitmap=t.v;case 9:r.refCounter=1,t.n=11;break;case 10:t.p=10,Rr(t.v),r=null;case 11:return d(ts,this).set(e,r),r&&d(ts,this).set(r.id,r),t.a(2,r)}}),t,this,[[2,10]])})))).apply(this,arguments)}_i=ns;var as=new WeakMap,ss=new WeakMap,os=new WeakMap,ls=new WeakMap,us=function(){return m((function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:128;c(this,t),f(this,as,[]),f(this,ss,!1),f(this,os,void 0),f(this,ls,-1),v(os,this,e)}),[{key:"add",value:function(t){var e=t.cmd,n=t.undo,i=t.post,r=t.mustExec,a=t.type,s=void 0===a?NaN:a,o=t.overwriteIfSameType,l=void 0!==o&&o,u=t.keepUndo,h=void 0!==u&&u;if(r&&e(),!d(ss,this)){var c={cmd:e,undo:n,post:i,type:s};if(-1===d(ls,this))return d(as,this).length>0&&(d(as,this).length=0),v(ls,this,0),void d(as,this).push(c);if(l&&d(as,this)[d(ls,this)].type===s)return h&&(c.undo=d(as,this)[d(ls,this)].undo),void(d(as,this)[d(ls,this)]=c);var f=d(ls,this)+1;f===d(os,this)?d(as,this).splice(0,1):(v(ls,this,f),f<d(as,this).length&&d(as,this).splice(f)),d(as,this).push(c)}}},{key:"undo",value:function(){if(-1!==d(ls,this)){v(ss,this,!0);var t=d(as,this)[d(ls,this)],e=t.undo,n=t.post;e(),null==n||n(),v(ss,this,!1),v(ls,this,d(ls,this)-1)}}},{key:"redo",value:function(){if(d(ls,this)<d(as,this).length-1){v(ls,this,d(ls,this)+1),v(ss,this,!0);var t=d(as,this)[d(ls,this)],e=t.cmd,n=t.post;e(),null==n||n(),v(ss,this,!1)}}},{key:"hasSomethingToUndo",value:function(){return-1!==d(ls,this)}},{key:"hasSomethingToRedo",value:function(){return d(ls,this)<d(as,this).length-1}},{key:"cleanType",value:function(t){if(-1!==d(ls,this)){for(var e=d(ls,this);e>=0;e--)if(d(as,this)[e].type!==t)return d(as,this).splice(e+1,d(ls,this)-e),void v(ls,this,e);d(as,this).length=0,v(ls,this,-1)}}},{key:"destroy",value:function(){v(as,this,null)}}])}(),hs=new WeakSet,cs=function(){return m((function t(e){c(this,t),g(this,hs),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;var n,i=Vr.platform.isMac,r=w(e);try{for(r.s();!(n=r.n()).done;){var a,s=D(n.value,3),o=s[0],l=s[1],u=s[2],h=void 0===u?{}:u,d=w(o);try{for(d.s();!(a=d.n()).done;){var f=a.value,v=f.startsWith("mac+");i&&v?(this.callbacks.set(f.slice(4),{callback:l,options:h}),this.allKeys.add(f.split("+").at(-1))):i||v||(this.callbacks.set(f,{callback:l,options:h}),this.allKeys.add(f.split("+").at(-1)))}}catch(p){d.e(p)}finally{d.f()}}}catch(p){r.e(p)}finally{r.f()}}),[{key:"exec",value:function(t,e){if(this.allKeys.has(e.key)){var n=this.callbacks.get(r(hs,this,ds).call(this,e));if(n){var i=n.callback,a=n.options,s=a.bubbles,o=void 0!==s&&s,l=a.args,u=void 0===l?[]:l,h=a.checker,c=void 0===h?null:h;c&&!c(t,e)||(i.bind.apply(i,[t].concat(F(u),[e]))(),o||ga(e))}}}}])}();function ds(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);var e=this.buffer.join("+");return this.buffer.length=0,e}var fs=function(){function t(){c(this,t)}return m(t,[{key:"_colors",get:function(){var t=new Map([["CanvasText",null],["Canvas",null]]);return function(t){var e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);var n,i=w(t.keys());try{for(i.s();!(n=i.n()).done;){var r=n.value;e.style.color=r;var a=window.getComputedStyle(e).color;t.set(r,ba(a))}}catch(s){i.e(s)}finally{i.f()}e.remove()}(t),Or(this,"_colors",t)}},{key:"convert",value:function(e){var n=ba(e);if(!window.matchMedia("(forced-colors: active)").matches)return n;var i,r=w(this._colors);try{for(r.s();!(i=r.n()).done;){var a=D(i.value,2),s=a[0];if(a[1].every((function(t,e){return t===n[e]})))return t._colorsMapping.get(s)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getHexCode",value:function(t){var e=this._colors.get(t);return e?Xr.makeHexColor.apply(Xr,F(e)):t}}])}();b(fs,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));var vs=new WeakMap,ps=new WeakMap,gs=new WeakMap,ys=new WeakMap,ms=new WeakMap,ws=new WeakMap,bs=new WeakMap,ks=new WeakMap,As=new WeakMap,_s=new WeakMap,xs=new WeakMap,Ss=new WeakMap,Es=new WeakMap,Ms=new WeakMap,Cs=new WeakMap,Ts=new WeakMap,Rs=new WeakMap,Ps=new WeakMap,Is=new WeakMap,Ds=new WeakMap,Ls=new WeakMap,Os=new WeakMap,Fs=new WeakMap,Ns=new WeakMap,Ws=new WeakMap,Bs=new WeakMap,js=new WeakMap,Hs=new WeakMap,Us=new WeakMap,zs=new WeakMap,Gs=new WeakMap,Vs=new WeakMap,qs=new WeakMap,Xs=new WeakMap,Ys=new WeakMap,Ks=new WeakMap,Qs=new WeakMap,Js=new WeakMap,Zs=new WeakMap,$s=new WeakMap,to=new WeakMap,eo=new WeakMap,no=new WeakMap,io=new WeakMap,ro=new WeakMap,ao=new WeakMap,so=new WeakMap,oo=new WeakSet,lo=function(){function t(e,n,i,a,s,o,l,u,h,p,y,m,w,k,A,_){var x=this;c(this,t),g(this,oo),f(this,vs,new AbortController),f(this,ps,null),f(this,gs,new Map),f(this,ys,new Map),f(this,ms,null),f(this,ws,null),f(this,bs,null),f(this,ks,new us),f(this,As,null),f(this,_s,null),f(this,xs,null),f(this,Ss,0),f(this,Es,new Set),f(this,Ms,null),f(this,Cs,null),f(this,Ts,new Set),b(this,"_editorUndoBar",null),f(this,Rs,!1),f(this,Ps,!1),f(this,Is,!1),f(this,Ds,null),f(this,Ls,null),f(this,Os,null),f(this,Fs,null),f(this,Ns,!1),f(this,Ws,null),f(this,Bs,new Ja),f(this,js,!1),f(this,Hs,!1),f(this,Us,!1),f(this,zs,null),f(this,Gs,null),f(this,Vs,null),f(this,qs,null),f(this,Xs,null),f(this,Ys,ir.NONE),f(this,Ks,new Set),f(this,Qs,null),f(this,Js,null),f(this,Zs,null),f(this,$s,null),f(this,to,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1}),f(this,eo,[0,0]),f(this,no,null),f(this,io,null),f(this,ro,null),f(this,ao,null),f(this,so,null);var S=this._signal=d(vs,this).signal;v(io,this,e),v(ro,this,n),v(ao,this,i),v(ms,this,a),v(As,this,s),v(Js,this,o),this._eventBus=l,l._on("editingaction",this.onEditingAction.bind(this),{signal:S}),l._on("pagechanging",this.onPageChanging.bind(this),{signal:S}),l._on("scalechanging",this.onScaleChanging.bind(this),{signal:S}),l._on("rotationchanging",this.onRotationChanging.bind(this),{signal:S}),l._on("setpreference",this.onSetPreference.bind(this),{signal:S}),l._on("switchannotationeditorparams",(function(t){return x.updateParams(t.type,t.value)}),{signal:S}),window.addEventListener("pointerdown",(function(){v(Hs,x,!0)}),{capture:!0,signal:S}),window.addEventListener("pointerup",(function(){v(Hs,x,!1)}),{capture:!0,signal:S}),r(oo,this,po).call(this),r(oo,this,Ao).call(this),r(oo,this,mo).call(this),v(ws,this,u.annotationStorage),v(Ds,this,u.filterFactory),v(Zs,this,h),v(Fs,this,p||null),v(Rs,this,y),v(Ps,this,m),v(Is,this,w),v(Xs,this,k||null),this.viewParameters={realScale:ra.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=A||null,this._supportsPinchToZoom=!1!==_}return m(t,[{key:"destroy",value:function(){var t,e,n,i,r,a,s,o,l;null===(t=d(so,this))||void 0===t||t.resolve(),v(so,this,null),null===(e=d(vs,this))||void 0===e||e.abort(),v(vs,this,null),this._signal=null;var u,h=w(d(ys,this).values());try{for(h.s();!(u=h.n()).done;){u.value.destroy()}}catch(c){h.e(c)}finally{h.f()}d(ys,this).clear(),d(gs,this).clear(),d(Ts,this).clear(),null===(n=d(qs,this))||void 0===n||n.clear(),v(ps,this,null),d(Ks,this).clear(),d(ks,this).destroy(),null===(i=d(ms,this))||void 0===i||i.destroy(),null===(r=d(As,this))||void 0===r||r.destroy(),null===(a=d(Js,this))||void 0===a||a.destroy(),null===(s=d(Ws,this))||void 0===s||s.hide(),v(Ws,this,null),null===(o=d(Vs,this))||void 0===o||o.destroy(),v(Vs,this,null),d(Ls,this)&&(clearTimeout(d(Ls,this)),v(Ls,this,null)),d(no,this)&&(clearTimeout(d(no,this)),v(no,this,null)),null===(l=this._editorUndoBar)||void 0===l||l.destroy()}},{key:"combinedSignal",value:function(t){return AbortSignal.any([this._signal,t.signal])}},{key:"mlManager",get:function(){return d(Xs,this)}},{key:"useNewAltTextFlow",get:function(){return d(Ps,this)}},{key:"useNewAltTextWhenAddingImage",get:function(){return d(Is,this)}},{key:"hcmFilter",get:function(){return Or(this,"hcmFilter",d(Zs,this)?d(Ds,this).addHCMFilter(d(Zs,this).foreground,d(Zs,this).background):"none")}},{key:"direction",get:function(){return Or(this,"direction",getComputedStyle(d(io,this)).direction)}},{key:"_highlightColors",get:function(){return Or(this,"_highlightColors",d(Fs,this)?new Map(d(Fs,this).split(",").map((function(t){return(t=t.split("=").map((function(t){return t.trim()})))[1]=t[1].toUpperCase(),t}))):null)}},{key:"highlightColors",get:function(){var t=this._highlightColors;if(!t)return Or(this,"highlightColors",null);var e,n=new Map,i=!!d(Zs,this),r=w(t);try{for(r.s();!(e=r.n()).done;){var a=D(e.value,2),s=a[0],o=a[1],l=s.endsWith("_HCM");i&&l?n.set(s.replace("_HCM",""),o):i||l||n.set(s,o)}}catch(u){r.e(u)}finally{r.f()}return Or(this,"highlightColors",n)}},{key:"highlightColorNames",get:function(){return Or(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,(function(t){return t.reverse()}))):null)}},{key:"getNonHCMColor",value:function(t){if(!this._highlightColors)return t;var e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}},{key:"getNonHCMColorName",value:function(t){return this.highlightColorNames.get(t)||t}},{key:"setCurrentDrawingSession",value:function(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),v(xs,this,t)}},{key:"setMainHighlightColorPicker",value:function(t){v(Vs,this,t)}},{key:"editAltText",value:function(t){var e,n=arguments.length>1&&arguments[1]!==undefined&&arguments[1];null===(e=d(ms,this))||void 0===e||e.editAltText(this,t,n)}},{key:"hasCommentManager",value:function(){return!!d(As,this)}},{key:"editComment",value:function(t,e){var n;null===(n=d(As,this))||void 0===n||n.open(this,t,e)}},{key:"getSignature",value:function(t){var e;null===(e=d(Js,this))||void 0===e||e.getSignature({uiManager:this,editor:t})}},{key:"signatureManager",get:function(){return d(Js,this)}},{key:"switchToMode",value:function(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}},{key:"setPreference",value:function(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}},{key:"onSetPreference",value:function(t){var e=t.name,n=t.value;if("enableNewAltTextWhenAddingImage"===e)v(Is,this,n)}},{key:"onPageChanging",value:function(t){var e=t.pageNumber;v(Ss,this,e-1)}},{key:"focusMainContainer",value:function(){d(io,this).focus()}},{key:"findParent",value:function(t,e){var n,i=w(d(ys,this).values());try{for(i.s();!(n=i.n()).done;){var r=n.value,a=r.div.getBoundingClientRect(),s=a.x,o=a.y,l=a.width,u=a.height;if(t>=s&&t<=s+l&&e>=o&&e<=o+u)return r}}catch(h){i.e(h)}finally{i.f()}return null}},{key:"disableUserSelect",value:function(){var t=arguments.length>0&&arguments[0]!==undefined&&arguments[0];d(ro,this).classList.toggle("noUserSelect",t)}},{key:"addShouldRescale",value:function(t){d(Ts,this).add(t)}},{key:"removeShouldRescale",value:function(t){d(Ts,this)["delete"](t)}},{key:"onScaleChanging",value:function(t){var e,n=t.scale;this.commitOrRemove(),this.viewParameters.realScale=n*ra.PDF_TO_CSS_UNITS;var i,r=w(d(Ts,this));try{for(r.s();!(i=r.n()).done;){i.value.onScaleChanging()}}catch(a){r.e(a)}finally{r.f()}null===(e=d(xs,this))||void 0===e||e.onScaleChanging()}},{key:"onRotationChanging",value:function(t){var e=t.pagesRotation;this.commitOrRemove(),this.viewParameters.rotation=e}},{key:"highlightSelection",value:function(){var t=this,e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"",n=arguments.length>1&&arguments[1]!==undefined&&arguments[1],i=document.getSelection();if(i&&!i.isCollapsed){var a=i.anchorNode,s=i.anchorOffset,o=i.focusNode,l=i.focusOffset,u=i.toString(),h=r(oo,this,uo).call(this,i).closest(".textLayer"),c=this.getSelectionBoxes(h);if(c){i.empty();var f=r(oo,this,ho).call(this,h),v=d(Ys,this)===ir.NONE,p=function(){var i=null==f?void 0:f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:c,anchorNode:a,anchorOffset:s,focusNode:o,focusOffset:l,text:u});v&&t.showAllEditors("highlight",!0,!0),n&&(null==i||i.editComment())};v?this.switchToMode(ir.HIGHLIGHT,p):p()}}}},{key:"commentSelection",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";this.highlightSelection(t,!0)}},{key:"addToAnnotationStorage",value:function(t){t.isEmpty()||!d(ws,this)||d(ws,this).has(t.id)||d(ws,this).setValue(t.id,t)}},{key:"a11yAlert",value:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null,n=d(ao,this);n&&(n.setAttribute("data-l10n-id",t),e?n.setAttribute("data-l10n-args",JSON.stringify(e)):n.removeAttribute("data-l10n-args"))}},{key:"blur",value:function(){if(this.isShiftKeyDown=!1,d(Ns,this)&&(v(Ns,this,!1),r(oo,this,vo).call(this,"main_toolbar")),this.hasSelection){var t,e=document.activeElement,n=w(d(Ks,this));try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.div.contains(e)){v(Gs,this,[i,e]),i._focusEventsAllowed=!1;break}}}catch(a){n.e(a)}finally{n.f()}}}},{key:"focus",value:function(){if(d(Gs,this)){var t=D(d(Gs,this),2),e=t[0],n=t[1];v(Gs,this,null),n.addEventListener("focusin",(function(){e._focusEventsAllowed=!0}),{once:!0,signal:this._signal}),n.focus()}}},{key:"addEditListeners",value:function(){r(oo,this,mo).call(this),r(oo,this,bo).call(this)}},{key:"removeEditListeners",value:function(){r(oo,this,wo).call(this),r(oo,this,ko).call(this)}},{key:"dragOver",value:function(t){var e,n=w(t.dataTransfer.items);try{for(n.s();!(e=n.n()).done;){var i,r=e.value.type,a=w(d(Cs,this));try{for(a.s();!(i=a.n()).done;){if(i.value.isHandlingMimeForPasting(r))return t.dataTransfer.dropEffect="copy",void t.preventDefault()}}catch(s){a.e(s)}finally{a.f()}}}catch(s){n.e(s)}finally{n.f()}}},{key:"drop",value:function(t){var e,n=w(t.dataTransfer.items);try{for(n.s();!(e=n.n()).done;){var i,r=e.value,a=w(d(Cs,this));try{for(a.s();!(i=a.n()).done;){var s=i.value;if(s.isHandlingMimeForPasting(r.type))return s.paste(r,this.currentLayer),void t.preventDefault()}}catch(o){a.e(o)}finally{a.f()}}}catch(o){n.e(o)}finally{n.f()}}},{key:"copy",value:function(t){var e;if(t.preventDefault(),null===(e=d(ps,this))||void 0===e||e.commitOrRemove(),this.hasSelection){var n,i=[],r=w(d(Ks,this));try{for(r.s();!(n=r.n()).done;){var a=n.value.serialize(!0);a&&i.push(a)}}catch(s){r.e(s)}finally{r.f()}0!==i.length&&t.clipboardData.setData("application/pdfjs",JSON.stringify(i))}}},{key:"cut",value:function(t){this.copy(t),this["delete"]()}},{key:"paste",value:(n=l(T().m((function i(t){var e,n,a,s,o,l,u,h,c,f,v,p,g,y,m,b,k,A,_,x,S,E=this;return T().w((function(i){for(;;)switch(i.p=i.n){case 0:t.preventDefault(),e=t.clipboardData,n=w(e.items),i.p=1,n.s();case 2:if((a=n.n()).done){i.n=10;break}s=a.value,o=w(d(Cs,this)),i.p=3,o.s();case 4:if((l=o.n()).done){i.n=6;break}if(!(u=l.value).isHandlingMimeForPasting(s.type)){i.n=5;break}return u.paste(s,this.currentLayer),i.a(2);case 5:i.n=4;break;case 6:i.n=8;break;case 7:i.p=7,k=i.v,o.e(k);case 8:return i.p=8,o.f(),i.f(8);case 9:i.n=2;break;case 10:i.n=12;break;case 11:i.p=11,A=i.v,n.e(A);case 12:return i.p=12,n.f(),i.f(12);case 13:if(h=e.getData("application/pdfjs")){i.n=14;break}return i.a(2);case 14:i.p=14,h=JSON.parse(h),i.n=16;break;case 15:return i.p=15,_=i.v,Rr('paste: "'.concat(_.message,'".')),i.a(2);case 16:if(Array.isArray(h)){i.n=17;break}return i.a(2);case 17:this.unselectAll(),c=this.currentLayer,i.p=18,f=[],v=w(h),i.p=19,v.s();case 20:if((p=v.n()).done){i.n=24;break}return g=p.value,i.n=21,c.deserialize(g);case 21:if(y=i.v){i.n=22;break}return i.a(2);case 22:f.push(y);case 23:i.n=20;break;case 24:i.n=26;break;case 25:i.p=25,x=i.v,v.e(x);case 26:return i.p=26,v.f(),i.f(26);case 27:m=function(){for(var t=0,e=f;t<e.length;t++){var n=e[t];r(oo,E,Co).call(E,n)}r(oo,E,Po).call(E,f)},b=function(){for(var t=0,e=f;t<e.length;t++)e[t].remove()},this.addCommands({cmd:m,undo:b,mustExec:!0}),i.n=29;break;case 28:i.p=28,S=i.v,Rr('paste: "'.concat(S.message,'".'));case 29:return i.a(2)}}),i,this,[[19,25,26,27],[18,28],[14,15],[3,7,8,9],[1,11,12,13]])}))),function(t){return n.apply(this,arguments)})},{key:"keydown",value:function(e){this.isShiftKeyDown||"Shift"!==e.key||(this.isShiftKeyDown=!0),d(Ys,this)===ir.NONE||this.isEditorHandlingKeyboard||t._keyboardManager.exec(this,e)}},{key:"keyup",value:function(t){this.isShiftKeyDown&&"Shift"===t.key&&(this.isShiftKeyDown=!1,d(Ns,this)&&(v(Ns,this,!1),r(oo,this,vo).call(this,"main_toolbar")))}},{key:"onEditingAction",value:function(t){var e=t.name;switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu")}}},{key:"setEditingState",value:function(t){t?(r(oo,this,go).call(this),r(oo,this,bo).call(this),r(oo,this,_o).call(this,{isEditing:d(Ys,this)!==ir.NONE,isEmpty:r(oo,this,Ro).call(this),hasSomethingToUndo:d(ks,this).hasSomethingToUndo(),hasSomethingToRedo:d(ks,this).hasSomethingToRedo(),hasSelectedEditor:!1})):(r(oo,this,yo).call(this),r(oo,this,ko).call(this),r(oo,this,_o).call(this,{isEditing:!1}),this.disableUserSelect(!1))}},{key:"registerEditorTypes",value:function(t){if(!d(Cs,this)){v(Cs,this,t);var e,n=w(d(Cs,this));try{for(n.s();!(e=n.n()).done;){var i=e.value;r(oo,this,xo).call(this,i.defaultPropertiesToUpdate)}}catch(a){n.e(a)}finally{n.f()}}}},{key:"getId",value:function(){return d(Bs,this).id}},{key:"currentLayer",get:function(){return d(ys,this).get(d(Ss,this))}},{key:"getLayer",value:function(t){return d(ys,this).get(t)}},{key:"currentPageIndex",get:function(){return d(Ss,this)}},{key:"addLayer",value:function(t){d(ys,this).set(t.pageIndex,t),d(js,this)?t.enable():t.disable()}},{key:"removeLayer",value:function(t){d(ys,this)["delete"](t.pageIndex)}},{key:"updateMode",value:(e=l(T().m((function a(t){var e,n,i,s,o,l,u,h,c,f,p,g,y=arguments;return T().w((function(a){for(;;)switch(a.n){case 0:if(n=y.length>1&&y[1]!==undefined?y[1]:null,i=y.length>2&&y[2]!==undefined&&y[2],s=y.length>3&&y[3]!==undefined&&y[3],o=y.length>4&&y[4]!==undefined&&y[4],d(Ys,this)!==t){a.n=1;break}return a.a(2);case 1:if(!d(so,this)){a.n=3;break}return a.n=2,d(so,this).promise;case 2:if(d(so,this)){a.n=3;break}return a.a(2);case 3:if(v(so,this,Promise.withResolvers()),null===(e=d(xs,this))||void 0===e||e.commitOrRemove(),v(Ys,this,t),t!==ir.NONE){a.n=4;break}return this.setEditingState(!1),r(oo,this,Mo).call(this),null===(l=this._editorUndoBar)||void 0===l||l.hide(),d(so,this).resolve(),a.a(2);case 4:if(t!==ir.SIGNATURE){a.n=5;break}return a.n=5,null===(u=d(Js,this))||void 0===u?void 0:u.loadSignatures();case 5:return this.setEditingState(!0),a.n=6,r(oo,this,So).call(this);case 6:this.unselectAll(),h=w(d(ys,this).values());try{for(h.s();!(c=h.n()).done;)c.value.updateMode(t)}catch(m){h.e(m)}finally{h.f()}if(n){a.n=7;break}return i&&this.addNewEditorFromKeyboard(),d(so,this).resolve(),a.a(2);case 7:f=w(d(gs,this).values());try{for(f.s();!(p=f.n()).done;)(g=p.value).annotationElementId===n||g.id===n?(this.setSelected(g),o?g.editComment():s&&g.enterInEditMode()):g.unselect()}catch(m){f.e(m)}finally{f.f()}d(so,this).resolve();case 8:return a.a(2)}}),a,this)}))),function(t){return e.apply(this,arguments)})},{key:"addNewEditorFromKeyboard",value:function(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}},{key:"updateToolbar",value:function(t){t.mode!==d(Ys,this)&&this._eventBus.dispatch("switchannotationeditormode",C({source:this},t))}},{key:"updateParams",value:function(t,e){if(d(Cs,this)){switch(t){case rr.CREATE:return void this.currentLayer.addNewEditor(e);case rr.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(d($s,this)||v($s,this,new Map)).set(t,e),this.showAllEditors("highlight",e)}if(this.hasSelection){var n,i=w(d(Ks,this));try{for(i.s();!(n=i.n()).done;){n.value.updateParams(t,e)}}catch(s){i.e(s)}finally{i.f()}}else{var r,a=w(d(Cs,this));try{for(a.s();!(r=a.n()).done;){r.value.updateDefaultParams(t,e)}}catch(s){a.e(s)}finally{a.f()}}}}},{key:"showAllEditors",value:function(t,e){var n,i,a,s=w(d(gs,this).values());try{for(s.s();!(a=s.n()).done;){var o=a.value;o.editorType===t&&o.show(e)}}catch(l){s.e(l)}finally{s.f()}(null===(n=null===(i=d($s,this))||void 0===i?void 0:i.get(rr.HIGHLIGHT_SHOW_ALL))||void 0===n||n)!==e&&r(oo,this,xo).call(this,[[rr.HIGHLIGHT_SHOW_ALL,e]])}},{key:"enableWaiting",value:function(){var t=arguments.length>0&&arguments[0]!==undefined&&arguments[0];if(d(Us,this)!==t){v(Us,this,t);var e,n=w(d(ys,this).values());try{for(n.s();!(e=n.n()).done;){var i=e.value;t?i.disableClick():i.enableClick(),i.div.classList.toggle("waiting",t)}}catch(r){n.e(r)}finally{n.f()}}}},{key:"getEditors",value:function(t){var e,n=[],i=w(d(gs,this).values());try{for(i.s();!(e=i.n()).done;){var r=e.value;r.pageIndex===t&&n.push(r)}}catch(a){i.e(a)}finally{i.f()}return n}},{key:"getEditor",value:function(t){return d(gs,this).get(t)}},{key:"addEditor",value:function(t){d(gs,this).set(t.id,t)}},{key:"removeEditor",value:function(t){var e,n,i=this;(t.div.contains(document.activeElement)&&(d(Ls,this)&&clearTimeout(d(Ls,this)),v(Ls,this,setTimeout((function(){i.focusMainContainer(),v(Ls,i,null)}),0))),d(gs,this)["delete"](t.id),t.annotationElementId)&&(null===(e=d(qs,this))||void 0===e||e["delete"](t.annotationElementId));(this.unselect(t),t.annotationElementId&&d(Es,this).has(t.annotationElementId))||(null===(n=d(ws,this))||void 0===n||n.remove(t.id))}},{key:"addDeletedAnnotationElement",value:function(t){d(Es,this).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}},{key:"isDeletedAnnotationElement",value:function(t){return d(Es,this).has(t)}},{key:"removeDeletedAnnotationElement",value:function(t){d(Es,this)["delete"](t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}},{key:"setActiveEditor",value:function(t){d(ps,this)!==t&&(v(ps,this,t),t&&r(oo,this,xo).call(this,t.propertiesToUpdate))}},{key:"updateUI",value:function(t){p(oo,this,To)===t&&r(oo,this,xo).call(this,t.propertiesToUpdate)}},{key:"updateUIForDefaultProperties",value:function(t){r(oo,this,xo).call(this,t.defaultPropertiesToUpdate)}},{key:"toggleSelected",value:function(t){if(d(Ks,this).has(t))return d(Ks,this)["delete"](t),t.unselect(),void r(oo,this,_o).call(this,{hasSelectedEditor:this.hasSelection});d(Ks,this).add(t),t.select(),r(oo,this,xo).call(this,t.propertiesToUpdate),r(oo,this,_o).call(this,{hasSelectedEditor:!0})}},{key:"setSelected",value:function(t){var e;this.updateToolbar({mode:t.mode,editId:t.id}),null===(e=d(xs,this))||void 0===e||e.commitOrRemove();var n,i=w(d(Ks,this));try{for(i.s();!(n=i.n()).done;){var a=n.value;a!==t&&a.unselect()}}catch(s){i.e(s)}finally{i.f()}d(Ks,this).clear(),d(Ks,this).add(t),t.select(),r(oo,this,xo).call(this,t.propertiesToUpdate),r(oo,this,_o).call(this,{hasSelectedEditor:!0})}},{key:"isSelected",value:function(t){return d(Ks,this).has(t)}},{key:"firstSelectedEditor",get:function(){return d(Ks,this).values().next().value}},{key:"unselect",value:function(t){t.unselect(),d(Ks,this)["delete"](t),r(oo,this,_o).call(this,{hasSelectedEditor:this.hasSelection})}},{key:"hasSelection",get:function(){return 0!==d(Ks,this).size}},{key:"isEnterHandled",get:function(){return 1===d(Ks,this).size&&this.firstSelectedEditor.isEnterHandled}},{key:"undo",value:function(){var t;d(ks,this).undo(),r(oo,this,_o).call(this,{hasSomethingToUndo:d(ks,this).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:r(oo,this,Ro).call(this)}),null===(t=this._editorUndoBar)||void 0===t||t.hide()}},{key:"redo",value:function(){d(ks,this).redo(),r(oo,this,_o).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:d(ks,this).hasSomethingToRedo(),isEmpty:r(oo,this,Ro).call(this)})}},{key:"addCommands",value:function(t){d(ks,this).add(t),r(oo,this,_o).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:r(oo,this,Ro).call(this)})}},{key:"cleanUndoStack",value:function(t){d(ks,this).cleanType(t)}},{key:"delete",value:function(){var t,e=this;this.commitOrRemove();var n=null===(t=this.currentLayer)||void 0===t?void 0:t.endDrawingSession(!0);if(this.hasSelection||n){var i=n?[n]:F(d(Ks,this)),a=function(){var t,n=w(i);try{for(n.s();!(t=n.n()).done;){var a=t.value;r(oo,e,Co).call(e,a)}}catch(s){n.e(s)}finally{n.f()}};this.addCommands({cmd:function(){var t;null===(t=e._editorUndoBar)||void 0===t||t.show(a,1===i.length?i[0].editorType:i.length);var n,r=w(i);try{for(r.s();!(n=r.n()).done;){n.value.remove()}}catch(s){r.e(s)}finally{r.f()}},undo:a,mustExec:!0})}}},{key:"commitOrRemove",value:function(){var t;null===(t=d(ps,this))||void 0===t||t.commitOrRemove()}},{key:"hasSomethingToControl",value:function(){return d(ps,this)||this.hasSelection}},{key:"selectAll",value:function(){var t,e=w(d(Ks,this));try{for(e.s();!(t=e.n()).done;){t.value.commit()}}catch(n){e.e(n)}finally{e.f()}r(oo,this,Po).call(this,d(gs,this).values())}},{key:"unselectAll",value:function(){var t;if((!d(ps,this)||(d(ps,this).commitOrRemove(),d(Ys,this)===ir.NONE))&&(null===(t=d(xs,this))||void 0===t||!t.commitOrRemove())&&this.hasSelection){var e,n=w(d(Ks,this));try{for(n.s();!(e=n.n()).done;){e.value.unselect()}}catch(i){n.e(i)}finally{n.f()}d(Ks,this).clear(),r(oo,this,_o).call(this,{hasSelectedEditor:!1})}}},{key:"translateSelectedEditors",value:function(t,e){var n=this;if(arguments.length>2&&arguments[2]!==undefined&&arguments[2]||this.commitOrRemove(),this.hasSelection){d(eo,this)[0]+=t,d(eo,this)[1]+=e;var i=D(d(eo,this),2),r=i[0],a=i[1],s=F(d(Ks,this));d(no,this)&&clearTimeout(d(no,this)),v(no,this,setTimeout((function(){v(no,n,null),d(eo,n)[0]=d(eo,n)[1]=0,n.addCommands({cmd:function(){var t,e=w(s);try{for(e.s();!(t=e.n()).done;){var i=t.value;d(gs,n).has(i.id)&&(i.translateInPage(r,a),i.translationDone())}}catch(o){e.e(o)}finally{e.f()}},undo:function(){var t,e=w(s);try{for(e.s();!(t=e.n()).done;){var i=t.value;d(gs,n).has(i.id)&&(i.translateInPage(-r,-a),i.translationDone())}}catch(o){e.e(o)}finally{e.f()}},mustExec:!1})}),1e3));var o,l=w(s);try{for(l.s();!(o=l.n()).done;){var u=o.value;u.translateInPage(t,e),u.translationDone()}}catch(h){l.e(h)}finally{l.f()}}}},{key:"setUpDragSession",value:function(){if(this.hasSelection){this.disableUserSelect(!0),v(Ms,this,new Map);var t,e=w(d(Ks,this));try{for(e.s();!(t=e.n()).done;){var n=t.value;d(Ms,this).set(n,{savedX:n.x,savedY:n.y,savedPageIndex:n.pageIndex,newX:0,newY:0,newPageIndex:-1})}}catch(i){e.e(i)}finally{e.f()}}}},{key:"endDragSession",value:function(){var t=this;if(!d(Ms,this))return!1;this.disableUserSelect(!1);var e=d(Ms,this);v(Ms,this,null);var n,i=!1,r=w(e);try{for(r.s();!(n=r.n()).done;){var a=D(n.value,2),s=a[0],o=s.x,l=s.y,u=s.pageIndex,h=a[1];h.newX=o,h.newY=l,h.newPageIndex=u,i||(i=o!==h.savedX||l!==h.savedY||u!==h.savedPageIndex)}}catch(f){r.e(f)}finally{r.f()}if(!i)return!1;var c=function(e,n,i,r){if(d(gs,t).has(e.id)){var a=d(ys,t).get(r);a?e._setParentAndPosition(a,n,i):(e.pageIndex=r,e.x=n,e.y=i)}};return this.addCommands({cmd:function(){var t,n=w(e);try{for(n.s();!(t=n.n()).done;){var i=D(t.value,2),r=i[0],a=i[1],s=a.newX,o=a.newY,l=a.newPageIndex;c(r,s,o,l)}}catch(f){n.e(f)}finally{n.f()}},undo:function(){var t,n=w(e);try{for(n.s();!(t=n.n()).done;){var i=D(t.value,2),r=i[0],a=i[1],s=a.savedX,o=a.savedY,l=a.savedPageIndex;c(r,s,o,l)}}catch(f){n.e(f)}finally{n.f()}},mustExec:!0}),!0}},{key:"dragSelectedEditors",value:function(t,e){if(d(Ms,this)){var n,i=w(d(Ms,this).keys());try{for(i.s();!(n=i.n()).done;){n.value.drag(t,e)}}catch(r){i.e(r)}finally{i.f()}}}},{key:"rebuild",value:function(t){if(null===t.parent){var e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}},{key:"isEditorHandlingKeyboard",get:function(){var t;return(null===(t=this.getActive())||void 0===t?void 0:t.shouldGetKeyboardEvents())||1===d(Ks,this).size&&this.firstSelectedEditor.shouldGetKeyboardEvents()}},{key:"isActive",value:function(t){return d(ps,this)===t}},{key:"getActive",value:function(){return d(ps,this)}},{key:"getMode",value:function(){return d(Ys,this)}},{key:"imageManager",get:function(){return Or(this,"imageManager",new ns)}},{key:"getSelectionBoxes",value:function(t){if(!t)return null;for(var e=document.getSelection(),n=0,i=e.rangeCount;n<i;n++)if(!t.contains(e.getRangeAt(n).commonAncestorContainer))return null;var r,a=t.getBoundingClientRect(),s=a.x,o=a.y,l=a.width,u=a.height;switch(t.getAttribute("data-main-rotation")){case"90":r=function(t,e,n,i){return{x:(e-o)/u,y:1-(t+n-s)/l,width:i/u,height:n/l}};break;case"180":r=function(t,e,n,i){return{x:1-(t+n-s)/l,y:1-(e+i-o)/u,width:n/l,height:i/u}};break;case"270":r=function(t,e,n,i){return{x:1-(e+i-o)/u,y:(t-s)/l,width:i/u,height:n/l}};break;default:r=function(t,e,n,i){return{x:(t-s)/l,y:(e-o)/u,width:n/l,height:i/u}}}for(var h=[],c=0,d=e.rangeCount;c<d;c++){var f=e.getRangeAt(c);if(!f.collapsed){var v,p=w(f.getClientRects());try{for(p.s();!(v=p.n()).done;){var g=v.value,y=g.x,m=g.y,b=g.width,k=g.height;0!==b&&0!==k&&h.push(r(y,m,b,k))}}catch(A){p.e(A)}finally{p.f()}}}return 0===h.length?null:h}},{key:"addChangedExistingAnnotation",value:function(t){var e=t.annotationElementId,n=t.id;(d(bs,this)||v(bs,this,new Map)).set(e,n)}},{key:"removeChangedExistingAnnotation",value:function(t){var e,n=t.annotationElementId;null===(e=d(bs,this))||void 0===e||e["delete"](n)}},{key:"renderAnnotationElement",value:function(t){var e,n=null===(e=d(bs,this))||void 0===e?void 0:e.get(t.data.id);if(n){var i=d(ws,this).getRawValue(n);i&&(d(Ys,this)!==ir.NONE||i.hasBeenModified)&&i.renderAnnotationElement(t)}}},{key:"setMissingCanvas",value:function(t,e,n){var i,r=null===(i=d(qs,this))||void 0===i?void 0:i.get(t);r&&(r.setCanvas(e,n),d(qs,this)["delete"](t))}},{key:"addMissingCanvas",value:function(t,e){(d(qs,this)||v(qs,this,new Map)).set(t,e)}}],[{key:"_keyboardManager",get:function(){var e=t.prototype,n=function(t){return d(io,t).contains(document.activeElement)&&"BUTTON"!==document.activeElement.tagName&&t.hasSomethingToControl()},i=function(t,e){var n=e.target;if(n instanceof HTMLInputElement){var i=n.type;return"text"!==i&&"number"!==i}return!0},r=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return Or(this,"_keyboardManager",new cs([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e["delete"],{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:function(t,e){var n=e.target;return!(n instanceof HTMLButtonElement)&&d(io,t).contains(n)&&!t.isEnterHandled}}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:function(t,e){return!(e.target instanceof HTMLButtonElement)&&d(io,t).contains(document.activeElement)}}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-a,0],checker:n}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[a,0],checker:n}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-a],checker:n}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,a],checker:n}]]))}}]);var e,n}();function uo(t){var e=t.anchorNode;return e.nodeType===Node.TEXT_NODE?e.parentElement:e}function ho(t){var e=this.currentLayer;if(e.hasTextLayer(t))return e;var n,i=w(d(ys,this).values());try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.hasTextLayer(t))return r}}catch(a){i.e(a)}finally{i.f()}return null}function co(){var t=document.getSelection();if(t&&!t.isCollapsed){var e=r(oo,this,uo).call(this,t).closest(".textLayer"),n=this.getSelectionBoxes(e);n&&(d(Ws,this)||v(Ws,this,new Va(this)),d(Ws,this).show(e,n,"ltr"===this.direction))}}function fo(){var t,e=this,n=document.getSelection();if(n&&!n.isCollapsed){var i=n.anchorNode;if(i!==d(Qs,this)){var a,s=r(oo,this,uo).call(this,n).closest(".textLayer");if(s){if(null===(t=d(Ws,this))||void 0===t||t.hide(),v(Qs,this,i),r(oo,this,_o).call(this,{hasSelectedText:!0}),(d(Ys,this)===ir.HIGHLIGHT||d(Ys,this)===ir.NONE)&&(d(Ys,this)===ir.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),v(Ns,this,this.isShiftKeyDown),!this.isShiftKeyDown)){var o=d(Ys,this)===ir.HIGHLIGHT?r(oo,this,ho).call(this,s):null;if(null==o||o.toggleDrawing(),d(Hs,this)){var l=new AbortController,u=this.combinedSignal(l),h=function(t){"pointerup"===t.type&&0!==t.button||(l.abort(),null==o||o.toggleDrawing(!0),"pointerup"===t.type&&r(oo,e,vo).call(e,"main_toolbar"))};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})}else null==o||o.toggleDrawing(!0),r(oo,this,vo).call(this,"main_toolbar")}}else d(Qs,this)&&(null===(a=d(Ws,this))||void 0===a||a.hide(),v(Qs,this,null),r(oo,this,_o).call(this,{hasSelectedText:!1}))}}else{var c;d(Qs,this)&&(null===(c=d(Ws,this))||void 0===c||c.hide(),v(Qs,this,null),r(oo,this,_o).call(this,{hasSelectedText:!1}))}}function vo(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";d(Ys,this)===ir.HIGHLIGHT?this.highlightSelection(t):d(Rs,this)&&r(oo,this,co).call(this)}function po(){document.addEventListener("selectionchange",r(oo,this,fo).bind(this),{signal:this._signal})}function go(){if(!d(Os,this)){v(Os,this,new AbortController);var t=this.combinedSignal(d(Os,this));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}}function yo(){var t;null===(t=d(Os,this))||void 0===t||t.abort(),v(Os,this,null)}function mo(){if(!d(zs,this)){v(zs,this,new AbortController);var t=this.combinedSignal(d(zs,this));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}}function wo(){var t;null===(t=d(zs,this))||void 0===t||t.abort(),v(zs,this,null)}function bo(){if(!d(_s,this)){v(_s,this,new AbortController);var t=this.combinedSignal(d(_s,this));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}}function ko(){var t;null===(t=d(_s,this))||void 0===t||t.abort(),v(_s,this,null)}function Ao(){var t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}function _o(t){var e=this;Object.entries(t).some((function(t){var n=D(t,2),i=n[0],r=n[1];return d(to,e)[i]!==r}))&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(d(to,this),t)}),d(Ys,this)===ir.HIGHLIGHT&&!1===t.hasSelectedEditor&&r(oo,this,xo).call(this,[[rr.HIGHLIGHT_FREE,!0]]))}function xo(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}function So(){return Eo.apply(this,arguments)}function Eo(){return(Eo=l(T().m((function t(){var e,n,i,r,a,s;return T().w((function(t){for(;;)switch(t.n){case 0:if(d(js,this)){t.n=2;break}v(js,this,!0),e=[],n=w(d(ys,this).values());try{for(n.s();!(i=n.n()).done;)r=i.value,e.push(r.enable())}catch(o){n.e(o)}finally{n.f()}return t.n=1,Promise.all(e);case 1:a=w(d(gs,this).values());try{for(a.s();!(s=a.n()).done;)s.value.enable()}catch(o){a.e(o)}finally{a.f()}case 2:return t.a(2)}}),t,this)})))).apply(this,arguments)}function Mo(){if(this.unselectAll(),d(js,this)){v(js,this,!1);var t,e=w(d(ys,this).values());try{for(e.s();!(t=e.n()).done;){t.value.disable()}}catch(r){e.e(r)}finally{e.f()}var n,i=w(d(gs,this).values());try{for(i.s();!(n=i.n()).done;){n.value.disable()}}catch(r){i.e(r)}finally{i.f()}}}function Co(t){var e=d(ys,this).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}function To(t){var e,n=null,i=w(d(Ks,t));try{for(i.s();!(e=i.n()).done;)n=e.value}catch(r){i.e(r)}finally{i.f()}return n}function Ro(){if(0===d(gs,this).size)return!0;if(1===d(gs,this).size){var t,e=w(d(gs,this).values());try{for(e.s();!(t=e.n()).done;){return t.value.isEmpty()}}catch(n){e.e(n)}finally{e.f()}}return!1}function Po(t){var e,n=w(d(Ks,this));try{for(n.s();!(e=n.n()).done;){e.value.unselect()}}catch(o){n.e(o)}finally{n.f()}d(Ks,this).clear();var i,a=w(t);try{for(a.s();!(i=a.n()).done;){var s=i.value;s.isEmpty()||(d(Ks,this).add(s),s.select())}}catch(o){a.e(o)}finally{a.f()}r(oo,this,_o).call(this,{hasSelectedEditor:this.hasSelection})}b(lo,"TRANSLATE_SMALL",1),b(lo,"TRANSLATE_BIG",10);var Io=new WeakMap,Do=new WeakMap,Lo=new WeakMap,Oo=new WeakMap,Fo=new WeakMap,No=new WeakMap,Wo=new WeakMap,Bo=new WeakMap,jo=new WeakMap,Ho=new WeakMap,Uo=new WeakMap,zo=new WeakMap,Go=new WeakSet,Vo=function(){function t(e){c(this,t),g(this,Go),f(this,Io,null),f(this,Do,!1),f(this,Lo,null),f(this,Oo,null),f(this,Fo,null),f(this,No,null),f(this,Wo,!1),f(this,Bo,null),f(this,jo,null),f(this,Ho,null),f(this,Uo,null),f(this,zo,!1),v(jo,this,e),v(zo,this,e._uiManager.useNewAltTextFlow),Ko._||(Ko._=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}return m(t,[{key:"render",value:(n=l(T().m((function i(){var t,e,n,a,s=this;return T().w((function(i){for(;;)switch(i.n){case 0:return(t=v(Lo,this,document.createElement("button"))).className="altText",t.tabIndex="0",e=v(Oo,this,document.createElement("span")),t.append(e),d(zo,this)?(t.classList.add("new"),t.setAttribute("data-l10n-id",Ko._.missing),e.setAttribute("data-l10n-id",Ko._["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label")),n=d(jo,this)._uiManager._signal,t.addEventListener("contextmenu",pa,{signal:n}),t.addEventListener("pointerdown",(function(t){return t.stopPropagation()}),{signal:n}),a=function(t){t.preventDefault(),d(jo,s)._uiManager.editAltText(d(jo,s)),d(zo,s)&&d(jo,s)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:p(Go,s,qo)}})},t.addEventListener("click",a,{capture:!0,signal:n}),t.addEventListener("keydown",(function(e){e.target===t&&"Enter"===e.key&&(v(Wo,s,!0),a(e))}),{signal:n}),i.n=1,r(Go,this,Xo).call(this);case 1:return i.a(2,t)}}),i,this)}))),function(){return n.apply(this,arguments)})},{key:"finish",value:function(){d(Lo,this)&&(d(Lo,this).focus({focusVisible:d(Wo,this)}),v(Wo,this,!1))}},{key:"isEmpty",value:function(){return d(zo,this)?null===d(Io,this):!d(Io,this)&&!d(Do,this)}},{key:"hasData",value:function(){return d(zo,this)?null!==d(Io,this)||!!d(Ho,this):this.isEmpty()}},{key:"guessedText",get:function(){return d(Ho,this)}},{key:"setGuessedText",value:(e=l(T().m((function a(e){var n,i,s,o;return T().w((function(a){for(;;)switch(a.n){case 0:if(null===d(Io,this)){a.n=1;break}return a.a(2);case 1:return v(Ho,this,e),n=v,i=Uo,s=this,a.n=2,t._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e});case 2:o=a.v,n(i,s,o),r(Go,this,Xo).call(this);case 3:return a.a(2)}}),a,this)}))),function(t){return e.apply(this,arguments)})},{key:"toggleAltTextBadge",value:function(){var t,e=arguments.length>0&&arguments[0]!==undefined&&arguments[0];if(!d(zo,this)||d(Io,this))return null===(t=d(Bo,this))||void 0===t||t.remove(),void v(Bo,this,null);if(!d(Bo,this)){var n=v(Bo,this,document.createElement("div"));n.className="noAltTextBadge",d(jo,this).div.append(n)}d(Bo,this).classList.toggle("hidden",!e)}},{key:"serialize",value:function(t){var e=d(Io,this);return t||d(Ho,this)!==e||(e=d(Uo,this)),{altText:e,decorative:d(Do,this),guessedText:d(Ho,this),textWithDisclaimer:d(Uo,this)}}},{key:"data",get:function(){return{altText:d(Io,this),decorative:d(Do,this)}},set:function(t){var e=t.altText,n=t.decorative,i=t.guessedText,a=t.textWithDisclaimer,s=t.cancel,o=void 0!==s&&s;i&&(v(Ho,this,i),v(Uo,this,a)),d(Io,this)===e&&d(Do,this)===n||(o||(v(Io,this,e),v(Do,this,n)),r(Go,this,Xo).call(this))}},{key:"toggle",value:function(){var t=arguments.length>0&&arguments[0]!==undefined&&arguments[0];d(Lo,this)&&(!t&&d(No,this)&&(clearTimeout(d(No,this)),v(No,this,null)),d(Lo,this).disabled=!t)}},{key:"shown",value:function(){d(jo,this)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:p(Go,this,qo)}})}},{key:"destroy",value:function(){var t,e;null===(t=d(Lo,this))||void 0===t||t.remove(),v(Lo,this,null),v(Oo,this,null),v(Fo,this,null),null===(e=d(Bo,this))||void 0===e||e.remove(),v(Bo,this,null)}}],[{key:"initialize",value:function(e){var n;null!==(n=t._l10n)&&void 0!==n||(t._l10n=e)}}]);var e,n}();function qo(t){return(d(Io,t)?"added":null===d(Io,t)&&t.guessedText&&"review")||"missing"}function Xo(){return Yo.apply(this,arguments)}function Yo(){return(Yo=l(T().m((function t(){var e,n,i,r,a,s,o,l=this;return T().w((function(t){for(;;)switch(t.n){case 0:if(e=d(Lo,this)){t.n=1;break}return t.a(2);case 1:if(!d(zo,this)){t.n=3;break}if(e.classList.toggle("done",!!d(Io,this)),e.setAttribute("data-l10n-id",Ko._[p(Go,this,qo)]),null===(n=d(Oo,this))||void 0===n||n.setAttribute("data-l10n-id",Ko._["".concat(p(Go,this,qo),"-label")]),d(Io,this)){t.n=2;break}return null===(i=d(Fo,this))||void 0===i||i.remove(),t.a(2);case 2:t.n=5;break;case 3:if(d(Io,this)||d(Do,this)){t.n=4;break}return e.classList.remove("done"),null===(r=d(Fo,this))||void 0===r||r.remove(),t.a(2);case 4:e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button");case 5:(a=d(Fo,this))||(v(Fo,this,a=document.createElement("span")),a.className="tooltip",a.setAttribute("role","tooltip"),a.id="alt-text-tooltip-".concat(d(jo,this).id),(s=d(jo,this)._uiManager._signal).addEventListener("abort",(function(){clearTimeout(d(No,l)),v(No,l,null)}),{once:!0}),e.addEventListener("mouseenter",(function(){v(No,l,setTimeout((function(){v(No,l,null),d(Fo,l).classList.add("show"),d(jo,l)._reportTelemetry({action:"alt_text_tooltip"})}),100))}),{signal:s}),e.addEventListener("mouseleave",(function(){var t;d(No,l)&&(clearTimeout(d(No,l)),v(No,l,null)),null===(t=d(Fo,l))||void 0===t||t.classList.remove("show")}),{signal:s})),d(Do,this)?a.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(a.removeAttribute("data-l10n-id"),a.textContent=d(Io,this)),a.parentNode||e.append(a),null==(o=d(jo,this).getElementForAltText())||o.setAttribute("aria-describedby",a.id);case 6:return t.a(2)}}),t,this)})))).apply(this,arguments)}var Ko={_:null};b(Vo,"_l10n",null);var Qo=new WeakMap,Jo=new WeakMap,Zo=new WeakMap,$o=new WeakMap,tl=new WeakMap,el=new WeakMap,nl=new WeakMap,il=function(){return m((function t(e){c(this,t),f(this,Qo,null),f(this,Jo,!1),f(this,Zo,null),f(this,$o,null),f(this,tl,null),f(this,el,null),f(this,nl,!1),v(Zo,this,e),this.toolbar=null}),[{key:"render",value:function(){var t=this;if(!d(Zo,this)._uiManager.hasCommentManager())return null;var e=v(Qo,this,document.createElement("button"));e.className="comment",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button");var n=d(Zo,this)._uiManager._signal;e.addEventListener("contextmenu",pa,{signal:n}),e.addEventListener("pointerdown",(function(t){return t.stopPropagation()}),{signal:n});var i=function(e){e.preventDefault(),t.edit()};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",(function(n){n.target===e&&"Enter"===n.key&&(v(Jo,t,!0),i(n))}),{signal:n}),e}},{key:"edit",value:function(){var t=d(Zo,this).getClientDimensions(),e=t.bottom,n=t.left,i=t.right,r={top:e};"ltr"===d(Zo,this)._uiManager.direction?r.right=i:r.left=n,d(Zo,this)._uiManager.editComment(d(Zo,this),r)}},{key:"finish",value:function(){d(Qo,this)&&(d(Qo,this).focus({focusVisible:d(Jo,this)}),v(Jo,this,!1))}},{key:"isDeleted",value:function(){return d(nl,this)||""===d(tl,this)}},{key:"hasBeenEdited",value:function(){return this.isDeleted()||d(tl,this)!==d($o,this)}},{key:"serialize",value:function(){return this.data}},{key:"data",get:function(){return{text:d(tl,this),date:d(el,this),deleted:d(nl,this)}},set:function(t){if(null===t)return v(tl,this,""),void v(nl,this,!0);v(tl,this,t),v(el,this,new Date),v(nl,this,!1)}},{key:"setInitialText",value:function(t){v($o,this,t),this.data=t}},{key:"toggle",value:function(){var t=arguments.length>0&&arguments[0]!==undefined&&arguments[0];d(Qo,this)&&(d(Qo,this).disabled=!t)}},{key:"shown",value:function(){}},{key:"destroy",value:function(){var t;null===(t=d(Qo,this))||void 0===t||t.remove(),v(Qo,this,null),v(tl,this,""),v(el,this,null),v(Zo,this,null),v(Jo,this,!1),v(nl,this,!1)}}])}(),rl=new WeakMap,al=new WeakMap,sl=new WeakMap,ol=new WeakMap,ll=new WeakMap,ul=new WeakMap,hl=new WeakMap,cl=new WeakMap,dl=new WeakMap,fl=new WeakMap,vl=new WeakMap,pl=new WeakMap,gl=new WeakSet,yl=function(){return m((function t(e){var n=e.container,i=e.isPinchingDisabled,a=void 0===i?null:i,s=e.isPinchingStopped,o=void 0===s?null:s,l=e.onPinchStart,u=void 0===l?null:l,h=e.onPinching,p=void 0===h?null:h,y=e.onPinchEnd,m=void 0===y?null:y,w=e.signal;c(this,t),g(this,gl),f(this,rl,void 0),f(this,al,!1),f(this,sl,null),f(this,ol,void 0),f(this,ll,void 0),f(this,ul,void 0),f(this,hl,void 0),f(this,cl,null),f(this,dl,void 0),f(this,fl,null),f(this,vl,void 0),f(this,pl,null),v(rl,this,n),v(sl,this,o),v(ol,this,a),v(ll,this,u),v(ul,this,p),v(hl,this,m),v(vl,this,new AbortController),v(dl,this,AbortSignal.any([w,d(vl,this).signal])),n.addEventListener("touchstart",r(gl,this,ml).bind(this),{passive:!1,signal:d(dl,this)})}),[{key:"MIN_TOUCH_DISTANCE_TO_PINCH",get:function(){return 35/xa.pixelRatio}},{key:"destroy",value:function(){var t,e;null===(t=d(vl,this))||void 0===t||t.abort(),v(vl,this,null),null===(e=d(cl,this))||void 0===e||e.abort(),v(cl,this,null)}}])}();function ml(t){var e,n,i=this;if(null===(e=d(ol,this))||void 0===e||!e.call(this)){if(1===t.touches.length){if(d(cl,this))return;var a=v(cl,this,new AbortController),s=AbortSignal.any([d(dl,this),a.signal]),o=d(rl,this),l={capture:!0,signal:s,passive:!1},u=function(t){var e;"touch"===t.pointerType&&(null===(e=d(cl,i))||void 0===e||e.abort(),v(cl,i,null))};return o.addEventListener("pointerdown",(function(t){"touch"===t.pointerType&&(ga(t),u(t))}),l),o.addEventListener("pointerup",u,l),void o.addEventListener("pointercancel",u,l)}if(!d(pl,this)){var h;v(pl,this,new AbortController);var c=AbortSignal.any([d(dl,this),d(pl,this).signal]),f=d(rl,this),p={signal:c,capture:!1,passive:!1};f.addEventListener("touchmove",r(gl,this,wl).bind(this),p);var g=r(gl,this,bl).bind(this);f.addEventListener("touchend",g,p),f.addEventListener("touchcancel",g,p),p.capture=!0,f.addEventListener("pointerdown",ga,p),f.addEventListener("pointermove",ga,p),f.addEventListener("pointercancel",ga,p),f.addEventListener("pointerup",ga,p),null===(h=d(ll,this))||void 0===h||h.call(this)}if(ga(t),2!==t.touches.length||null!==(n=d(sl,this))&&void 0!==n&&n.call(this))v(fl,this,null);else{var y=D(t.touches,2),m=y[0],w=y[1];if(m.identifier>w.identifier){var b=[w,m];m=b[0],w=b[1]}v(fl,this,{touch0X:m.screenX,touch0Y:m.screenY,touch1X:w.screenX,touch1Y:w.screenY})}}}function wl(t){var e;if(d(fl,this)&&2===t.touches.length){ga(t);var n=D(t.touches,2),i=n[0],r=n[1];if(i.identifier>r.identifier){var a=[r,i];i=a[0],r=a[1]}var s=i,o=s.screenX,l=s.screenY,u=r,h=u.screenX,c=u.screenY,f=d(fl,this),p=f.touch0X,g=f.touch0Y,y=f.touch1X-p,m=f.touch1Y-g,w=h-o,b=c-l,k=Math.hypot(w,b)||1,A=Math.hypot(y,m)||1;if(d(al,this)||!(Math.abs(A-k)<=xi.MIN_TOUCH_DISTANCE_TO_PINCH))if(f.touch0X=o,f.touch0Y=l,f.touch1X=h,f.touch1Y=c,d(al,this)){var _=[(o+h)/2,(l+c)/2];null===(e=d(ul,this))||void 0===e||e.call(this,_,A,k)}else v(al,this,!0)}}function bl(t){if(!(t.touches.length>=2)){var e;if(d(pl,this))d(pl,this).abort(),v(pl,this,null),null===(e=d(hl,this))||void 0===e||e.call(this);d(fl,this)&&(ga(t),v(fl,this,null),v(al,this,!1))}}xi=yl;var kl=new WeakMap,Al=new WeakMap,_l=new WeakMap,xl=new WeakMap,Sl=new WeakMap,El=new WeakMap,Ml=new WeakMap,Cl=new WeakMap,Tl=new WeakMap,Rl=new WeakMap,Pl=new WeakMap,Il=new WeakMap,Dl=new WeakMap,Ll=new WeakMap,Ol=new WeakMap,Fl=new WeakMap,Nl=new WeakMap,Wl=new WeakMap,Bl=new WeakMap,jl=new WeakMap,Hl=new WeakMap,Ul=new WeakMap,zl=new WeakMap,Gl=new WeakMap,Vl=new WeakMap,ql=new WeakSet,Xl=function(){function t(e){c(this,t),g(this,ql),f(this,kl,null),f(this,Al,null),f(this,_l,null),f(this,xl,null),f(this,Sl,!1),f(this,El,null),f(this,Ml,""),f(this,Cl,!1),f(this,Tl,null),f(this,Rl,null),f(this,Pl,null),f(this,Il,null),f(this,Dl,""),f(this,Ll,!1),f(this,Ol,null),f(this,Fl,!1),f(this,Nl,!1),f(this,Wl,!1),f(this,Bl,null),f(this,jl,0),f(this,Hl,0),f(this,Ul,null),f(this,zl,null),b(this,"isSelected",!1),b(this,"_isCopy",!1),b(this,"_editToolbar",null),b(this,"_initialOptions",Object.create(null)),b(this,"_initialData",null),b(this,"_isVisible",!0),b(this,"_uiManager",null),b(this,"_focusEventsAllowed",!0),f(this,Gl,!1),f(this,Vl,t._zIndex++),this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null;var n=this.parent.viewport,i=n.rotation,r=n.rawDims,a=r.pageWidth,s=r.pageHeight,o=r.pageX,l=r.pageY;this.rotation=i,this.pageRotation=(360+i-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[a,s],this.pageTranslation=[o,l];var u=D(this.parentDimensions,2),h=u[0],d=u[1];this.x=e.x/h,this.y=e.y/d,this.isAttachedToDOM=!1,this.deleted=!1}return m(t,[{key:"editorType",get:function(){return Object.getPrototypeOf(this).constructor._type}},{key:"mode",get:function(){return Object.getPrototypeOf(this).constructor._editorType}},{key:"propertiesToUpdate",get:function(){return[]}},{key:"_isDraggable",get:function(){return d(Gl,this)},set:function(t){var e;v(Gl,this,t),null===(e=this.div)||void 0===e||e.classList.toggle("draggable",t)}},{key:"isEnterHandled",get:function(){return!0}},{key:"center",value:function(){var t=D(this.pageDimensions,2),e=t[0],n=t[1];switch(this.parentRotation){case 90:this.x-=this.height*n/(2*e),this.y+=this.width*e/(2*n);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*n/(2*e),this.y-=this.width*e/(2*n);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}},{key:"addCommands",value:function(t){this._uiManager.addCommands(t)}},{key:"currentLayer",get:function(){return this._uiManager.currentLayer}},{key:"setInBackground",value:function(){this.div.style.zIndex=0}},{key:"setInForeground",value:function(){this.div.style.zIndex=d(Vl,this)}},{key:"setParent",value:function(t){null!==t?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):r(ql,this,du).call(this),this.parent=t}},{key:"focusin",value:function(t){this._focusEventsAllowed&&(d(Ll,this)?v(Ll,this,!1):this.parent.setSelected(this))}},{key:"focusout",value:function(t){var e;if(this._focusEventsAllowed&&this.isAttachedToDOM){var n=t.relatedTarget;null!=n&&n.closest("#".concat(this.id))||(t.preventDefault(),null!==(e=this.parent)&&void 0!==e&&e.isMultipleSelection||this.commitOrRemove())}}},{key:"commitOrRemove",value:function(){this.isEmpty()?this.remove():this.commit()}},{key:"commit",value:function(){this.isInEditMode()&&this.addToAnnotationStorage()}},{key:"addToAnnotationStorage",value:function(){this._uiManager.addToAnnotationStorage(this)}},{key:"setAt",value:function(t,e,n,i){var r=D(this.parentDimensions,2),a=r[0],s=r[1],o=D(this.screenToPageTranslation(n,i),2);n=o[0],i=o[1],this.x=(t+n)/a,this.y=(e+i)/s,this.fixAndSetPosition()}},{key:"_moveAfterPaste",value:function(t,e){var n=D(this.parentDimensions,2),i=n[0],r=n[1];this.setAt(t*i,e*r,this.width*i,this.height*r),this._onTranslated()}},{key:"translate",value:function(t,e){r(ql,this,Yl).call(this,this.parentDimensions,t,e)}},{key:"translateInPage",value:function(t,e){d(Ol,this)||v(Ol,this,[this.x,this.y,this.width,this.height]),r(ql,this,Yl).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}},{key:"translationDone",value:function(){this._onTranslated(this.x,this.y)}},{key:"drag",value:function(t,e){d(Ol,this)||v(Ol,this,[this.x,this.y,this.width,this.height]);var n=this.div,i=D(this.parentDimensions,2),r=i[0],a=i[1];if(this.x+=t/r,this.y+=e/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){var s=this.div.getBoundingClientRect(),o=s.x,l=s.y;this.parent.findNewParent(this,o,l)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}var u=this.x,h=this.y,c=D(this.getBaseTranslation(),2);u+=c[0],h+=c[1];var f=n.style;f.left="".concat((100*u).toFixed(2),"%"),f.top="".concat((100*h).toFixed(2),"%"),this._onTranslating(u,h),n.scrollIntoView({block:"nearest"})}},{key:"_onTranslating",value:function(t,e){}},{key:"_onTranslated",value:function(t,e){}},{key:"_hasBeenMoved",get:function(){return!!d(Ol,this)&&(d(Ol,this)[0]!==this.x||d(Ol,this)[1]!==this.y)}},{key:"_hasBeenResized",get:function(){return!!d(Ol,this)&&(d(Ol,this)[2]!==this.width||d(Ol,this)[3]!==this.height)}},{key:"getBaseTranslation",value:function(){var e=D(this.parentDimensions,2),n=e[0],i=e[1],r=t._borderLineWidth,a=r/n,s=r/i;switch(this.rotation){case 90:return[-a,s];case 180:return[a,s];case 270:return[a,-s];default:return[-a,-s]}}},{key:"_mustFixPosition",get:function(){return!0}},{key:"fixAndSetPosition",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.rotation,e=this.div.style,n=D(this.pageDimensions,2),i=n[0],r=n[1],a=this.x,s=this.y,o=this.width,l=this.height;if(o*=i,l*=r,a*=i,s*=r,this._mustFixPosition)switch(t){case 0:a=ea(a,0,i-o),s=ea(s,0,r-l);break;case 90:a=ea(a,0,i-l),s=ea(s,o,r);break;case 180:a=ea(a,o,i),s=ea(s,l,r);break;case 270:a=ea(a,l,i),s=ea(s,0,r-o)}this.x=a/=i,this.y=s/=r;var u=D(this.getBaseTranslation(),2);a+=u[0],s+=u[1],e.left="".concat((100*a).toFixed(2),"%"),e.top="".concat((100*s).toFixed(2),"%"),this.moveInDOM()}},{key:"screenToPageTranslation",value:function(e,n){return Kl.call(t,e,n,this.parentRotation)}},{key:"pageTranslationToScreen",value:function(e,n){return Kl.call(t,e,n,360-this.parentRotation)}},{key:"parentScale",get:function(){return this._uiManager.viewParameters.realScale}},{key:"parentRotation",get:function(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}},{key:"parentDimensions",get:function(){var t=this.parentScale,e=D(this.pageDimensions,2);return[e[0]*t,e[1]*t]}},{key:"setDims",value:function(t,e){var n=D(this.parentDimensions,2),i=n[0],r=n[1],a=this.div.style;a.width="".concat((100*t/i).toFixed(2),"%"),d(Cl,this)||(a.height="".concat((100*e/r).toFixed(2),"%"))}},{key:"fixDims",value:function(){var t=this.div.style,e=t.height,n=t.width,i=n.endsWith("%"),r=!d(Cl,this)&&e.endsWith("%");if(!i||!r){var a=D(this.parentDimensions,2),s=a[0],o=a[1];i||(t.width="".concat((100*parseFloat(n)/s).toFixed(2),"%")),d(Cl,this)||r||(t.height="".concat((100*parseFloat(e)/o).toFixed(2),"%"))}}},{key:"getInitialTranslation",value:function(){return[0,0]}},{key:"_onResized",value:function(){}},{key:"_onResizing",value:function(){}},{key:"altTextFinish",value:function(){var t;null===(t=d(_l,this))||void 0===t||t.finish()}},{key:"toolbarButtons",get:function(){return null}},{key:"addEditToolbar",value:(a=l(T().m((function s(){var t,e,n,i,r,a,o;return T().w((function(s){for(;;)switch(s.p=s.n){case 0:if(!this._editToolbar&&!d(Nl,this)){s.n=1;break}return s.a(2,this._editToolbar);case 1:if(this._editToolbar=new La(this),this.div.append(this._editToolbar.render()),this._editToolbar.addButton("comment",this.addCommentButton()),!(t=this.toolbarButtons)){s.n=8;break}e=w(t),s.p=2,e.s();case 3:if((n=e.n()).done){s.n=5;break}return i=D(n.value,2),r=i[0],a=i[1],s.n=4,this._editToolbar.addButton(r,a);case 4:s.n=3;break;case 5:s.n=7;break;case 6:s.p=6,o=s.v,e.e(o);case 7:return s.p=7,e.f(),s.f(7);case 8:return this._editToolbar.addButton("delete"),s.a(2,this._editToolbar)}}),s,this,[[2,6,7,8]])}))),function(){return a.apply(this,arguments)})},{key:"removeEditToolbar",value:function(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,null===(t=d(_l,this))||void 0===t||t.destroy())}},{key:"addContainer",value:function(t){var e,n=null===(e=this._editToolbar)||void 0===e?void 0:e.div;n?n.before(t):this.div.append(t)}},{key:"getClientDimensions",value:function(){return this.div.getBoundingClientRect()}},{key:"createAltText",value:function(){return d(_l,this)||(Vo.initialize(t._l10n),v(_l,this,new Vo(this)),d(kl,this)&&(d(_l,this).data=d(kl,this),v(kl,this,null))),d(_l,this)}},{key:"altTextData",get:function(){var t;return null===(t=d(_l,this))||void 0===t?void 0:t.data},set:function(t){d(_l,this)&&(d(_l,this).data=t)}},{key:"guessedAltText",get:function(){var t;return null===(t=d(_l,this))||void 0===t?void 0:t.guessedText}},{key:"setGuessedAltText",value:(i=l(T().m((function o(t){var e;return T().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,null===(e=d(_l,this))||void 0===e?void 0:e.setGuessedText(t);case 1:return n.a(2)}}),o,this)}))),function(t){return i.apply(this,arguments)})},{key:"serializeAltText",value:function(t){var e;return null===(e=d(_l,this))||void 0===e?void 0:e.serialize(t)}},{key:"hasAltText",value:function(){return!!d(_l,this)&&!d(_l,this).isEmpty()}},{key:"hasAltTextData",value:function(){var t,e;return null!==(t=null===(e=d(_l,this))||void 0===e?void 0:e.hasData())&&void 0!==t&&t}},{key:"addCommentButton",value:function(){return d(xl,this)?d(xl,this):v(xl,this,new il(this))}},{key:"commentColor",get:function(){return null}},{key:"comment",get:function(){var t=d(xl,this);return{text:t.data.text,date:t.data.date,deleted:t.isDeleted(),color:this.commentColor}},set:function(t){d(xl,this)||v(xl,this,new il(this)),d(xl,this).data=t}},{key:"setCommentData",value:function(t){d(xl,this)||v(xl,this,new il(this)),d(xl,this).setInitialText(t)}},{key:"hasEditedComment",get:function(){var t;return null===(t=d(xl,this))||void 0===t?void 0:t.hasBeenEdited()}},{key:"editComment",value:(n=l(T().m((function u(){return T().w((function(t){for(;;)switch(t.n){case 0:d(xl,this)||v(xl,this,new il(this)),d(xl,this).edit();case 1:return t.a(2)}}),u,this)}))),function(){return n.apply(this,arguments)})},{key:"addComment",value:function(t){this.hasEditedComment&&(t.popup={contents:this.comment.text,deleted:this.comment.deleted})}},{key:"render",value:function(){var t,e=this,n=this.div=document.createElement("div");n.setAttribute("data-editor-rotation",(360-this.rotation)%360),n.className=this.name,n.setAttribute("id",this.id),n.tabIndex=d(Sl,this)?-1:0,n.setAttribute("role","application"),this.defaultL10nId&&n.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||n.classList.add("hidden"),this.setInForeground(),r(ql,this,ou).call(this);var i=D(this.parentDimensions,2),a=i[0],s=i[1];this.parentRotation%180!=0&&(n.style.maxWidth="".concat((100*s/a).toFixed(2),"%"),n.style.maxHeight="".concat((100*a/s).toFixed(2),"%"));var o=D(this.getInitialTranslation(),2),l=o[0],u=o[1];return this.translate(l,u),Ka(this,n,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(d(zl,this)||v(zl,this,new yl({container:n,isPinchingDisabled:function(){return!e.isSelected},onPinchStart:r(ql,this,nu).bind(this),onPinching:r(ql,this,iu).bind(this),onPinchEnd:r(ql,this,ru).bind(this),signal:this._uiManager._signal}))),null===(t=this._uiManager._editorUndoBar)||void 0===t||t.hide(),n}},{key:"pointerdown",value:function(t){var e=Vr.platform.isMac;0!==t.button||t.ctrlKey&&e?t.preventDefault():(v(Ll,this,!0),this._isDraggable?r(ql,this,su).call(this,t):r(ql,this,au).call(this,t))}},{key:"_onStartDragging",value:function(){}},{key:"_onStopDragging",value:function(){}},{key:"moveInDOM",value:function(){var t=this;d(Bl,this)&&clearTimeout(d(Bl,this)),v(Bl,this,setTimeout((function(){var e;v(Bl,t,null),null===(e=t.parent)||void 0===e||e.moveEditorInDOM(t)}),0))}},{key:"_setParentAndPosition",value:function(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition(),this._onTranslated()}},{key:"getRect",value:function(t,e){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this.rotation,i=this.parentScale,r=D(this.pageDimensions,2),a=r[0],s=r[1],o=D(this.pageTranslation,2),l=o[0],u=o[1],h=t/i,c=e/i,d=this.x*a,f=this.y*s,v=this.width*a,p=this.height*s;switch(n){case 0:return[d+h+l,s-f-c-p+u,d+h+v+l,s-f-c+u];case 90:return[d+c+l,s-f+h+u,d+c+p+l,s-f+h+v+u];case 180:return[d-h-v+l,s-f+c+u,d-h+l,s-f+c+p+u];case 270:return[d-c-p+l,s-f-h-v+u,d-c+l,s-f-h+u];default:throw new Error("Invalid rotation")}}},{key:"getRectInCurrentCoords",value:function(t,e){var n=D(t,4),i=n[0],r=n[1],a=n[2],s=n[3],o=a-i,l=s-r;switch(this.rotation){case 0:return[i,e-s,o,l];case 90:return[i,e-r,l,o];case 180:return[a,e-r,o,l];case 270:return[a,e-s,l,o];default:throw new Error("Invalid rotation")}}},{key:"onceAdded",value:function(t){}},{key:"isEmpty",value:function(){return!1}},{key:"enableEditMode",value:function(){return!this.isInEditMode()&&(this.parent.setEditingState(!1),v(Nl,this,!0),!0)}},{key:"disableEditMode",value:function(){return!!this.isInEditMode()&&(this.parent.setEditingState(!0),v(Nl,this,!1),!0)}},{key:"isInEditMode",value:function(){return d(Nl,this)}},{key:"shouldGetKeyboardEvents",value:function(){return d(Wl,this)}},{key:"needsToBeRebuilt",value:function(){return this.div&&!this.isAttachedToDOM}},{key:"isOnScreen",get:function(){var t=this.getClientDimensions(),e=t.top,n=t.left,i=t.bottom,r=t.right,a=window,s=a.innerHeight;return n<a.innerWidth&&r>0&&e<s&&i>0}},{key:"rebuild",value:function(){r(ql,this,ou).call(this)}},{key:"rotate",value:function(t){}},{key:"resize",value:function(){}},{key:"serializeDeleted",value:function(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:(null===(t=this._initialData)||void 0===t?void 0:t.popupRef)||""}}},{key:"serialize",value:function(){Pr("An editor must be serializable")}},{key:"hasBeenModified",get:function(){return!!this.annotationElementId&&(this.deleted||null!==this.serialize())}},{key:"remove",value:function(){var t,e;if(null===(t=d(Il,this))||void 0===t||t.abort(),v(Il,this,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),d(Bl,this)&&(clearTimeout(d(Bl,this)),v(Bl,this,null)),r(ql,this,du).call(this),this.removeEditToolbar(),d(Ul,this)){var n,i=w(d(Ul,this).values());try{for(i.s();!(n=i.n()).done;){var a=n.value;clearTimeout(a)}}catch(s){i.e(s)}finally{i.f()}v(Ul,this,null)}this.parent=null,null===(e=d(zl,this))||void 0===e||e.destroy(),v(zl,this,null)}},{key:"isResizable",get:function(){return!1}},{key:"makeResizable",value:function(){this.isResizable&&(r(ql,this,Jl).call(this),d(Tl,this).classList.remove("hidden"))}},{key:"toolbarPosition",get:function(){return null}},{key:"keydown",value:function(e){if(this.isResizable&&e.target===this.div&&"Enter"===e.key){this._uiManager.setSelected(this),v(Pl,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});var n=d(Tl,this).children;if(!d(Al,this)){v(Al,this,Array.from(n));var i,a=r(ql,this,lu).bind(this),s=r(ql,this,uu).bind(this),o=this._uiManager._signal,l=w(d(Al,this));try{for(l.s();!(i=l.n()).done;){var u=i.value,h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:o}),u.addEventListener("blur",s,{signal:o}),u.addEventListener("focus",r(ql,this,hu).bind(this,h),{signal:o}),u.setAttribute("data-l10n-id",t._l10nResizer[h])}}catch(E){l.e(E)}finally{l.f()}}var c,f=d(Al,this)[0],p=0,g=w(n);try{for(g.s();!(c=g.n()).done;){if(c.value===f)break;p++}}catch(E){g.e(E)}finally{g.f()}var y=(360-this.rotation+this.parentRotation)%360/90*(d(Al,this).length/4);if(y!==p){if(y<p)for(var m=0;m<p-y;m++)d(Tl,this).append(d(Tl,this).firstChild);else if(y>p)for(var b=0;b<y-p;b++)d(Tl,this).firstChild.before(d(Tl,this).lastChild);var k,A=0,_=w(n);try{for(_.s();!(k=_.n()).done;){var x=k.value,S=d(Al,this)[A++].getAttribute("data-resizer-name");x.setAttribute("data-l10n-id",t._l10nResizer[S])}}catch(E){_.e(E)}finally{_.f()}}r(ql,this,cu).call(this,0),v(Wl,this,!0),d(Tl,this).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}}},{key:"_resizeWithKeyboard",value:function(t,e){d(Wl,this)&&r(ql,this,eu).call(this,d(Dl,this),{deltaX:t,deltaY:e,fromKeyboard:!0})}},{key:"_stopResizingWithKeyboard",value:function(){r(ql,this,du).call(this),this.div.focus()}},{key:"select",value:function(){var t,e,n,i=this;this.isSelected&&this._editToolbar||(this.isSelected=!0,this.makeResizable(),null===(t=this.div)||void 0===t||t.classList.add("selectedEditor"),this._editToolbar?(null===(e=this._editToolbar)||void 0===e||e.show(),null===(n=d(_l,this))||void 0===n||n.toggleAltTextBadge(!1)):this.addEditToolbar().then((function(){var t,e;null!==(t=i.div)&&void 0!==t&&t.classList.contains("selectedEditor")&&(null===(e=i._editToolbar)||void 0===e||e.show())})))}},{key:"unselect",value:function(){var t,e,n,i,r;this.isSelected&&(this.isSelected=!1,null===(t=d(Tl,this))||void 0===t||t.classList.add("hidden"),null===(e=this.div)||void 0===e||e.classList.remove("selectedEditor"),null!==(n=this.div)&&void 0!==n&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),null===(i=this._editToolbar)||void 0===i||i.hide(),null===(r=d(_l,this))||void 0===r||r.toggleAltTextBadge(!0))}},{key:"updateParams",value:function(t,e){}},{key:"disableEditing",value:function(){}},{key:"enableEditing",value:function(){}},{key:"canChangeContent",get:function(){return!1}},{key:"enterInEditMode",value:function(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}},{key:"dblclick",value:function(t){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}},{key:"getElementForAltText",value:function(){return this.div}},{key:"contentDiv",get:function(){return this.div}},{key:"isEditing",get:function(){return d(Fl,this)},set:function(t){v(Fl,this,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}},{key:"setAspectRatio",value:function(t,e){v(Cl,this,!0);var n=t/e,i=this.div.style;i.aspectRatio=n,i.height="auto"}},{key:"telemetryInitialData",get:function(){return{action:"added"}}},{key:"telemetryFinalData",get:function(){return null}},{key:"_reportTelemetry",value:function(e){var n=this;if(arguments.length>1&&arguments[1]!==undefined&&arguments[1]){d(Ul,this)||v(Ul,this,new Map);var i=e.action,r=d(Ul,this).get(i);return r&&clearTimeout(r),r=setTimeout((function(){n._reportTelemetry(e),d(Ul,n)["delete"](i),0===d(Ul,n).size&&v(Ul,n,null)}),t._telemetryTimeout),void d(Ul,this).set(i,r)}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}},{key:"show",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this._isVisible;this.div.classList.toggle("hidden",!t),this._isVisible=t}},{key:"enable",value:function(){this.div&&(this.div.tabIndex=0),v(Sl,this,!1)}},{key:"disable",value:function(){this.div&&(this.div.tabIndex=-1),v(Sl,this,!0)}},{key:"renderAnnotationElement",value:function(t){var e=t.container.querySelector(".annotationContent");if(e){if("CANVAS"===e.nodeName){var n=e;(e=document.createElement("div")).classList.add("annotationContent",this.editorType),n.before(e)}}else(e=document.createElement("div")).classList.add("annotationContent",this.editorType),t.container.prepend(e);return e}},{key:"resetAnnotationElement",value:function(t){var e=t.container.firstChild;"DIV"===(null==e?void 0:e.nodeName)&&e.classList.contains("annotationContent")&&e.remove()}}],[{key:"_resizerKeyboardManager",get:function(){var e=t.prototype._resizeWithKeyboard,n=lo.TRANSLATE_SMALL,i=lo.TRANSLATE_BIG;return Or(this,"_resizerKeyboardManager",new cs([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-n,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[n,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-n]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,n]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],t.prototype._stopResizingWithKeyboard]]))}},{key:"isDrawer",get:function(){return!1}},{key:"_defaultLineColor",get:function(){return Or(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}},{key:"deleteAnnotationElement",value:function(t){var e=new fu({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}},{key:"initialize",value:function(e,n){var i;if(null!==(i=t._l10n)&&void 0!==i||(t._l10n=e),t._l10nResizer||(t._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),-1===t._borderLineWidth){var r=getComputedStyle(document.documentElement);t._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}}},{key:"updateDefaultParams",value:function(t,e){}},{key:"defaultPropertiesToUpdate",get:function(){return[]}},{key:"isHandlingMimeForPasting",value:function(t){return!1}},{key:"paste",value:function(t,e){Pr("Not implemented")}},{key:"_round",value:function(t){return Math.round(1e4*t)/1e4}},{key:"deserialize",value:(e=l(T().m((function h(t,e,n){var i,r,a,s,o,l,u,c,d,f;return T().w((function(h){for(;;)if(0===h.n)return(i=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n,annotationElementId:t.annotationElementId})).rotation=t.rotation,v(kl,i,t.accessibilityData),i._isCopy=t.isCopy||!1,r=D(i.pageDimensions,2),a=r[0],s=r[1],o=i.getRectInCurrentCoords(t.rect,s),l=D(o,4),u=l[0],c=l[1],d=l[2],f=l[3],i.x=u/a,i.y=c/s,i.width=d/a,i.height=f/s,h.a(2,i)}),h,this)}))),function(t,n,i){return e.apply(this,arguments)})},{key:"MIN_SIZE",get:function(){return 16}},{key:"canCreateNewEmptyEditor",value:function(){return!0}}]);var e,n,i,a}();function Yl(t,e,n){var i=D(t,2),r=i[0],a=i[1],s=D(this.screenToPageTranslation(e,n),2);e=s[0],n=s[1],this.x+=e/r,this.y+=n/a,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}function Kl(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}function Ql(t){switch(t){case 90:var e=D(this.pageDimensions,2),n=e[0],i=e[1];return[0,-n/i,i/n,0];case 180:return[-1,0,0,-1];case 270:var r=D(this.pageDimensions,2),a=r[0],s=r[1];return[0,a/s,-s/a,0];default:return[1,0,0,1]}}function Jl(){if(!d(Tl,this)){v(Tl,this,document.createElement("div")),d(Tl,this).classList.add("resizers");for(var t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal,n=0,i=t;n<i.length;n++){var a=i[n],s=document.createElement("div");d(Tl,this).append(s),s.classList.add("resizer",a),s.setAttribute("data-resizer-name",a),s.addEventListener("pointerdown",r(ql,this,Zl).bind(this,a),{signal:e}),s.addEventListener("contextmenu",pa,{signal:e}),s.tabIndex=-1}this.div.prepend(d(Tl,this))}}function Zl(t,e){var n,i=this;e.preventDefault();var a=Vr.platform.isMac;if(!(0!==e.button||e.ctrlKey&&a)){null===(n=d(_l,this))||void 0===n||n.toggle(!1);var s=this._isDraggable;this._isDraggable=!1,v(Rl,this,[e.screenX,e.screenY]);var o=new AbortController,l=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",r(ql,this,eu).bind(this,t),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",ga,{passive:!1,signal:l}),window.addEventListener("contextmenu",pa,{signal:l}),v(Pl,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});var u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;var c=function(){var t;o.abort(),i.parent.togglePointerEvents(!0),null===(t=d(_l,i))||void 0===t||t.toggle(!0),i._isDraggable=s,i.parent.div.style.cursor=u,i.div.style.cursor=h,r(ql,i,tu).call(i)};window.addEventListener("pointerup",c,{signal:l}),window.addEventListener("blur",c,{signal:l})}}function $l(t,e,n,i){this.width=n,this.height=i,this.x=t,this.y=e;var r=D(this.parentDimensions,2),a=r[0],s=r[1];this.setDims(a*n,s*i),this.fixAndSetPosition(),this._onResized()}function tu(){if(d(Pl,this)){var t=d(Pl,this),e=t.savedX,n=t.savedY,i=t.savedWidth,a=t.savedHeight;v(Pl,this,null);var s=this.x,o=this.y,l=this.width,u=this.height;s===e&&o===n&&l===i&&u===a||this.addCommands({cmd:r(ql,this,$l).bind(this,s,o,l,u),undo:r(ql,this,$l).bind(this,e,n,i,a),mustExec:!0})}}function eu(t,e){var n,i,a=D(this.parentDimensions,2),s=a[0],o=a[1],l=this.x,u=this.y,h=this.width,c=this.height,f=Si.MIN_SIZE/s,p=Si.MIN_SIZE/o,g=r(ql,this,Ql).call(this,this.rotation),y=function(t,e){return[g[0]*t+g[2]*e,g[1]*t+g[3]*e]},m=r(ql,this,Ql).call(this,360-this.rotation),w=!1,b=!1;switch(t){case"topLeft":w=!0,n=function(t,e){return[0,0]},i=function(t,e){return[t,e]};break;case"topMiddle":n=function(t,e){return[t/2,0]},i=function(t,e){return[t/2,e]};break;case"topRight":w=!0,n=function(t,e){return[t,0]},i=function(t,e){return[0,e]};break;case"middleRight":b=!0,n=function(t,e){return[t,e/2]},i=function(t,e){return[0,e/2]};break;case"bottomRight":w=!0,n=function(t,e){return[t,e]},i=function(t,e){return[0,0]};break;case"bottomMiddle":n=function(t,e){return[t/2,e]},i=function(t,e){return[t/2,0]};break;case"bottomLeft":w=!0,n=function(t,e){return[0,e]},i=function(t,e){return[t,0]};break;case"middleLeft":b=!0,n=function(t,e){return[0,e/2]},i=function(t,e){return[t,e/2]}}var k,A,_=n(h,c),x=i(h,c),S=y.apply(void 0,F(x)),E=Si._round(l+S[0]),M=Si._round(u+S[1]),C=1,T=1;if(e.fromKeyboard)k=e.deltaX,A=e.deltaY;else{var R=e.screenX,P=e.screenY,I=D(d(Rl,this),2),L=I[0],O=I[1],N=D(this.screenToPageTranslation(R-L,P-O),2);k=N[0],A=N[1],d(Rl,this)[0]=R,d(Rl,this)[1]=P}var W,B,j=D((W=k/s,B=A/o,[m[0]*W+m[2]*B,m[1]*W+m[3]*B]),2);if(k=j[0],A=j[1],w){var H=Math.hypot(h,c);C=T=Math.max(Math.min(Math.hypot(x[0]-_[0]-k,x[1]-_[1]-A)/H,1/h,1/c),f/h,p/c)}else b?C=ea(Math.abs(x[0]-_[0]-k),f,1)/h:T=ea(Math.abs(x[1]-_[1]-A),p,1)/c;var U=Si._round(h*C),z=Si._round(c*T),G=E-(S=y.apply(void 0,F(i(U,z))))[0],V=M-S[1];d(Ol,this)||v(Ol,this,[this.x,this.y,this.width,this.height]),this.width=U,this.height=z,this.x=G,this.y=V,this.setDims(s*U,o*z),this.fixAndSetPosition(),this._onResizing()}function nu(){var t;v(Pl,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),null===(t=d(_l,this))||void 0===t||t.toggle(!1),this.parent.togglePointerEvents(!1)}function iu(t,e,n){var i=n/e*.7+1-.7;if(1!==i){var a=r(ql,this,Ql).call(this,this.rotation),s=function(t,e){return[a[0]*t+a[2]*e,a[1]*t+a[3]*e]},o=D(this.parentDimensions,2),l=o[0],u=o[1],h=this.x,c=this.y,f=this.width,p=this.height,g=Si.MIN_SIZE/l,y=Si.MIN_SIZE/u;i=Math.max(Math.min(i,1/f,1/p),g/f,y/p);var m=Si._round(f*i),w=Si._round(p*i);if(m!==f||w!==p){d(Ol,this)||v(Ol,this,[h,c,f,p]);var b=s(f/2,p/2),k=Si._round(h+b[0]),A=Si._round(c+b[1]),_=s(m/2,w/2);this.x=k-_[0],this.y=A-_[1],this.width=m,this.height=w,this.setDims(l*m,u*w),this.fixAndSetPosition(),this._onResizing()}}}function ru(){var t;null===(t=d(_l,this))||void 0===t||t.toggle(!0),this.parent.togglePointerEvents(!0),r(ql,this,tu).call(this)}function au(t){var e=Vr.platform.isMac;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}function su(t){var e=this,n=this.isSelected;this._uiManager.setUpDragSession();var i=!1,a=new AbortController,s=this._uiManager.combinedSignal(a),o={capture:!0,passive:!1,signal:s},l=function(t){a.abort(),v(El,e,null),v(Ll,e,!1),e._uiManager.endDragSession()||r(ql,e,au).call(e,t),i&&e._onStopDragging()};n&&(v(jl,this,t.clientX),v(Hl,this,t.clientY),v(El,this,t.pointerId),v(Ml,this,t.pointerType),window.addEventListener("pointermove",(function(t){i||(i=!0,e._onStartDragging());var n=t.clientX,r=t.clientY;if(t.pointerId===d(El,e)){var a=D(e.screenToPageTranslation(n-d(jl,e),r-d(Hl,e)),2),s=a[0],o=a[1];v(jl,e,n),v(Hl,e,r),e._uiManager.dragSelectedEditors(s,o)}else ga(t)}),o),window.addEventListener("touchmove",ga,o),window.addEventListener("pointerdown",(function(t){t.pointerType===d(Ml,e)&&(d(zl,e)||t.isPrimary)&&l(t),ga(t)}),o));var u=function(t){d(El,e)&&d(El,e)!==t.pointerId?ga(t):l(t)};window.addEventListener("pointerup",u,{signal:s}),window.addEventListener("blur",u,{signal:s})}function ou(){if(!d(Il,this)&&this.div){v(Il,this,new AbortController);var t=this._uiManager.combinedSignal(d(Il,this));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}}function lu(t){Si._resizerKeyboardManager.exec(this,t)}function uu(t){var e;d(Wl,this)&&(null===(e=t.relatedTarget)||void 0===e?void 0:e.parentNode)!==d(Tl,this)&&r(ql,this,du).call(this)}function hu(t){v(Dl,this,d(Wl,this)?t:"")}function cu(t){if(d(Al,this)){var e,n=w(d(Al,this));try{for(n.s();!(e=n.n()).done;){e.value.tabIndex=t}}catch(i){n.e(i)}finally{n.f()}}}function du(){v(Wl,this,!1),r(ql,this,cu).call(this,-1),r(ql,this,tu).call(this)}Si=Xl,b(Xl,"_l10n",null),b(Xl,"_l10nResizer",null),b(Xl,"_borderLineWidth",-1),b(Xl,"_colorManager",new fs),b(Xl,"_zIndex",1),b(Xl,"_telemetryTimeout",1e3);var fu=function(t){function e(t){var n;return c(this,e),(n=u(this,e,[t])).annotationElementId=t.annotationElementId,n.deleted=!0,n}return _(e,t),m(e,[{key:"serialize",value:function(){return this.serializeDeleted()}}])}(Xl),vu=3285377520,pu=4294901760,gu=65535,yu=function(){return m((function t(e){c(this,t),this.h1=e?4294967295&e:vu,this.h2=e?4294967295&e:vu}),[{key:"update",value:function(t){var e,n;if("string"==typeof t){e=new Uint8Array(2*t.length),n=0;for(var i=0,r=t.length;i<r;i++){var a=t.charCodeAt(i);a<=255?e[n++]=a:(e[n++]=a>>>8,e[n++]=255&a)}}else{if(!ArrayBuffer.isView(t))throw new Error("Invalid data format, must be a string or TypedArray.");n=(e=t.slice()).byteLength}for(var s=n>>2,o=n-4*s,l=new Uint32Array(e.buffer,0,s),u=0,h=0,c=this.h1,d=this.h2,f=3432918353,v=461845907,p=11601,g=13715,y=0;y<s;y++)1&y?c=5*(c=(c^=u=(u=(u=(u=l[y])*f&pu|u*p&gu)<<15|u>>>17)*v&pu|u*g&gu)<<13|c>>>19)+3864292196:d=5*(d=(d^=h=(h=(h=(h=l[y])*f&pu|h*p&gu)<<15|h>>>17)*v&pu|h*g&gu)<<13|d>>>19)+3864292196;switch(u=0,o){case 3:u^=e[4*s+2]<<16;case 2:u^=e[4*s+1]<<8;case 1:u=(u=(u=(u^=e[4*s])*f&pu|u*p&gu)<<15|u>>>17)*v&pu|u*g&gu,1&s?c^=u:d^=u}this.h1=c,this.h2=d}},{key:"hexdigest",value:function(){var t=this.h1,e=this.h2;return t=3981806797*(t^=e>>>1)&pu|36045*t&gu,t=444984403*(t^=(e=4283543511*e&pu|(2950163797*(e<<16|t>>>16)&pu)>>>16)>>>1)&pu|60499*t&gu,((t^=(e=3301882366*e&pu|(3120437893*(e<<16|t>>>16)&pu)>>>16)>>>1)>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}])}(),mu=Object.freeze({map:null,hash:"",transfer:undefined}),wu=new WeakMap,bu=new WeakMap,ku=new WeakMap,Au=new WeakSet,_u=function(){return m((function t(){c(this,t),g(this,Au),f(this,wu,!1),f(this,bu,null),f(this,ku,new Map),this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}),[{key:"getValue",value:function(t,e){var n=d(ku,this).get(t);return n===undefined?e:Object.assign(e,n)}},{key:"getRawValue",value:function(t){return d(ku,this).get(t)}},{key:"remove",value:function(t){if(d(ku,this)["delete"](t),0===d(ku,this).size&&this.resetModified(),"function"==typeof this.onAnnotationEditor){var e,n=w(d(ku,this).values());try{for(n.s();!(e=n.n()).done;){if(e.value instanceof Xl)return}}catch(i){n.e(i)}finally{n.f()}this.onAnnotationEditor(null)}}},{key:"setValue",value:function(t,e){var n=d(ku,this).get(t),i=!1;if(n!==undefined)for(var a=0,s=Object.entries(e);a<s.length;a++){var o=D(s[a],2),l=o[0],u=o[1];n[l]!==u&&(i=!0,n[l]=u)}else i=!0,d(ku,this).set(t,e);i&&r(Au,this,xu).call(this),e instanceof Xl&&"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(e.constructor._type)}},{key:"has",value:function(t){return d(ku,this).has(t)}},{key:"size",get:function(){return d(ku,this).size}},{key:"resetModified",value:function(){d(wu,this)&&(v(wu,this,!1),"function"==typeof this.onResetModified&&this.onResetModified())}},{key:"print",get:function(){return new Eu(this)}},{key:"serializable",get:function(){if(0===d(ku,this).size)return mu;var t,e=new Map,n=new yu,i=[],r=Object.create(null),a=!1,s=w(d(ku,this));try{for(s.s();!(t=s.n()).done;){var o=D(t.value,2),l=o[0],u=o[1],h=u instanceof Xl?u.serialize(!1,r):u;h&&(e.set(l,h),n.update("".concat(l,":").concat(JSON.stringify(h))),a||(a=!!h.bitmap))}}catch(p){s.e(p)}finally{s.f()}if(a){var c,f=w(e.values());try{for(f.s();!(c=f.n()).done;){var v=c.value;v.bitmap&&i.push(v.bitmap)}}catch(p){f.e(p)}finally{f.f()}}return e.size>0?{map:e,hash:n.hexdigest(),transfer:i}:mu}},{key:"editorStats",get:function(){var t,e=null,n=new Map,i=w(d(ku,this).values());try{for(i.s();!(t=i.n()).done;){var r,a=t.value;if(a instanceof Xl){var s=a.telemetryFinalData;if(s){var o=s.type;n.has(o)||n.set(o,Object.getPrototypeOf(a).constructor),e||(e=Object.create(null));for(var l=(r=e)[o]||(r[o]=new Map),u=0,h=Object.entries(s);u<h.length;u++){var c,f=D(h[u],2),v=f[0],p=f[1];if("type"!==v){var g=l.get(v);g||(g=new Map,l.set(v,g));var y=null!==(c=g.get(p))&&void 0!==c?c:0;g.set(p,y+1)}}}}}}catch(x){i.e(x)}finally{i.f()}var m,b=w(n);try{for(b.s();!(m=b.n()).done;){var k=D(m.value,2),A=k[0],_=k[1];e[A]=_.computeTelemetryFinalData(e[A])}}catch(x){b.e(x)}finally{b.f()}return e}},{key:"resetModifiedIds",value:function(){v(bu,this,null)}},{key:"modifiedIds",get:function(){if(d(bu,this))return d(bu,this);var t,e=[],n=w(d(ku,this).values());try{for(n.s();!(t=n.n()).done;){var i=t.value;i instanceof Xl&&i.annotationElementId&&i.serialize()&&e.push(i.annotationElementId)}}catch(r){n.e(r)}finally{n.f()}return v(bu,this,{ids:new Set(e),hash:e.join(",")})}},{key:Symbol.iterator,value:function(){return d(ku,this).entries()}}])}();function xu(){d(wu,this)||(v(wu,this,!0),"function"==typeof this.onSetModified&&this.onSetModified())}var Su=new WeakMap,Eu=function(t){function e(t){var n;c(this,e),f(n=u(this,e),Su,void 0);var i=t.serializable,r=i.map,a=i.hash,s=i.transfer,o=structuredClone(r,s?{transfer:s}:null);return v(Su,n,{map:o,hash:a,transfer:s}),n}return _(e,t),m(e,[{key:"print",get:function(){Pr("Should not call PrintAnnotationStorage.print")}},{key:"serializable",get:function(){return d(Su,this)}},{key:"modifiedIds",get:function(){return Or(this,"modifiedIds",{ids:new Set,hash:""})}}])}(_u),Mu=new WeakMap,Cu=function(){return m((function n(t){var e=t.ownerDocument,i=void 0===e?globalThis.document:e;t.styleElement,c(this,n),f(this,Mu,new Set),this._document=i,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}),[{key:"addNativeFontFace",value:function(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}},{key:"removeNativeFontFace",value:function(t){this.nativeFontFaces["delete"](t),this._document.fonts["delete"](t)}},{key:"insertRule",value:function(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));var e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}},{key:"clear",value:function(){var t,e=w(this.nativeFontFaces);try{for(e.s();!(t=e.n()).done;){var n=t.value;this._document.fonts["delete"](n)}}catch(i){e.e(i)}finally{e.f()}this.nativeFontFaces.clear(),d(Mu,this).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}},{key:"loadSystemFont",value:(e=l(T().m((function i(t){var e,n,r,a,s,o,l;return T().w((function(i){for(;;)switch(i.p=i.n){case 0:if(e=t.systemFontInfo,n=t.disableFontFace,r=t._inspectFont,e&&!d(Mu,this).has(e.loadedName)){i.n=1;break}return i.a(2);case 1:if(Ir(!n,"loadSystemFont shouldn't be called when `disableFontFace` is set."),!this.isFontLoadingAPISupported){i.n=6;break}return a=e.loadedName,s=e.src,o=e.style,l=new FontFace(a,s,o),this.addNativeFontFace(l),i.p=2,i.n=3,l.load();case 3:d(Mu,this).add(a),null==r||r(e),i.n=5;break;case 4:i.p=4,i.v,Rr("Cannot load system font: ".concat(e.baseFontName,", installing it could help to improve PDF rendering.")),this.removeNativeFontFace(l);case 5:return i.a(2);case 6:Pr("Not implemented: loadSystemFont without the Font Loading API.");case 7:return i.a(2)}}),i,this,[[2,4]])}))),function(t){return e.apply(this,arguments)})},{key:"bind",value:(t=l(T().m((function r(t){var e,n,i,a=this;return T().w((function(r){for(;;)switch(r.p=r.n){case 0:if(!(t.attached||t.missingFile&&!t.systemFontInfo)){r.n=1;break}return r.a(2);case 1:if(t.attached=!0,!t.systemFontInfo){r.n=3;break}return r.n=2,this.loadSystemFont(t);case 2:case 7:case 10:return r.a(2);case 3:if(!this.isFontLoadingAPISupported){r.n=8;break}if(!(e=t.createNativeFontFace())){r.n=7;break}return this.addNativeFontFace(e),r.p=4,r.n=5,e.loaded;case 5:r.n=7;break;case 6:throw r.p=6,i=r.v,Rr("Failed to load font '".concat(e.family,"': '").concat(i,"'.")),t.disableFontFace=!0,i;case 8:if(!(n=t.createFontFaceRule())){r.n=10;break}if(this.insertRule(n),!this.isSyncFontLoadingSupported){r.n=9;break}return r.a(2);case 9:return r.n=10,new Promise((function(e){var n=a._queueLoadingCallback(e);a._prepareFontLoadEvent(t,n)}))}}),r,this,[[4,6]])}))),function(e){return t.apply(this,arguments)})},{key:"isFontLoadingAPISupported",get:function(){var t;return Or(this,"isFontLoadingAPISupported",!(null===(t=this._document)||void 0===t||!t.fonts))}},{key:"isSyncFontLoadingSupported",get:function(){return Or(this,"isSyncFontLoadingSupported",Gi||Vr.platform.isFirefox)}},{key:"_queueLoadingCallback",value:function(t){var e=this.loadingRequests,n={done:!1,complete:function(){for(Ir(!n.done,"completeRequest() cannot be called twice."),n.done=!0;e.length>0&&e[0].done;){var t=e.shift();setTimeout(t.callback,0)}},callback:t};return e.push(n),n}},{key:"_loadTestFont",get:function(){return Or(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}},{key:"_prepareFontLoadEvent",value:function(t,e){function n(t,e){return t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|255&t.charCodeAt(e+3)}function i(t,e,n,i){return t.substring(0,e)+i+t.substring(e+n)}var r,a,s=this._document.createElement("canvas");s.width=1,s.height=1;var o=s.getContext("2d"),l=0;var u,h="lt".concat(Date.now()).concat(this.loadTestFontId++),c=this._loadTestFont,d=1482184792,f=n(c=i(c,976,h.length,h),16);for(r=0,a=h.length-3;r<a;r+=4)f=f-d+n(h,r)|0;r<h.length&&(f=f-d+n(h+"XXX",r)|0),c=i(c,16,4,(u=f,String.fromCharCode(u>>24&255,u>>16&255,u>>8&255,255&u)));var v="url(data:font/opentype;base64,".concat(btoa(c),");"),p='@font-face {font-family:"'.concat(h,'";src:').concat(v,"}");this.insertRule(p);var g=this._document.createElement("div");g.style.visibility="hidden",g.style.width=g.style.height="10px",g.style.position="absolute",g.style.top=g.style.left="0px";for(var y=0,m=[t.loadedName,h];y<m.length;y++){var w=m[y],b=this._document.createElement("span");b.textContent="Hi",b.style.fontFamily=w,g.append(b)}this._document.body.append(g),function k(t,e){if(++l>30)return Rr("Load test font never loaded."),void e();o.font="30px "+t,o.fillText(".",0,20),o.getImageData(0,0,1,1).data[3]>0?e():setTimeout(k.bind(null,t,e))}(h,(function(){g.remove(),e.complete()}))}}]);var t,e}(),Tu=function(){return m((function t(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;for(var i in c(this,t),this.compiledGlyphs=Object.create(null),e)this[i]=e[i];this._inspectFont=n}),[{key:"createNativeFontFace",value:function(){var t,e;if(!this.data||this.disableFontFace)return null;if(this.cssFontInfo){var n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style="oblique ".concat(this.cssFontInfo.italicAngle,"deg")),e=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}else e=new FontFace(this.loadedName,this.data,{});return null===(t=this._inspectFont)||void 0===t||t.call(this,this),e}},{key:"createFontFaceRule",value:function(){var t;if(!this.data||this.disableFontFace)return null;var e,n="url(data:".concat(this.mimetype,";base64,").concat(na(this.data),");");if(this.cssFontInfo){var i="font-weight: ".concat(this.cssFontInfo.fontWeight,";");this.cssFontInfo.italicAngle&&(i+="font-style: oblique ".concat(this.cssFontInfo.italicAngle,"deg;")),e='@font-face {font-family:"'.concat(this.cssFontInfo.fontFamily,'";').concat(i,"src:").concat(n,"}")}else e='@font-face {font-family:"'.concat(this.loadedName,'";src:').concat(n,"}");return null===(t=this._inspectFont)||void 0===t||t.call(this,this,n),e}},{key:"getPathGenerator",value:function(t,e){if(this.compiledGlyphs[e]!==undefined)return this.compiledGlyphs[e];var n,i=this.loadedName+"_path_"+e;try{n=t.get(i)}catch(a){Rr('getPathGenerator - ignoring character: "'.concat(a,'".'))}var r=new Path2D(n||"");return this.fontExtraProperties||t["delete"](i),this.compiledGlyphs[e]=r}}])}();function Ru(t){if("string"!=typeof t)return null;if(t.endsWith("/"))return t;throw new Error('Invalid factory url: "'.concat(t,'" must include trailing slash.'))}var Pu=function(t){return"object"===B(t)&&Number.isInteger(null==t?void 0:t.num)&&t.num>=0&&Number.isInteger(null==t?void 0:t.gen)&&t.gen>=0},Iu=function(t,e,n){if(!Array.isArray(n)||n.length<2)return!1;var i=O(n),r=i[0],a=i[1],s=i.slice(2);if(!t(r)&&!Number.isInteger(r))return!1;if(!e(a))return!1;var o=s.length,l=!0;switch(a.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return 0===o;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(4!==o)return!1;l=!1;break;default:return!1}var u,h=w(s);try{for(h.s();!(u=h.n()).done;){var c=u.value;if(!("number"==typeof c||l&&null===c))return!1}}catch(d){h.e(d)}finally{h.f()}return!0}.bind(null,Pu,(function(t){return"object"===B(t)&&"string"==typeof(null==t?void 0:t.name)})),Du=new WeakMap,Lu=new WeakMap,Ou=function(){return m((function t(){c(this,t),f(this,Du,new Map),f(this,Lu,Promise.resolve())}),[{key:"postMessage",value:function(t,e){var n=this,i={data:structuredClone(t,e?{transfer:e}:null)};d(Lu,this).then((function(){var t,e=w(d(Du,n));try{for(e.s();!(t=e.n()).done;){D(t.value,1)[0].call(n,i)}}catch(r){e.e(r)}finally{e.f()}}))}},{key:"addEventListener",value:function(t,e){var n=this,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null,r=null;if((null==i?void 0:i.signal)instanceof AbortSignal){var a=i.signal;if(a.aborted)return void Rr("LoopbackPort - cannot use an `aborted` signal.");var s=function(){return n.removeEventListener(t,e)};r=function(){return a.removeEventListener("abort",s)},a.addEventListener("abort",s)}d(Du,this).set(e,r)}},{key:"removeEventListener",value:function(t,e){var n=d(Du,this).get(e);null==n||n(),d(Du,this)["delete"](e)}},{key:"terminate",value:function(){var t,e=w(d(Du,this));try{for(e.s();!(t=e.n()).done;){var n=D(t.value,2)[1];null==n||n()}}catch(i){e.e(i)}finally{e.f()}d(Du,this).clear()}}])}(),Fu=1,Nu=2,Wu=1,Bu=2,ju=3,Hu=4,Uu=5,zu=6,Gu=7,Vu=8;function qu(){}function Xu(t){if(t instanceof Ur||t instanceof Br||t instanceof Nr||t instanceof jr||t instanceof Wr)return t;switch(t instanceof Error||"object"===B(t)&&null!==t||Pr('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),t.name){case"AbortException":return new Ur(t.message);case"InvalidPDFException":return new Br(t.message);case"PasswordException":return new Nr(t.message,t.code);case"ResponseException":return new jr(t.message,t.status,t.missing);case"UnknownErrorException":return new Wr(t.message,t.details)}return new Wr(t.message,t.toString())}var Yu=new WeakMap,Ku=new WeakSet,Qu=function(){return m((function t(e,n,i){c(this,t),g(this,Ku),f(this,Yu,new AbortController),this.sourceName=e,this.targetName=n,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",r(Ku,this,Ju).bind(this),{signal:d(Yu,this).signal})}),[{key:"on",value:function(t,e){var n=this.actionHandler;if(n[t])throw new Error('There is already an actionName called "'.concat(t,'"'));n[t]=e}},{key:"send",value:function(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}},{key:"sendWithPromise",value:function(t,e,n){var i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:i,data:e},n)}catch(a){r.reject(a)}return r.promise}},{key:"sendWithStream",value:function(t,e,n,i){var r=this,a=this.streamId++,s=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:function(n){var u=Promise.withResolvers();return r.streamControllers[a]={controller:n,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:s,targetName:o,action:t,streamId:a,data:e,desiredSize:n.desiredSize},i),u.promise},pull:function(t){var e=Promise.withResolvers();return r.streamControllers[a].pullCall=e,l.postMessage({sourceName:s,targetName:o,stream:zu,streamId:a,desiredSize:t.desiredSize}),e.promise},cancel:function(t){Ir(t instanceof Error,"cancel must have a valid reason");var e=Promise.withResolvers();return r.streamControllers[a].cancelCall=e,r.streamControllers[a].isClosed=!0,l.postMessage({sourceName:s,targetName:o,stream:Wu,streamId:a,reason:Xu(t)}),e.promise}},n)}},{key:"destroy",value:function(){var t;null===(t=d(Yu,this))||void 0===t||t.abort(),v(Yu,this,null)}}])}();function Ju(t){var e=t.data;if(e.targetName===this.sourceName)if(e.stream)r(Ku,this,$u).call(this,e);else if(e.callback){var n=e.callbackId,i=this.callbackCapabilities[n];if(!i)throw new Error("Cannot resolve callback ".concat(n));if(delete this.callbackCapabilities[n],e.callback===Fu)i.resolve(e.data);else{if(e.callback!==Nu)throw new Error("Unexpected callback case");i.reject(Xu(e.reason))}}else{var a=this.actionHandler[e.action];if(!a)throw new Error("Unknown action from worker: ".concat(e.action));if(e.callbackId){var s=this.sourceName,o=e.sourceName,l=this.comObj;Promise["try"](a,e.data).then((function(t){l.postMessage({sourceName:s,targetName:o,callback:Fu,callbackId:e.callbackId,data:t})}),(function(t){l.postMessage({sourceName:s,targetName:o,callback:Nu,callbackId:e.callbackId,reason:Xu(t)})}))}else e.streamId?r(Ku,this,Zu).call(this,e):a(e.data)}}function Zu(t){var e=t.streamId,n=this.sourceName,i=t.sourceName,r=this.comObj,a=this,s=this.actionHandler[t.action],o={enqueue:function(t){var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1,s=arguments.length>2?arguments[2]:undefined;if(!this.isCancelled){var o=this.desiredSize;this.desiredSize-=a,o>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:n,targetName:i,stream:Hu,streamId:e,chunk:t},s)}},close:function(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:n,targetName:i,stream:ju,streamId:e}),delete a.streamSinks[e])},error:function(t){Ir(t instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:n,targetName:i,stream:Uu,streamId:e,reason:Xu(t)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};o.sinkCapability.resolve(),o.ready=o.sinkCapability.promise,this.streamSinks[e]=o,Promise["try"](s,t.data,o).then((function(){r.postMessage({sourceName:n,targetName:i,stream:Vu,streamId:e,success:!0})}),(function(t){r.postMessage({sourceName:n,targetName:i,stream:Vu,streamId:e,reason:Xu(t)})}))}function $u(t){var e=t.streamId,n=this.sourceName,i=t.sourceName,a=this.comObj,s=this.streamControllers[e],o=this.streamSinks[e];switch(t.stream){case Vu:t.success?s.startCall.resolve():s.startCall.reject(Xu(t.reason));break;case Gu:t.success?s.pullCall.resolve():s.pullCall.reject(Xu(t.reason));break;case zu:if(!o){a.postMessage({sourceName:n,targetName:i,stream:Gu,streamId:e,success:!0});break}o.desiredSize<=0&&t.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=t.desiredSize,Promise["try"](o.onPull||qu).then((function(){a.postMessage({sourceName:n,targetName:i,stream:Gu,streamId:e,success:!0})}),(function(t){a.postMessage({sourceName:n,targetName:i,stream:Gu,streamId:e,reason:Xu(t)})}));break;case Hu:if(Ir(s,"enqueue should have stream controller"),s.isClosed)break;s.controller.enqueue(t.chunk);break;case ju:if(Ir(s,"close should have stream controller"),s.isClosed)break;s.isClosed=!0,s.controller.close(),r(Ku,this,th).call(this,s,e);break;case Uu:Ir(s,"error should have stream controller"),s.controller.error(Xu(t.reason)),r(Ku,this,th).call(this,s,e);break;case Bu:t.success?s.cancelCall.resolve():s.cancelCall.reject(Xu(t.reason)),r(Ku,this,th).call(this,s,e);break;case Wu:if(!o)break;var l=Xu(t.reason);Promise["try"](o.onCancel||qu,l).then((function(){a.postMessage({sourceName:n,targetName:i,stream:Bu,streamId:e,success:!0})}),(function(t){a.postMessage({sourceName:n,targetName:i,stream:Bu,streamId:e,reason:Xu(t)})})),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}function th(t,e){return eh.apply(this,arguments)}function eh(){return(eh=l(T().m((function t(e,n){var i,r,a;return T().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,Promise.allSettled([null===(i=e.startCall)||void 0===i?void 0:i.promise,null===(r=e.pullCall)||void 0===r?void 0:r.promise,null===(a=e.cancelCall)||void 0===a?void 0:a.promise]);case 1:delete this.streamControllers[n];case 2:return t.a(2)}}),t,this)})))).apply(this,arguments)}var nh=new WeakMap,ih=function(){return m((function t(e){var n=e.enableHWA,i=void 0!==n&&n;c(this,t),f(this,nh,!1),v(nh,this,i)}),[{key:"create",value:function(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");var n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!d(nh,this)})}}},{key:"reset",value:function(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}},{key:"destroy",value:function(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}},{key:"_createCanvas",value:function(t,e){Pr("Abstract method `_createCanvas` called.")}}])}(),rh=function(t){function e(t){var n,i=t.ownerDocument,r=void 0===i?globalThis.document:i,a=t.enableHWA,s=void 0!==a&&a;return c(this,e),(n=u(this,e,[{enableHWA:s}]))._document=r,n}return _(e,t),m(e,[{key:"_createCanvas",value:function(t,e){var n=this._document.createElement("canvas");return n.width=t,n.height=e,n}}])}(ih),ah=function(){return m((function n(t){var e=t.baseUrl,i=void 0===e?null:e,r=t.isCompressed,a=void 0===r||r;c(this,n),this.baseUrl=i,this.isCompressed=a}),[{key:"fetch",value:(e=l(T().m((function i(t){var e,n,r=this;return T().w((function(i){for(;;)switch(i.n){case 0:if(e=t.name,this.baseUrl){i.n=1;break}throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");case 1:if(e){i.n=2;break}throw new Error("CMap name must be specified.");case 2:return n=this.baseUrl+e+(this.isCompressed?".bcmap":""),i.a(2,this._fetch(n).then((function(t){return{cMapData:t,isCompressed:r.isCompressed}}))["catch"]((function(t){throw new Error("Unable to load ".concat(r.isCompressed?"binary ":"","CMap at: ").concat(n))})))}}),i,this)}))),function(t){return e.apply(this,arguments)})},{key:"_fetch",value:(t=l(T().m((function r(t){return T().w((function(t){for(;;)switch(t.n){case 0:Pr("Abstract method `_fetch` called.");case 1:return t.a(2)}}),r)}))),function(e){return t.apply(this,arguments)})}]);var t,e}(),sh=function(t){function e(){return c(this,e),u(this,e,arguments)}return _(e,t),m(e,[{key:"_fetch",value:(n=l(T().m((function i(t){var e;return T().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,aa(t,this.isCompressed?"arraybuffer":"text");case 1:return e=n.v,n.a(2,e instanceof ArrayBuffer?new Uint8Array(e):Gr(e))}}),i,this)}))),function(t){return n.apply(this,arguments)})}]);var n}(ah);zi(2489);var oh=function(){return m((function t(){c(this,t)}),[{key:"addFilter",value:function(t){return"none"}},{key:"addHCMFilter",value:function(t,e){return"none"}},{key:"addAlphaFilter",value:function(t){return"none"}},{key:"addLuminosityFilter",value:function(t){return"none"}},{key:"addHighlightHCMFilter",value:function(t,e,n,i,r){return"none"}},{key:"destroy",value:function(){}}])}(),lh=new WeakMap,uh=new WeakMap,hh=new WeakMap,ch=new WeakMap,dh=new WeakMap,fh=new WeakMap,vh=new WeakMap,ph=new WeakSet,gh=function(t){function e(t){var n,i=t.docId,r=t.ownerDocument,a=void 0===r?globalThis.document:r;return c(this,e),g(n=u(this,e),ph),f(n,lh,void 0),f(n,uh,void 0),f(n,hh,void 0),f(n,ch,void 0),f(n,dh,void 0),f(n,fh,void 0),f(n,vh,0),v(ch,n,i),v(dh,n,a),n}return _(e,t),m(e,[{key:"addFilter",value:function(t){var e,n;if(!t)return"none";var i=p(ph,this,yh).get(t);if(i)return i;var a=D(r(ph,this,bh).call(this,t),3),s=a[0],o=a[1],l=a[2],u=1===t.length?s:"".concat(s).concat(o).concat(l);if(i=p(ph,this,yh).get(u))return p(ph,this,yh).set(t,i),i;var h="g_".concat(d(ch,this),"_transfer_map_").concat((v(vh,this,(e=d(vh,this),n=e++,e)),n)),c=r(ph,this,kh).call(this,h);p(ph,this,yh).set(t,c),p(ph,this,yh).set(u,c);var f=r(ph,this,xh).call(this,h);return r(ph,this,Eh).call(this,s,o,l,f),c}},{key:"addHCMFilter",value:function(t,e){var n,i,a="".concat(t,"-").concat(e),s="base",o=p(ph,this,mh).get(s);if((null===(n=o)||void 0===n?void 0:n.key)===a)return o.url;o?(null===(i=o.filter)||void 0===i||i.remove(),o.key=a,o.url="none",o.filter=null):(o={key:a,url:"none",filter:null},p(ph,this,mh).set(s,o));if(!t||!e)return o.url;var l=r(ph,this,Ch).call(this,t);t=Xr.makeHexColor.apply(Xr,F(l));var u=r(ph,this,Ch).call(this,e);if(e=Xr.makeHexColor.apply(Xr,F(u)),p(ph,this,wh).style.color="","#000000"===t&&"#ffffff"===e||t===e)return o.url;for(var h=new Array(256),c=0;c<=255;c++){var f=c/255;h[c]=f<=.03928?f/12.92:Math.pow((f+.055)/1.055,2.4)}var v=h.join(","),g="g_".concat(d(ch,this),"_hcm_filter"),y=o.filter=r(ph,this,xh).call(this,g);r(ph,this,Eh).call(this,v,v,v,y),r(ph,this,_h).call(this,y);var m=function(t,e){for(var n=l[t]/255,i=u[t]/255,r=new Array(e+1),a=0;a<=e;a++)r[a]=n+a/e*(i-n);return r.join(",")};return r(ph,this,Eh).call(this,m(0,5),m(1,5),m(2,5),y),o.url=r(ph,this,kh).call(this,g),o.url}},{key:"addAlphaFilter",value:function(t){var e,n,i=p(ph,this,yh).get(t);if(i)return i;var a=D(r(ph,this,bh).call(this,[t]),1)[0],s="alpha_".concat(a);if(i=p(ph,this,yh).get(s))return p(ph,this,yh).set(t,i),i;var o="g_".concat(d(ch,this),"_alpha_map_").concat((v(vh,this,(e=d(vh,this),n=e++,e)),n)),l=r(ph,this,kh).call(this,o);p(ph,this,yh).set(t,l),p(ph,this,yh).set(s,l);var u=r(ph,this,xh).call(this,o);return r(ph,this,Mh).call(this,a,u),l}},{key:"addLuminosityFilter",value:function(t){var e,n,i,a,s=p(ph,this,yh).get(t||"luminosity");if(s)return s;t?(i=D(r(ph,this,bh).call(this,[t]),1)[0],a="luminosity_".concat(i)):a="luminosity";if(s=p(ph,this,yh).get(a))return p(ph,this,yh).set(t,s),s;var o="g_".concat(d(ch,this),"_luminosity_map_").concat((v(vh,this,(e=d(vh,this),n=e++,e)),n)),l=r(ph,this,kh).call(this,o);p(ph,this,yh).set(t,l),p(ph,this,yh).set(a,l);var u=r(ph,this,xh).call(this,o);return r(ph,this,Ah).call(this,u),t&&r(ph,this,Mh).call(this,i,u),l}},{key:"addHighlightHCMFilter",value:function(t,e,n,i,a){var s,o,l="".concat(e,"-").concat(n,"-").concat(i,"-").concat(a),u=p(ph,this,mh).get(t);if((null===(s=u)||void 0===s?void 0:s.key)===l)return u.url;u?(null===(o=u.filter)||void 0===o||o.remove(),u.key=l,u.url="none",u.filter=null):(u={key:l,url:"none",filter:null},p(ph,this,mh).set(t,u));if(!e||!n)return u.url;var h=D([e,n].map(r(ph,this,Ch).bind(this)),2),c=h[0],f=h[1],v=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),g=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),y=D([i,a].map(r(ph,this,Ch).bind(this)),2),m=y[0],w=y[1];if(g<v){var b=[g,v,w,m];v=b[0],g=b[1],m=b[2],w=b[3]}p(ph,this,wh).style.color="";var k=function(t,e,n){for(var i=new Array(256),r=(g-v)/n,a=t/255,s=(e-t)/(255*n),o=0,l=0;l<=n;l++){for(var u=Math.round(v+l*r),h=a+l*s,c=o;c<=u;c++)i[c]=h;o=u+1}for(var d=o;d<256;d++)i[d]=i[o-1];return i.join(",")},A="g_".concat(d(ch,this),"_hcm_").concat(t,"_filter"),_=u.filter=r(ph,this,xh).call(this,A);return r(ph,this,_h).call(this,_),r(ph,this,Eh).call(this,k(m[0],w[0],5),k(m[1],w[1],5),k(m[2],w[2],5),_),u.url=r(ph,this,kh).call(this,A),u.url}},{key:"destroy",value:function(){var t,e,n,i;arguments.length>0&&arguments[0]!==undefined&&arguments[0]&&null!==(t=d(fh,this))&&void 0!==t&&t.size||(null===(e=d(hh,this))||void 0===e||e.parentNode.parentNode.remove(),v(hh,this,null),null===(n=d(uh,this))||void 0===n||n.clear(),v(uh,this,null),null===(i=d(fh,this))||void 0===i||i.clear(),v(fh,this,null),v(vh,this,0))}}])}(oh);function yh(t){return d(uh,t)||v(uh,t,new Map)}function mh(t){return d(fh,t)||v(fh,t,new Map)}function wh(t){if(!d(hh,t)){var e=d(dh,t).createElement("div"),n=e.style;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;var i=d(dh,t).createElementNS(ia,"svg");i.setAttribute("width",0),i.setAttribute("height",0),v(hh,t,d(dh,t).createElementNS(ia,"defs")),e.append(i),i.append(d(hh,t)),d(dh,t).body.append(e)}return d(hh,t)}function bh(t){if(1===t.length){for(var e=t[0],n=new Array(256),i=0;i<256;i++)n[i]=e[i]/255;var r=n.join(",");return[r,r,r]}for(var a=D(t,3),s=a[0],o=a[1],l=a[2],u=new Array(256),h=new Array(256),c=new Array(256),d=0;d<256;d++)u[d]=s[d]/255,h[d]=o[d]/255,c[d]=l[d]/255;return[u.join(","),h.join(","),c.join(",")]}function kh(t){if(d(lh,this)===undefined){v(lh,this,"");var e=d(dh,this).URL;e!==d(dh,this).baseURI&&(ua(e)?Rr('#createUrl: ignore "data:"-URL for performance reasons.'):v(lh,this,Lr(e,"")))}return"url(".concat(d(lh,this),"#").concat(t,")")}function Ah(t){var e=d(dh,this).createElementNS(ia,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}function _h(t){var e=d(dh,this).createElementNS(ia,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}function xh(t){var e=d(dh,this).createElementNS(ia,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),p(ph,this,wh).append(e),e}function Sh(t,e,n){var i=d(dh,this).createElementNS(ia,e);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),t.append(i)}function Eh(t,e,n,i){var a=d(dh,this).createElementNS(ia,"feComponentTransfer");i.append(a),r(ph,this,Sh).call(this,a,"feFuncR",t),r(ph,this,Sh).call(this,a,"feFuncG",e),r(ph,this,Sh).call(this,a,"feFuncB",n)}function Mh(t,e){var n=d(dh,this).createElementNS(ia,"feComponentTransfer");e.append(n),r(ph,this,Sh).call(this,n,"feFuncA",t)}function Ch(t){return p(ph,this,wh).style.color=t,ba(getComputedStyle(p(ph,this,wh)).getPropertyValue("color"))}var Th=function(){return m((function n(t){var e=t.baseUrl,i=void 0===e?null:e;c(this,n),this.baseUrl=i}),[{key:"fetch",value:(e=l(T().m((function i(t){var e,n;return T().w((function(i){for(;;)switch(i.n){case 0:if(e=t.filename,this.baseUrl){i.n=1;break}throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");case 1:if(e){i.n=2;break}throw new Error("Font filename must be specified.");case 2:return n="".concat(this.baseUrl).concat(e),i.a(2,this._fetch(n)["catch"]((function(t){throw new Error("Unable to load font data at: ".concat(n))})))}}),i,this)}))),function(t){return e.apply(this,arguments)})},{key:"_fetch",value:(t=l(T().m((function r(t){return T().w((function(t){for(;;)switch(t.n){case 0:Pr("Abstract method `_fetch` called.");case 1:return t.a(2)}}),r)}))),function(e){return t.apply(this,arguments)})}]);var t,e}(),Rh=function(t){function e(){return c(this,e),u(this,e,arguments)}return _(e,t),m(e,[{key:"_fetch",value:(n=l(T().m((function i(t){var e;return T().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,aa(t,"arraybuffer");case 1:return e=n.v,n.a(2,new Uint8Array(e))}}),i)}))),function(t){return n.apply(this,arguments)})}]);var n}(Th),Ph=function(){return m((function n(t){var e=t.baseUrl,i=void 0===e?null:e;c(this,n),this.baseUrl=i}),[{key:"fetch",value:(e=l(T().m((function i(t){var e,n;return T().w((function(i){for(;;)switch(i.n){case 0:if(e=t.filename,this.baseUrl){i.n=1;break}throw new Error("Ensure that the `wasmUrl` API parameter is provided.");case 1:if(e){i.n=2;break}throw new Error("Wasm filename must be specified.");case 2:return n="".concat(this.baseUrl).concat(e),i.a(2,this._fetch(n)["catch"]((function(t){throw new Error("Unable to load wasm data at: ".concat(n))})))}}),i,this)}))),function(t){return e.apply(this,arguments)})},{key:"_fetch",value:(t=l(T().m((function r(t){return T().w((function(t){for(;;)switch(t.n){case 0:Pr("Abstract method `_fetch` called.");case 1:return t.a(2)}}),r)}))),function(e){return t.apply(this,arguments)})}]);var t,e}(),Ih=function(t){function e(){return c(this,e),u(this,e,arguments)}return _(e,t),m(e,[{key:"_fetch",value:(n=l(T().m((function i(t){var e;return T().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,aa(t,"arraybuffer");case 1:return e=n.v,n.a(2,new Uint8Array(e))}}),i)}))),function(t){return n.apply(this,arguments)})}]);var n}(Ph);if(Gi){var Dh,Lh,Oh,Fh,Nh;try{var Wh=process.getBuiltinModule("module").createRequire("undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:e&&"SCRIPT"===e.tagName.toUpperCase()&&e.src||new URL("pdf.js",document.baseURI).href);try{Lh=Wh("@napi-rs/canvas")}catch(wb){Rr('Cannot load "@napi-rs/canvas" package: "'.concat(wb,'".'))}}catch(wb){Rr('Cannot access the `require` function: "'.concat(wb,'".'))}if(!globalThis.DOMMatrix)null!==(Oh=Lh)&&void 0!==Oh&&Oh.DOMMatrix?globalThis.DOMMatrix=Lh.DOMMatrix:Rr("Cannot polyfill `DOMMatrix`, rendering may be broken.");if(!globalThis.ImageData)null!==(Fh=Lh)&&void 0!==Fh&&Fh.ImageData?globalThis.ImageData=Lh.ImageData:Rr("Cannot polyfill `ImageData`, rendering may be broken.");if(!globalThis.Path2D)null!==(Nh=Lh)&&void 0!==Nh&&Nh.Path2D?globalThis.Path2D=Lh.Path2D:Rr("Cannot polyfill `Path2D`, rendering may be broken.");null!==(Dh=globalThis.navigator)&&void 0!==Dh&&Dh.language||(globalThis.navigator={language:"en-US",platform:"",userAgent:""})}function Bh(t){return jh.apply(this,arguments)}function jh(){return(jh=l(T().m((function t(e){var n,i;return T().w((function(t){for(;;)switch(t.n){case 0:return n=process.getBuiltinModule("fs"),t.n=1,n.promises.readFile(e);case 1:return i=t.v,t.a(2,new Uint8Array(i))}}),t)})))).apply(this,arguments)}var Hh=function(t){function e(){return c(this,e),u(this,e,arguments)}return _(e,t),m(e)}(oh),Uh=function(t){function n(){return c(this,n),u(this,n,arguments)}return _(n,t),m(n,[{key:"_createCanvas",value:function(t,n){return process.getBuiltinModule("module").createRequire("undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:e&&"SCRIPT"===e.tagName.toUpperCase()&&e.src||new URL("pdf.js",document.baseURI).href)("@napi-rs/canvas").createCanvas(t,n)}}])}(ih),zh=function(t){function e(){return c(this,e),u(this,e,arguments)}return _(e,t),m(e,[{key:"_fetch",value:(n=l(T().m((function i(t){return T().w((function(e){for(;;)if(0===e.n)return e.a(2,Bh(t))}),i)}))),function(t){return n.apply(this,arguments)})}]);var n}(ah),Gh=function(t){function e(){return c(this,e),u(this,e,arguments)}return _(e,t),m(e,[{key:"_fetch",value:(n=l(T().m((function i(t){return T().w((function(e){for(;;)if(0===e.n)return e.a(2,Bh(t))}),i)}))),function(t){return n.apply(this,arguments)})}]);var n}(Th),Vh=function(t){function e(){return c(this,e),u(this,e,arguments)}return _(e,t),m(e,[{key:"_fetch",value:(n=l(T().m((function i(t){return T().w((function(e){for(;;)if(0===e.n)return e.a(2,Bh(t))}),i)}))),function(t){return n.apply(this,arguments)})}]);var n}(Ph),qh="Fill",Xh="Stroke",Yh="Shading";function Kh(t,e){if(e){var n=e[2]-e[0],i=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],n,i),t.clip(r)}}var Qh=function(){return m((function t(){c(this,t)}),[{key:"isModifyingCurrentTransform",value:function(){return!1}},{key:"getPattern",value:function(){Pr("Abstract method `getPattern` called.")}}])}(),Jh=function(t){function e(t){var n;return c(this,e),(n=u(this,e))._type=t[1],n._bbox=t[2],n._colorStops=t[3],n._p0=t[4],n._p1=t[5],n._r0=t[6],n._r1=t[7],n.matrix=null,n}return _(e,t),m(e,[{key:"_createGradient",value:function(t){var e;"axial"===this._type?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));var n,i=w(this._colorStops);try{for(i.s();!(n=i.n()).done;){var r=n.value;e.addColorStop(r[0],r[1])}}catch(a){i.e(a)}finally{i.f()}return e}},{key:"getPattern",value:function(t,e,n,i){var r;if(i===Xh||i===qh){var a=e.current.getClippedPathBoundingBox(i,ka(t))||[0,0,0,0],s=Math.ceil(a[2]-a[0])||1,o=Math.ceil(a[3]-a[1])||1,l=e.cachedCanvases.getCanvas("pattern",s,o),u=l.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-a[0],-a[1]),n=Xr.transform(n,[1,0,0,1,a[0],a[1]]),u.transform.apply(u,F(e.baseTransform)),this.matrix&&u.transform.apply(u,F(this.matrix)),Kh(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),r=t.createPattern(l.canvas,"no-repeat");var h=new DOMMatrix(n);r.setTransform(h)}else Kh(t,this._bbox),r=this._createGradient(t);return r}}])}(Qh);function Zh(t,e,n,i,r,a,s,o){var l,u=e.coords,h=e.colors,c=t.data,d=4*t.width;u[n+1]>u[i+1]&&(l=n,n=i,i=l,l=a,a=s,s=l),u[i+1]>u[r+1]&&(l=i,i=r,r=l,l=s,s=o,o=l),u[n+1]>u[i+1]&&(l=n,n=i,i=l,l=a,a=s,s=l);var f=(u[n]+e.offsetX)*e.scaleX,v=(u[n+1]+e.offsetY)*e.scaleY,p=(u[i]+e.offsetX)*e.scaleX,g=(u[i+1]+e.offsetY)*e.scaleY,y=(u[r]+e.offsetX)*e.scaleX,m=(u[r+1]+e.offsetY)*e.scaleY;if(!(v>=m))for(var w,b,k,A,_,x,S,E,M=h[a],C=h[a+1],T=h[a+2],R=h[s],P=h[s+1],I=h[s+2],D=h[o],L=h[o+1],O=h[o+2],F=Math.round(v),N=Math.round(m),W=F;W<=N;W++){if(W<g){var B=W<v?0:(v-W)/(v-g);w=f-(f-p)*B,b=M-(M-R)*B,k=C-(C-P)*B,A=T-(T-I)*B}else{var j=void 0;w=p-(p-y)*(j=W>m?1:g===m?0:(g-W)/(g-m)),b=R-(R-D)*j,k=P-(P-L)*j,A=I-(I-O)*j}var H=void 0;_=f-(f-y)*(H=W<v?0:W>m?1:(v-W)/(v-m)),x=M-(M-D)*H,S=C-(C-L)*H,E=T-(T-O)*H;for(var U=Math.round(Math.min(w,_)),z=Math.round(Math.max(w,_)),G=d*W+4*U,V=U;V<=z;V++)(H=(w-V)/(w-_))<0?H=0:H>1&&(H=1),c[G++]=b-(b-x)*H|0,c[G++]=k-(k-S)*H|0,c[G++]=A-(A-E)*H|0,c[G++]=255}}function $h(t,e,n){var i,r,a=e.coords,s=e.colors;switch(e.type){case"lattice":var o=e.verticesPerRow,l=Math.floor(a.length/o)-1,u=o-1;for(i=0;i<l;i++)for(var h=i*o,c=0;c<u;c++,h++)Zh(t,n,a[h],a[h+1],a[h+o],s[h],s[h+1],s[h+o]),Zh(t,n,a[h+o+1],a[h+1],a[h+o],s[h+o+1],s[h+1],s[h+o]);break;case"triangles":for(i=0,r=a.length;i<r;i+=3)Zh(t,n,a[i],a[i+1],a[i+2],s[i],s[i+1],s[i+2]);break;default:throw new Error("illegal figure")}}var tc=function(t){function e(t){var n;return c(this,e),(n=u(this,e))._coords=t[2],n._colors=t[3],n._figures=t[4],n._bounds=t[5],n._bbox=t[6],n._background=t[7],n.matrix=null,n}return _(e,t),m(e,[{key:"_createMeshCanvas",value:function(t,e,n){var i=Math.floor(this._bounds[0]),r=Math.floor(this._bounds[1]),a=Math.ceil(this._bounds[2])-i,s=Math.ceil(this._bounds[3])-r,o=Math.min(Math.ceil(Math.abs(a*t[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(s*t[1]*1.1)),3e3),u=a/o,h=s/l,c={coords:this._coords,colors:this._colors,offsetX:-i,offsetY:-r,scaleX:1/u,scaleY:1/h},d=o+4,f=l+4,v=n.getCanvas("mesh",d,f),p=v.context,g=p.createImageData(o,l);if(e)for(var y=g.data,m=0,b=y.length;m<b;m+=4)y[m]=e[0],y[m+1]=e[1],y[m+2]=e[2],y[m+3]=255;var k,A=w(this._figures);try{for(A.s();!(k=A.n()).done;){$h(g,k.value,c)}}catch(_){A.e(_)}finally{A.f()}return p.putImageData(g,2,2),{canvas:v.canvas,offsetX:i-2*u,offsetY:r-2*h,scaleX:u,scaleY:h}}},{key:"isModifyingCurrentTransform",value:function(){return!0}},{key:"getPattern",value:function(t,e,n,i){Kh(t,this._bbox);var r=new Float32Array(2);if(i===Yh)Xr.singularValueDecompose2dScale(ka(t),r);else if(this.matrix){Xr.singularValueDecompose2dScale(this.matrix,r);var a=D(r,2),s=a[0],o=a[1];Xr.singularValueDecompose2dScale(e.baseTransform,r),r[0]*=s,r[1]*=o}else Xr.singularValueDecompose2dScale(e.baseTransform,r);var l=this._createMeshCanvas(r,i===Yh?null:this._background,e.cachedCanvases);return i!==Yh&&(t.setTransform.apply(t,F(e.baseTransform)),this.matrix&&t.transform.apply(t,F(this.matrix))),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}])}(Qh),ec=function(t){function e(){return c(this,e),u(this,e,arguments)}return _(e,t),m(e,[{key:"getPattern",value:function(){return"hotpink"}}])}(Qh);var nc=1,ic=2,rc=function(){function t(e,n,i,r){c(this,t),this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=n,this.canvasGraphicsFactory=i,this.baseTransform=r}return m(t,[{key:"createPatternCanvas",value:function(t){var e=this.bbox,n=this.operatorList,i=this.paintType,r=this.tilingType,a=this.color,s=this.canvasGraphicsFactory,o=this.xstep,l=this.ystep;o=Math.abs(o),l=Math.abs(l),Tr("TilingType: "+r);var u=e[0],h=e[1],c=e[2],d=e[3],f=c-u,v=d-h,p=new Float32Array(2);Xr.singularValueDecompose2dScale(this.matrix,p);var g=D(p,2),y=g[0],m=g[1];Xr.singularValueDecompose2dScale(this.baseTransform,p);var w=y*p[0],b=m*p[1],k=f,A=v,_=!1,x=!1,S=Math.ceil(o*w),E=Math.ceil(l*b);S>=Math.ceil(f*w)?k=o:_=!0,E>=Math.ceil(v*b)?A=l:x=!0;var M=this.getSizeAndScale(k,this.ctx.canvas.width,w),C=this.getSizeAndScale(A,this.ctx.canvas.height,b),T=t.cachedCanvases.getCanvas("pattern",M.size,C.size),R=T.context,P=s.createCanvasGraphics(R);if(P.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(P,i,a),R.translate(-M.scale*u,-C.scale*h),P.transform(M.scale,0,0,C.scale,0,0),R.save(),this.clipBbox(P,u,h,c,d),P.baseTransform=ka(P.ctx),P.executeOperatorList(n),P.endDrawing(),R.restore(),_||x){var I=T.canvas;_&&(k=o),x&&(A=l);for(var L=this.getSizeAndScale(k,this.ctx.canvas.width,w),O=this.getSizeAndScale(A,this.ctx.canvas.height,b),F=L.size,N=O.size,W=t.cachedCanvases.getCanvas("pattern-workaround",F,N),B=W.context,j=_?Math.floor(f/o):0,H=x?Math.floor(v/l):0,U=0;U<=j;U++)for(var z=0;z<=H;z++)B.drawImage(I,F*U,N*z,F,N,0,0,F,N);return{canvas:W.canvas,scaleX:L.scale,scaleY:O.scale,offsetX:u,offsetY:h}}return{canvas:T.canvas,scaleX:M.scale,scaleY:C.scale,offsetX:u,offsetY:h}}},{key:"getSizeAndScale",value:function(e,n,i){var r=Math.max(t.MAX_PATTERN_SIZE,n),a=Math.ceil(e*i);return a>=r?a=r:i=a/e,{scale:i,size:a}}},{key:"clipBbox",value:function(t,e,n,i,r){var a=i-e,s=r-n;t.ctx.rect(e,n,a,s),Xr.axialAlignedBoundingBox([e,n,i,r],ka(t.ctx),t.current.minMax),t.clip(),t.endPath()}},{key:"setFillAndStrokeStyleToContext",value:function(t,e,n){var i=t.ctx,r=t.current;switch(e){case nc:var a=this.ctx,s=a.fillStyle,o=a.strokeStyle;i.fillStyle=r.fillColor=s,i.strokeStyle=r.strokeColor=o;break;case ic:i.fillStyle=i.strokeStyle=n,r.fillColor=r.strokeColor=n;break;default:throw new Hr("Unsupported paint type: ".concat(e))}}},{key:"isModifyingCurrentTransform",value:function(){return!1}},{key:"getPattern",value:function(t,e,n,i){var r=n;i!==Yh&&(r=Xr.transform(r,e.baseTransform),this.matrix&&(r=Xr.transform(r,this.matrix)));var a=this.createPatternCanvas(e),s=new DOMMatrix(r);s=(s=s.translate(a.offsetX,a.offsetY)).scale(1/a.scaleX,1/a.scaleY);var o=t.createPattern(a.canvas,"repeat");return o.setTransform(s),o}}])}();function ac(t){var e=t.src,n=t.srcPos,i=void 0===n?0:n,r=t.dest,a=t.width,s=t.height,o=t.nonBlackColor,l=void 0===o?4294967295:o,u=t.inverseDecode,h=void 0!==u&&u,c=Vr.isLittleEndian?4278190080:255,d=D(h?[l,c]:[c,l],2),f=d[0],v=d[1],p=a>>3,g=7&a,y=e.length;r=new Uint32Array(r.buffer);for(var m=0,w=0;w<s;w++){for(var b=i+p;i<b;i++){var k=i<y?e[i]:255;r[m++]=128&k?v:f,r[m++]=64&k?v:f,r[m++]=32&k?v:f,r[m++]=16&k?v:f,r[m++]=8&k?v:f,r[m++]=4&k?v:f,r[m++]=2&k?v:f,r[m++]=1&k?v:f}if(0!==g)for(var A=i<y?e[i++]:255,_=0;_<g;_++)r[m++]=A&1<<7-_?v:f}return{srcPos:i,destPos:m}}b(rc,"MAX_PATTERN_SIZE",3e3);var sc=16,oc=new DOMMatrix,lc=new Float32Array(2),uc=new Float32Array([Infinity,Infinity,-Infinity,-Infinity]);var hc=function(){return m((function t(e){c(this,t),this.canvasFactory=e,this.cache=Object.create(null)}),[{key:"getCanvas",value:function(t,e,n){var i;return this.cache[t]!==undefined?(i=this.cache[t],this.canvasFactory.reset(i,e,n)):(i=this.canvasFactory.create(e,n),this.cache[t]=i),i}},{key:"delete",value:function(t){delete this.cache[t]}},{key:"clear",value:function(){for(var t in this.cache){var e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}])}();function cc(t,e,n,i,r,a,s,o,l,u){var h=D(ka(t),6),c=h[0],d=h[1],f=h[2],v=h[3],p=h[4],g=h[5];if(0===d&&0===f){var y=s*c+p,m=Math.round(y),w=o*v+g,b=Math.round(w),k=(s+l)*c+p,A=Math.abs(Math.round(k)-m)||1,_=(o+u)*v+g,x=Math.abs(Math.round(_)-b)||1;return t.setTransform(Math.sign(c),0,0,Math.sign(v),m,b),t.drawImage(e,n,i,r,a,0,0,A,x),t.setTransform(c,d,f,v,p,g),[A,x]}if(0===c&&0===v){var S=o*f+p,E=Math.round(S),M=s*d+g,C=Math.round(M),T=(o+u)*f+p,R=Math.abs(Math.round(T)-E)||1,P=(s+l)*d+g,I=Math.abs(Math.round(P)-C)||1;return t.setTransform(0,Math.sign(d),Math.sign(f),0,E,C),t.drawImage(e,n,i,r,a,0,0,I,R),t.setTransform(c,d,f,v,p,g),[I,R]}return t.drawImage(e,n,i,r,a,s,o,l,u),[Math.hypot(c,d)*l,Math.hypot(f,v)*u]}var dc=function(){return m((function t(e,n){c(this,t),b(this,"alphaIsShape",!1),b(this,"fontSize",0),b(this,"fontSizeScale",1),b(this,"textMatrix",null),b(this,"textMatrixScale",1),b(this,"fontMatrix",Vi),b(this,"leading",0),b(this,"x",0),b(this,"y",0),b(this,"lineX",0),b(this,"lineY",0),b(this,"charSpacing",0),b(this,"wordSpacing",0),b(this,"textHScale",1),b(this,"textRenderingMode",sr),b(this,"textRise",0),b(this,"fillColor","#000000"),b(this,"strokeColor","#000000"),b(this,"patternFill",!1),b(this,"patternStroke",!1),b(this,"fillAlpha",1),b(this,"strokeAlpha",1),b(this,"lineWidth",1),b(this,"activeSMask",null),b(this,"transferMaps","none"),this.clipBox=new Float32Array([0,0,e,n]),this.minMax=uc.slice()}),[{key:"clone",value:function(){var t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}},{key:"getPathBoundingBox",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:qh,e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null,n=this.minMax.slice();if(t===Xh){e||Pr("Stroke bounding box must include transform."),Xr.singularValueDecompose2dScale(e,lc);var i=lc[0]*this.lineWidth/2,r=lc[1]*this.lineWidth/2;n[0]-=i,n[1]-=r,n[2]+=i,n[3]+=r}return n}},{key:"updateClipFromPath",value:function(){var t=Xr.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}},{key:"isEmptyClip",value:function(){return this.minMax[0]===Infinity}},{key:"startNewPathAndClipBox",value:function(t){this.clipBox.set(t,0),this.minMax.set(uc,0)}},{key:"getClippedPathBoundingBox",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:qh,e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return Xr.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}])}();function fc(t,e){if(e instanceof ImageData)t.putImageData(e,0,0);else{var n,i,r,a,s,o=e.height,l=e.width,u=o%sc,h=(o-u)/sc,c=0===u?h:h+1,d=t.createImageData(l,sc),f=0,v=e.data,p=d.data;if(e.kind===dr.GRAYSCALE_1BPP){var g=v.byteLength,y=new Uint32Array(p.buffer,0,p.byteLength>>2),m=y.length,w=l+7>>3,b=4294967295,k=Vr.isLittleEndian?4278190080:255;for(i=0;i<c;i++){for(a=i<h?sc:u,n=0,r=0;r<a;r++){for(var A=g-f,_=0,x=A>w?l:8*A-7,S=-8&x,E=0,M=0;_<S;_+=8)M=v[f++],y[n++]=128&M?b:k,y[n++]=64&M?b:k,y[n++]=32&M?b:k,y[n++]=16&M?b:k,y[n++]=8&M?b:k,y[n++]=4&M?b:k,y[n++]=2&M?b:k,y[n++]=1&M?b:k;for(;_<x;_++)0===E&&(M=v[f++],E=128),y[n++]=M&E?b:k,E>>=1}for(;n<m;)y[n++]=0;t.putImageData(d,0,i*sc)}}else if(e.kind===dr.RGBA_32BPP){for(r=0,s=l*sc*4,i=0;i<h;i++)p.set(v.subarray(f,f+s)),f+=s,t.putImageData(d,0,r),r+=sc;i<c&&(s=l*u*4,p.set(v.subarray(f,f+s)),t.putImageData(d,0,r))}else{if(e.kind!==dr.RGB_24BPP)throw new Error("bad image kind: ".concat(e.kind));for(s=l*(a=sc),i=0;i<c;i++){for(i>=h&&(s=l*(a=u)),n=0,r=s;r--;)p[n++]=v[f++],p[n++]=v[f++],p[n++]=v[f++],p[n++]=255;t.putImageData(d,0,i*sc)}}}}function vc(t,e){if(e.bitmap)t.drawImage(e.bitmap,0,0);else for(var n=e.height,i=e.width,r=n%sc,a=(n-r)/sc,s=0===r?a:a+1,o=t.createImageData(i,sc),l=0,u=e.data,h=o.data,c=0;c<s;c++){l=ac({src:u,srcPos:l,dest:h,width:i,height:c<a?sc:r,nonBlackColor:0}).srcPos,t.putImageData(o,0,c*sc)}}function pc(t,e){for(var n=0,i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];n<i.length;n++){var r=i[n];t[r]!==undefined&&(e[r]=t[r])}t.setLineDash!==undefined&&(e.setLineDash(t.getLineDash()),e.lineDashOffset=t.lineDashOffset)}function gc(t){t.strokeStyle=t.fillStyle="#000000",t.fillRule="nonzero",t.globalAlpha=1,t.lineWidth=1,t.lineCap="butt",t.lineJoin="miter",t.miterLimit=10,t.globalCompositeOperation="source-over",t.font="10px sans-serif",t.setLineDash!==undefined&&(t.setLineDash([]),t.lineDashOffset=0);var e=t.filter;"none"!==e&&""!==e&&(t.filter="none")}function yc(t,e){if(e)return!0;Xr.singularValueDecompose2dScale(t,lc);var n=Math.fround(xa.pixelRatio*ra.PDF_TO_CSS_UNITS);return lc[0]<=n&&lc[1]<=n}var mc=["butt","round","square"],wc=["miter","round","bevel"],bc={},kc={},Ac=new WeakSet,_c=function(){function t(e,n,i,r,a,s,o,l){var u=s.optionalContentConfig,h=s.markedContentStack,d=void 0===h?null:h;c(this,t),g(this,Ac),this.ctx=e,this.current=new dc(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=n,this.objs=i,this.canvasFactory=r,this.filterFactory=a,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=d||[],this.optionalContentConfig=u,this.cachedCanvases=new hc(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=o,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=l,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}return m(t,[{key:"getObject",value:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return"string"==typeof t?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}},{key:"beginDrawing",value:function(t){var e,n,i=t.transform,r=t.viewport,a=t.transparency,s=void 0!==a&&a,o=t.background,l=void 0===o?null:o,u=this.ctx.canvas.width,h=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=l||"#ffffff",this.ctx.fillRect(0,0,u,h),this.ctx.fillStyle=c,s){var d,f=this.cachedCanvases.getCanvas("transparent",u,h);this.compositeCtx=this.ctx,this.transparentCanvas=f.canvas,this.ctx=f.context,this.ctx.save(),(d=this.ctx).transform.apply(d,F(ka(this.compositeCtx)))}(this.ctx.save(),gc(this.ctx),i)&&((n=this.ctx).transform.apply(n,F(i)),this.outputScaleX=i[0],this.outputScaleY=i[0]);(e=this.ctx).transform.apply(e,F(r.transform)),this.viewportScale=r.scale,this.baseTransform=ka(this.ctx)}},{key:"executeOperatorList",value:function(t,e,n,i){var r=t.argsArray,a=t.fnArray,s=e||0,o=r.length;if(o===s)return s;for(var l,u=o-s>10&&"function"==typeof n,h=u?Date.now()+15:0,c=0,d=this.commonObjs,f=this.objs;;){if(i!==undefined&&s===i.nextBreakPoint)return i.breakIt(s,n),s;if((l=a[s])!==br.dependency)this[l].apply(this,r[s]);else{var v,p=w(r[s]);try{for(p.s();!(v=p.n()).done;){var g=v.value,y=g.startsWith("g_")?d:f;if(!y.has(g))return y.get(g,n),s}}catch(m){p.e(m)}finally{p.f()}}if(++s===o)return s;if(u&&++c>10){if(Date.now()>h)return n(),s;c=0}}}},{key:"endDrawing",value:function(){r(Ac,this,xc).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();var t,e=w(this._cachedBitmapsMap.values());try{for(e.s();!(t=e.n()).done;){var n,i=t.value,a=w(i.values());try{for(a.s();!(n=a.n()).done;){var s=n.value;"undefined"!=typeof HTMLCanvasElement&&s instanceof HTMLCanvasElement&&(s.width=s.height=0)}}catch(o){a.e(o)}finally{a.f()}i.clear()}}catch(o){e.e(o)}finally{e.f()}this._cachedBitmapsMap.clear(),r(Ac,this,Sc).call(this)}},{key:"_scaleImage",value:function(t,e){for(var n,i,r,a,s=null!==(n=t.width)&&void 0!==n?n:t.displayWidth,o=null!==(i=t.height)&&void 0!==i?i:t.displayHeight,l=Math.max(Math.hypot(e[0],e[1]),1),u=Math.max(Math.hypot(e[2],e[3]),1),h=s,c=o,d="prescale1";l>2&&h>1||u>2&&c>1;){var f=h,v=c;l>2&&h>1&&(l/=h/(f=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h/2))),u>2&&c>1&&(u/=c/(v=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2)),(a=(r=this.cachedCanvases.getCanvas(d,f,v)).context).clearRect(0,0,f,v),a.drawImage(t,0,0,h,c,0,0,f,v),t=r.canvas,h=f,c=v,d="prescale1"===d?"prescale2":"prescale1"}return{img:t,paintWidth:h,paintHeight:c}}},{key:"_createMaskCanvas",value:function(t){var e,n,i,r,a=this.ctx,s=t.width,o=t.height,l=this.current.fillColor,u=this.current.patternFill,h=ka(a);if((t.bitmap||t.data)&&t.count>1){var c=t.bitmap||t.data.buffer;n=JSON.stringify(u?h:[h.slice(0,4),l]),(e=this._cachedBitmapsMap.get(c))||(e=new Map,this._cachedBitmapsMap.set(c,e));var d=e.get(n);if(d&&!u)return{canvas:d,offsetX:Math.round(Math.min(h[0],h[2])+h[4]),offsetY:Math.round(Math.min(h[1],h[3])+h[5])};i=d}i||vc((r=this.cachedCanvases.getCanvas("maskCanvas",s,o)).context,t);var f=Xr.transform(h,[1/s,0,0,-1/o,0,0]);f=Xr.transform(f,[1,0,0,1,0,-o]);var v=uc.slice();Xr.axialAlignedBoundingBox([0,0,s,o],f,v);var p=D(v,4),g=p[0],y=p[1],m=p[2],w=p[3],b=Math.round(m-g)||1,k=Math.round(w-y)||1,A=this.cachedCanvases.getCanvas("fillCanvas",b,k),_=A.context,x=g,S=y;_.translate(-x,-S),_.transform.apply(_,F(f)),i||(i=(i=this._scaleImage(r.canvas,Aa(_))).img,e&&u&&e.set(n,i)),_.imageSmoothingEnabled=yc(ka(_),t.interpolate),cc(_,i,0,0,i.width,i.height,0,0,s,o),_.globalCompositeOperation="source-in";var E=Xr.transform(Aa(_),[1,0,0,1,-x,-S]);return _.fillStyle=u?l.getPattern(a,this,E,qh):l,_.fillRect(0,0,s,o),e&&!u&&(this.cachedCanvases["delete"]("fillCanvas"),e.set(n,A.canvas)),{canvas:A.canvas,offsetX:Math.round(x),offsetY:Math.round(S)}}},{key:"setLineWidth",value:function(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}},{key:"setLineCap",value:function(t){this.ctx.lineCap=mc[t]}},{key:"setLineJoin",value:function(t){this.ctx.lineJoin=wc[t]}},{key:"setMiterLimit",value:function(t){this.ctx.miterLimit=t}},{key:"setDash",value:function(t,e){var n=this.ctx;n.setLineDash!==undefined&&(n.setLineDash(t),n.lineDashOffset=e)}},{key:"setRenderingIntent",value:function(t){}},{key:"setFlatness",value:function(t){}},{key:"setGState",value:function(t){var e,n=w(t);try{for(n.s();!(e=n.n()).done;){var i=D(e.value,2),r=i[0],a=i[1];switch(r){case"LW":this.setLineWidth(a);break;case"LC":this.setLineCap(a);break;case"LJ":this.setLineJoin(a);break;case"ML":this.setMiterLimit(a);break;case"D":this.setDash(a[0],a[1]);break;case"RI":this.setRenderingIntent(a);break;case"FL":this.setFlatness(a);break;case"Font":this.setFont(a[0],a[1]);break;case"CA":this.current.strokeAlpha=a;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=a;break;case"BM":this.ctx.globalCompositeOperation=a;break;case"SMask":this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a)}}}catch(s){n.e(s)}finally{n.f()}}},{key:"inSMaskMode",get:function(){return!!this.suspendedCtx}},{key:"checkSMaskState",value:function(){var t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}},{key:"beginSMaskMode",value:function(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");var t=this.ctx.canvas.width,e=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,t,e);this.suspendedCtx=this.ctx;var r=this.ctx=i.context;r.setTransform(this.suspendedCtx.getTransform()),pc(this.suspendedCtx,r),function(t,e){if(t._removeMirroring)throw new Error("Context is already forwarding operations.");t.__originalSave=t.save,t.__originalRestore=t.restore,t.__originalRotate=t.rotate,t.__originalScale=t.scale,t.__originalTranslate=t.translate,t.__originalTransform=t.transform,t.__originalSetTransform=t.setTransform,t.__originalResetTransform=t.resetTransform,t.__originalClip=t.clip,t.__originalMoveTo=t.moveTo,t.__originalLineTo=t.lineTo,t.__originalBezierCurveTo=t.bezierCurveTo,t.__originalRect=t.rect,t.__originalClosePath=t.closePath,t.__originalBeginPath=t.beginPath,t._removeMirroring=function(){t.save=t.__originalSave,t.restore=t.__originalRestore,t.rotate=t.__originalRotate,t.scale=t.__originalScale,t.translate=t.__originalTranslate,t.transform=t.__originalTransform,t.setTransform=t.__originalSetTransform,t.resetTransform=t.__originalResetTransform,t.clip=t.__originalClip,t.moveTo=t.__originalMoveTo,t.lineTo=t.__originalLineTo,t.bezierCurveTo=t.__originalBezierCurveTo,t.rect=t.__originalRect,t.closePath=t.__originalClosePath,t.beginPath=t.__originalBeginPath,delete t._removeMirroring},t.save=function(){e.save(),this.__originalSave()},t.restore=function(){e.restore(),this.__originalRestore()},t.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},t.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},t.transform=function(t,n,i,r,a,s){e.transform(t,n,i,r,a,s),this.__originalTransform(t,n,i,r,a,s)},t.setTransform=function(t,n,i,r,a,s){e.setTransform(t,n,i,r,a,s),this.__originalSetTransform(t,n,i,r,a,s)},t.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},t.rotate=function(t){e.rotate(t),this.__originalRotate(t)},t.clip=function(t){e.clip(t),this.__originalClip(t)},t.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},t.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},t.bezierCurveTo=function(t,n,i,r,a,s){e.bezierCurveTo(t,n,i,r,a,s),this.__originalBezierCurveTo(t,n,i,r,a,s)},t.rect=function(t,n,i,r){e.rect(t,n,i,r),this.__originalRect(t,n,i,r)},t.closePath=function(){e.closePath(),this.__originalClosePath()},t.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}(r,this.suspendedCtx),this.setGState([["BM","source-over"]])}},{key:"endSMaskMode",value:function(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),pc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}},{key:"compose",value:function(t){if(this.current.activeSMask){t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];var e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}}},{key:"composeSMask",value:function(t,e,n,i){var r=i[0],a=i[1],s=i[2]-r,o=i[3]-a;0!==s&&0!==o&&(this.genericComposeSMask(e.context,n,s,o,e.subtype,e.backdrop,e.transferMap,r,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}},{key:"genericComposeSMask",value:function(t,e,n,i,r,a,s,o,l,u,h){var c=t.canvas,d=o-u,f=l-h;if(a)if(d<0||f<0||d+n>c.width||f+i>c.height){var v=this.cachedCanvases.getCanvas("maskExtension",n,i),p=v.context;p.drawImage(c,-d,-f),p.globalCompositeOperation="destination-atop",p.fillStyle=a,p.fillRect(0,0,n,i),p.globalCompositeOperation="source-over",c=v.canvas,d=f=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);var g=new Path2D;g.rect(d,f,n,i),t.clip(g),t.globalCompositeOperation="destination-atop",t.fillStyle=a,t.fillRect(d,f,n,i),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),"Alpha"===r&&s?e.filter=this.filterFactory.addAlphaFilter(s):"Luminosity"===r&&(e.filter=this.filterFactory.addLuminosityFilter(s));var y=new Path2D;y.rect(o,l,n,i),e.clip(y),e.globalCompositeOperation="destination-in",e.drawImage(c,d,f,n,i,o,l,n,i),e.restore()}},{key:"save",value:function(){this.inSMaskMode&&pc(this.ctx,this.suspendedCtx),this.ctx.save();var t=this.current;this.stateStack.push(t),this.current=t.clone()}},{key:"restore",value:function(){0!==this.stateStack.length?(this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&pc(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null):this.inSMaskMode&&this.endSMaskMode()}},{key:"transform",value:function(t,e,n,i,r,a){this.ctx.transform(t,e,n,i,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}},{key:"constructPath",value:function(t,e,n){var i=D(e,1)[0];if(!n)return i||(i=e[0]=new Path2D),void this[t](i);if(!(i instanceof Path2D)){for(var r=e[0]=new Path2D,a=0,s=i.length;a<s;)switch(i[a++]){case kr:r.moveTo(i[a++],i[a++]);break;case Ar:r.lineTo(i[a++],i[a++]);break;case _r:r.bezierCurveTo(i[a++],i[a++],i[a++],i[a++],i[a++],i[a++]);break;case xr:r.closePath();break;default:Rr("Unrecognized drawing path operator: ".concat(i[a-1]))}i=r}Xr.axialAlignedBoundingBox(n,ka(this.ctx),this.current.minMax),this[t](i)}},{key:"closePath",value:function(){this.ctx.closePath()}},{key:"stroke",value:function(t){var e=!(arguments.length>1&&arguments[1]!==undefined)||arguments[1],n=this.ctx,i=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if("object"===B(i)&&null!=i&&i.getPattern){var r=i.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=i.getPattern(n,this,Aa(n),Xh),r){var a=new Path2D;a.addPath(t,n.getTransform().invertSelf().multiplySelf(r)),t=a}this.rescaleAndStroke(t,!1),n.restore()}else this.rescaleAndStroke(t,!0);e&&this.consumePath(t,this.current.getClippedPathBoundingBox(Xh,ka(this.ctx))),n.globalAlpha=this.current.fillAlpha}},{key:"closeStroke",value:function(t){this.stroke(t)}},{key:"fill",value:function(t){var e=!(arguments.length>1&&arguments[1]!==undefined)||arguments[1],n=this.ctx,i=this.current.fillColor,r=!1;if(this.current.patternFill){var a=i.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.fillStyle=i.getPattern(n,this,Aa(n),qh),a){var s=new Path2D;s.addPath(t,n.getTransform().invertSelf().multiplySelf(a)),t=s}r=!0}var o=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==o&&(this.pendingEOFill?(n.fill(t,"evenodd"),this.pendingEOFill=!1):n.fill(t)),r&&n.restore(),e&&this.consumePath(t,o)}},{key:"eoFill",value:function(t){this.pendingEOFill=!0,this.fill(t)}},{key:"fillStroke",value:function(t){this.fill(t,!1),this.stroke(t,!1),this.consumePath(t)}},{key:"eoFillStroke",value:function(t){this.pendingEOFill=!0,this.fillStroke(t)}},{key:"closeFillStroke",value:function(t){this.fillStroke(t)}},{key:"closeEOFillStroke",value:function(t){this.pendingEOFill=!0,this.fillStroke(t)}},{key:"endPath",value:function(t){this.consumePath(t)}},{key:"rawFillPath",value:function(t){this.ctx.fill(t)}},{key:"clip",value:function(){this.pendingClip=bc}},{key:"eoClip",value:function(){this.pendingClip=kc}},{key:"beginText",value:function(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}},{key:"endText",value:function(){var t=this.pendingTextPaths,e=this.ctx;if(t!==undefined){var n,i=new Path2D,r=e.getTransform().invertSelf(),a=w(t);try{for(a.s();!(n=a.n()).done;){var s=n.value,o=s.transform,l=s.x,u=s.y,h=s.fontSize,c=s.path;c&&i.addPath(c,new DOMMatrix(o).preMultiplySelf(r).translate(l,u).scale(h,-h))}}catch(d){a.e(d)}finally{a.f()}e.clip(i),delete this.pendingTextPaths}}},{key:"setCharSpacing",value:function(t){this.current.charSpacing=t}},{key:"setWordSpacing",value:function(t){this.current.wordSpacing=t}},{key:"setHScale",value:function(t){this.current.textHScale=t/100}},{key:"setLeading",value:function(t){this.current.leading=-t}},{key:"setFont",value:function(t,e){var n,i=this.commonObjs.get(t),r=this.current;if(!i)throw new Error("Can't find font for ".concat(t));if(r.fontMatrix=i.fontMatrix||Vi,0!==r.fontMatrix[0]&&0!==r.fontMatrix[3]||Rr("Invalid font matrix for font "+t),e<0?(e=-e,r.fontDirection=-1):r.fontDirection=1,this.current.font=i,this.current.fontSize=e,!i.isType3Font){var a=i.loadedName||"sans-serif",s=(null===(n=i.systemFontInfo)||void 0===n?void 0:n.css)||'"'.concat(a,'", ').concat(i.fallbackName),o="normal";i.black?o="900":i.bold&&(o="bold");var l=i.italic?"italic":"normal",u=e;e<16?u=16:e>100&&(u=100),this.current.fontSizeScale=e/u,this.ctx.font="".concat(l," ").concat(o," ").concat(u,"px ").concat(s)}}},{key:"setTextRenderingMode",value:function(t){this.current.textRenderingMode=t}},{key:"setTextRise",value:function(t){this.current.textRise=t}},{key:"moveText",value:function(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}},{key:"setLeadingMoveText",value:function(t,e){this.setLeading(-e),this.moveText(t,e)}},{key:"setTextMatrix",value:function(t){var e=this.current;e.textMatrix=t,e.textMatrixScale=Math.hypot(t[0],t[1]),e.x=e.lineX=0,e.y=e.lineY=0}},{key:"nextLine",value:function(){this.moveText(0,this.current.leading)}},{key:"paintChar",value:function(t,e,n,i,a){var s,o=this.ctx,l=this.current,u=l.font,h=l.textRenderingMode,c=l.fontSize/l.fontSizeScale,d=h&hr,f=!!(h&cr),v=l.patternFill&&!u.missingFile,p=l.patternStroke&&!u.missingFile;if((u.disableFontFace||f||v||p)&&!u.missingFile&&(s=u.getPathGenerator(this.commonObjs,t)),s&&(u.disableFontFace||v||p)){var g;if(o.save(),o.translate(e,n),o.scale(c,-c),d!==sr&&d!==lr||(i?(g=o.getTransform(),o.setTransform.apply(o,F(i)),o.fill(r(Ac,this,Ec).call(this,s,g,i))):o.fill(s)),d===or||d===lr)if(a){g||(g=o.getTransform()),o.setTransform.apply(o,F(a));var y=g,m=y.a,w=y.b,b=y.c,k=y.d,A=Xr.inverseTransform(a),_=Xr.transform([m,w,b,k,0,0],A);Xr.singularValueDecompose2dScale(_,lc),o.lineWidth*=Math.max(lc[0],lc[1])/c,o.stroke(r(Ac,this,Ec).call(this,s,g,a))}else o.lineWidth/=c,o.stroke(s);o.restore()}else d!==sr&&d!==lr||o.fillText(t,e,n),d!==or&&d!==lr||o.strokeText(t,e,n);f&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:ka(o),x:e,y:n,fontSize:c,path:s})}},{key:"isFontSubpixelAAEnabled",get:function(){var t=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10).context;t.scale(1.5,1),t.fillText("I",0,10);for(var e=t.getImageData(0,0,10,10).data,n=!1,i=3;i<e.length;i+=4)if(e[i]>0&&e[i]<255){n=!0;break}return Or(this,"isFontSubpixelAAEnabled",n)}},{key:"showText",value:function(t){var e=this.current,n=e.font;if(n.isType3Font)return this.showType3Text(t);var i=e.fontSize;if(0===i)return undefined;var r,a,s=this.ctx,o=e.fontSizeScale,l=e.charSpacing,u=e.wordSpacing,h=e.fontDirection,c=e.textHScale*h,d=t.length,f=n.vertical,v=f?1:-1,p=n.defaultVMetrics,g=i*e.fontMatrix[0],y=e.textRenderingMode===sr&&!n.disableFontFace&&!e.patternFill;if(s.save(),e.textMatrix&&s.transform.apply(s,F(e.textMatrix)),s.translate(e.x,e.y+e.textRise),h>0?s.scale(c,-1):s.scale(c,1),e.patternFill){s.save();var m=e.fillColor.getPattern(s,this,Aa(s),qh);r=ka(s),s.restore(),s.fillStyle=m}if(e.patternStroke){s.save();var b=e.strokeColor.getPattern(s,this,Aa(s),Xh);a=ka(s),s.restore(),s.strokeStyle=b}var k=e.lineWidth,A=e.textMatrixScale;if(0===A||0===k){var _=e.textRenderingMode&hr;_!==or&&_!==lr||(k=this.getSinglePixelWidth())}else k/=A;if(1!==o&&(s.scale(o,o),k/=o),s.lineWidth=k,n.isInvalidPDFjsFont){var x,S=[],E=0,M=w(t);try{for(M.s();!(x=M.n()).done;){var C=x.value;S.push(C.unicode),E+=C.width}}catch(X){M.e(X)}finally{M.f()}return s.fillText(S.join(""),0,0),e.x+=E*g*c,s.restore(),this.compose(),undefined}var T,R=0;for(T=0;T<d;++T){var P=t[T];if("number"!=typeof P){var I=!1,D=(P.isSpace?u:0)+l,L=P.fontChar,O=P.accent,N=void 0,W=void 0,B=P.width;if(f){var j=P.vmetric||p,H=-(P.vmetric?j[1]:.5*B)*g,U=j[2]*g;B=j?-j[0]:B,N=H/o,W=(R+U)/o}else N=R/o,W=0;if(n.remeasure&&B>0){var z=1e3*s.measureText(L).width/i*o;if(B<z&&this.isFontSubpixelAAEnabled){var G=B/z;I=!0,s.save(),s.scale(G,1),N/=G}else B!==z&&(N+=(B-z)/2e3*i/o)}if(this.contentVisible&&(P.isInFont||n.missingFile))if(y&&!O)s.fillText(L,N,W);else if(this.paintChar(L,N,W,r,a),O){var V=N+i*O.offset.x/o,q=W-i*O.offset.y/o;this.paintChar(O.fontChar,V,q,r,a)}R+=f?B*g-D*h:B*g+D*h,I&&s.restore()}else R+=v*P*i/1e3}return f?e.y-=R:e.x+=R*c,s.restore(),this.compose(),undefined}},{key:"showType3Text",value:function(t){var e,n,i,r,a=this.ctx,s=this.current,o=s.font,l=s.fontSize,u=s.fontDirection,h=o.vertical?1:-1,c=s.charSpacing,d=s.wordSpacing,f=s.textHScale*u,v=s.fontMatrix||Vi,p=t.length;if(!(s.textRenderingMode===ur)&&0!==l){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,a.save(),s.textMatrix&&a.transform.apply(a,F(s.textMatrix)),a.translate(s.x,s.y+s.textRise),a.scale(f,u),e=0;e<p;++e)if("number"!=typeof(n=t[e])){var g=(n.isSpace?d:0)+c,y=o.charProcOperatorList[n.operatorListId];y?this.contentVisible&&(this.save(),a.scale(l,l),a.transform.apply(a,F(v)),this.executeOperatorList(y),this.restore()):Rr('Type3 character "'.concat(n.operatorListId,'" is not available.'));var m=[n.width,0];Xr.applyTransform(m,v),i=m[0]*l+g,a.translate(i,0),s.x+=i*f}else r=h*n*l/1e3,this.ctx.translate(r,0),s.x+=r*f;a.restore()}}},{key:"setCharWidth",value:function(t,e){}},{key:"setCharWidthAndBounds",value:function(t,e,n,i,r,a){var s=new Path2D;s.rect(n,i,r-n,a-i),this.ctx.clip(s),this.endPath()}},{key:"getColorN_Pattern",value:function(e){var n,i=this;if("TilingPattern"===e[0]){var r=this.baseTransform||ka(this.ctx),a={createCanvasGraphics:function(e){return new t(e,i.commonObjs,i.objs,i.canvasFactory,i.filterFactory,{optionalContentConfig:i.optionalContentConfig,markedContentStack:i.markedContentStack})}};n=new rc(e,this.ctx,a,r)}else n=this._getPattern(e[1],e[2]);return n}},{key:"setStrokeColorN",value:function(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}},{key:"setFillColorN",value:function(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}},{key:"setStrokeRGBColor",value:function(t){this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}},{key:"setStrokeTransparent",value:function(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}},{key:"setFillRGBColor",value:function(t){this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}},{key:"setFillTransparent",value:function(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}},{key:"_getPattern",value:function(t){var e,n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return this.cachedPatterns.has(t)?e=this.cachedPatterns.get(t):(e=function(t){switch(t[0]){case"RadialAxial":return new Jh(t);case"Mesh":return new tc(t);case"Dummy":return new ec}throw new Error("Unknown IR type: ".concat(t[0]))}(this.getObject(t)),this.cachedPatterns.set(t,e)),n&&(e.matrix=n),e}},{key:"shadingFill",value:function(t){if(this.contentVisible){var e=this.ctx;this.save();var n=this._getPattern(t);e.fillStyle=n.getPattern(e,this,Aa(e),Yh);var i=Aa(e);if(i){var r=e.canvas,a=r.width,s=r.height,o=uc.slice();Xr.axialAlignedBoundingBox([0,0,a,s],i,o);var l=D(o,4),u=l[0],h=l[1],c=l[2],d=l[3];this.ctx.fillRect(u,h,c-u,d-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}}},{key:"beginInlineImage",value:function(){Pr("Should not call beginInlineImage")}},{key:"beginImageData",value:function(){Pr("Should not call beginImageData")}},{key:"paintFormXObjectBegin",value:function(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform.apply(this,F(t)),this.baseTransform=ka(this.ctx),e)){Xr.axialAlignedBoundingBox(e,this.baseTransform,this.current.minMax);var n=D(e,4),i=n[0],r=n[1],a=n[2],s=n[3],o=new Path2D;o.rect(i,r,a-i,s-r),this.ctx.clip(o),this.endPath()}}},{key:"paintFormXObjectEnd",value:function(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}},{key:"beginGroup",value:function(t){if(this.contentVisible){this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);var e=this.ctx;t.isolated||Tr("TODO: Support non-isolated groups."),t.knockout&&Rr("Knockout groups not supported.");var n=ka(e);if(t.matrix&&e.transform.apply(e,F(t.matrix)),!t.bbox)throw new Error("Bounding box is required.");var i=uc.slice();Xr.axialAlignedBoundingBox(t.bbox,ka(e),i);var r=[0,0,e.canvas.width,e.canvas.height];i=Xr.intersect(i,r)||[0,0,0,0];var a=Math.floor(i[0]),s=Math.floor(i[1]),o=Math.max(Math.ceil(i[2])-a,1),l=Math.max(Math.ceil(i[3])-s,1);this.current.startNewPathAndClipBox([0,0,o,l]);var u="groupAt"+this.groupLevel;t.smask&&(u+="_smask_"+this.smaskCounter++%2);var h=this.cachedCanvases.getCanvas(u,o,l),c=h.context;c.translate(-a,-s),c.transform.apply(c,F(n));var d=new Path2D,f=D(t.bbox,4),v=f[0],p=f[1],g=f[2],y=f[3];if(d.rect(v,p,g-v,y-p),t.matrix){var m=new Path2D;m.addPath(d,new DOMMatrix(t.matrix)),d=m}c.clip(d),t.smask?this.smaskStack.push({canvas:h.canvas,context:c,offsetX:a,offsetY:s,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(a,s),e.save()),pc(e,c),this.ctx=c,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}}},{key:"endGroup",value:function(t){if(this.contentVisible){this.groupLevel--;var e=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{var i;this.ctx.restore();var r=ka(this.ctx);this.restore(),this.ctx.save(),(i=this.ctx).setTransform.apply(i,F(r));var a=uc.slice();Xr.axialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],r,a),this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(a)}}}},{key:"beginAnnotation",value:function(t,e,n,i,a){var s;(r(Ac,this,xc).call(this),gc(this.ctx),this.ctx.save(),this.save(),this.baseTransform)&&(s=this.ctx).setTransform.apply(s,F(this.baseTransform));if(e){var o=e[2]-e[0],l=e[3]-e[1];if(a&&this.annotationCanvasMap){(n=n.slice())[4]-=e[0],n[5]-=e[1],(e=e.slice())[0]=e[1]=0,e[2]=o,e[3]=l,Xr.singularValueDecompose2dScale(ka(this.ctx),lc);var u=this.viewportScale,h=Math.ceil(o*this.outputScaleX*u),c=Math.ceil(l*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(h,c);var d=this.annotationCanvas,f=d.canvas,v=d.context;this.annotationCanvasMap.set(t,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(lc[0],0,0,-lc[1],0,l*lc[1]),gc(this.ctx)}else{gc(this.ctx),this.endPath();var p=new Path2D;p.rect(e[0],e[1],o,l),this.ctx.clip(p)}}this.current=new dc(this.ctx.canvas.width,this.ctx.canvas.height),this.transform.apply(this,F(n)),this.transform.apply(this,F(i))}},{key:"endAnnotation",value:function(){this.annotationCanvas&&(this.ctx.restore(),r(Ac,this,Sc).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}},{key:"paintImageMaskXObject",value:function(t){if(this.contentVisible){var e=t.count;(t=this.getObject(t.data,t)).count=e;var n=this.ctx,i=this._createMaskCanvas(t),r=i.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(r,i.offsetX,i.offsetY),n.restore(),this.compose()}}},{key:"paintImageMaskXObjectRepeat",value:function(t,e){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0,r=arguments.length>4?arguments[4]:undefined,a=arguments.length>5?arguments[5]:undefined;if(this.contentVisible){t=this.getObject(t.data,t);var s=this.ctx;s.save();var o=ka(s);s.transform(e,n,i,r,0,0);var l=this._createMaskCanvas(t);s.setTransform(1,0,0,1,l.offsetX-o[4],l.offsetY-o[5]);for(var u=0,h=a.length;u<h;u+=2){var c=Xr.transform(o,[e,n,i,r,a[u],a[u+1]]);s.drawImage(l.canvas,c[4],c[5])}s.restore(),this.compose()}}},{key:"paintImageMaskXObjectGroup",value:function(t){if(this.contentVisible){var e,n=this.ctx,i=this.current.fillColor,r=this.current.patternFill,a=w(t);try{for(a.s();!(e=a.n()).done;){var s=e.value,o=s.data,l=s.width,u=s.height,h=s.transform,c=this.cachedCanvases.getCanvas("maskCanvas",l,u),d=c.context;d.save(),vc(d,this.getObject(o,s)),d.globalCompositeOperation="source-in",d.fillStyle=r?i.getPattern(d,this,Aa(n),qh):i,d.fillRect(0,0,l,u),d.restore(),n.save(),n.transform.apply(n,F(h)),n.scale(1,-1),cc(n,c.canvas,0,0,l,u,0,-1,1,1),n.restore()}}catch(f){a.e(f)}finally{a.f()}this.compose()}}},{key:"paintImageXObject",value:function(t){if(this.contentVisible){var e=this.getObject(t);e?this.paintInlineImageXObject(e):Rr("Dependent image isn't ready yet")}}},{key:"paintImageXObjectRepeat",value:function(t,e,n,i){if(this.contentVisible){var r=this.getObject(t);if(r){for(var a=r.width,s=r.height,o=[],l=0,u=i.length;l<u;l+=2)o.push({transform:[e,0,0,n,i[l],i[l+1]],x:0,y:0,w:a,h:s});this.paintInlineImageXObjectGroup(r,o)}else Rr("Dependent image isn't ready yet")}}},{key:"applyTransferMapsToCanvas",value:function(t){return"none"!==this.current.transferMaps&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}},{key:"applyTransferMapsToBitmap",value:function(t){if("none"===this.current.transferMaps)return t.bitmap;var e=t.bitmap,n=t.width,i=t.height,r=this.cachedCanvases.getCanvas("inlineImage",n,i),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",r.canvas}},{key:"paintInlineImageXObject",value:function(t){if(this.contentVisible){var e=t.width,n=t.height,i=this.ctx;this.save();var r,a=i.filter;if("none"!==a&&""!==a&&(i.filter="none"),i.scale(1/e,-1/n),t.bitmap)r=this.applyTransferMapsToBitmap(t);else if("function"==typeof HTMLElement&&t instanceof HTMLElement||!t.data)r=t;else{var s=this.cachedCanvases.getCanvas("inlineImage",e,n).context;fc(s,t),r=this.applyTransferMapsToCanvas(s)}var o=this._scaleImage(r,Aa(i));i.imageSmoothingEnabled=yc(ka(i),t.interpolate),cc(i,o.img,0,0,o.paintWidth,o.paintHeight,0,-n,e,n),this.compose(),this.restore()}}},{key:"paintInlineImageXObjectGroup",value:function(t,e){if(this.contentVisible){var n,i=this.ctx;if(t.bitmap)n=t.bitmap;else{var r=t.width,a=t.height,s=this.cachedCanvases.getCanvas("inlineImage",r,a).context;fc(s,t),n=this.applyTransferMapsToCanvas(s)}var o,l=w(e);try{for(l.s();!(o=l.n()).done;){var u=o.value;i.save(),i.transform.apply(i,F(u.transform)),i.scale(1,-1),cc(i,n,u.x,u.y,u.w,u.h,0,-1,1,1),i.restore()}}catch(h){l.e(h)}finally{l.f()}this.compose()}}},{key:"paintSolidColorImageMask",value:function(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}},{key:"markPoint",value:function(t){}},{key:"markPointProps",value:function(t,e){}},{key:"beginMarkedContent",value:function(t){this.markedContentStack.push({visible:!0})}},{key:"beginMarkedContentProps",value:function(t,e){"OC"===t?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}},{key:"endMarkedContent",value:function(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}},{key:"beginCompat",value:function(){}},{key:"endCompat",value:function(){}},{key:"consumePath",value:function(t,e){var n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);var i=this.ctx;this.pendingClip&&(n||(this.pendingClip===kc?i.clip(t,"evenodd"):i.clip(t)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}},{key:"getSinglePixelWidth",value:function(){if(!this._cachedGetSinglePixelWidth){var t=ka(this.ctx);if(0===t[1]&&0===t[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{var e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),i=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/e}}return this._cachedGetSinglePixelWidth}},{key:"getScaleForStroking",value:function(){if(-1===this._cachedScaleForStroking[0]){var t,e,n=this.current.lineWidth,i=this.ctx.getTransform(),r=i.a,a=i.b,s=i.c,o=i.d;if(0===a&&0===s){var l=Math.abs(r),u=Math.abs(o);if(l===u)if(0===n)t=e=1/l;else{var h=l*n;t=e=h<1?1/h:1}else if(0===n)t=1/l,e=1/u;else{var c=l*n,d=u*n;t=c<1?1/c:1,e=d<1?1/d:1}}else{var f=Math.abs(r*o-a*s),v=Math.hypot(r,a),p=Math.hypot(s,o);if(0===n)t=p/f,e=v/f;else{var g=n*f;t=p>g?p/g:1,e=v>g?v/g:1}}this._cachedScaleForStroking[0]=t,this._cachedScaleForStroking[1]=e}return this._cachedScaleForStroking}},{key:"rescaleAndStroke",value:function(t,e){var n=this.ctx,i=this.current.lineWidth,r=D(this.getScaleForStroking(),2),a=r[0],s=r[1];if(a===s)return n.lineWidth=(i||1)*a,void n.stroke(t);var o=n.getLineDash();e&&n.save(),n.scale(a,s),oc.a=1/a,oc.d=1/s;var l=new Path2D;if(l.addPath(t,oc),o.length>0){var u=Math.max(a,s);n.setLineDash(o.map((function(t){return t/u}))),n.lineDashOffset/=u}n.lineWidth=i||1,n.stroke(l),e&&n.restore()}},{key:"isContentVisible",value:function(){for(var t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}])}();function xc(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}function Sc(){if(this.pageColors){var t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==t){var e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}function Ec(t,e,n){var i=new Path2D;return i.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(e)),i}for(var Mc in br)_c.prototype[Mc]!==undefined&&(_c.prototype[br[Mc]]=_c.prototype[Mc]);var Cc=function(){function t(){c(this,t)}return m(t,null,[{key:"workerPort",get:function(){return r(t,this,Tc)._},set:function(e){if(!("undefined"!=typeof Worker&&e instanceof Worker)&&null!==e)throw new Error("Invalid `workerPort` type.");Tc._=r(t,this,e)}},{key:"workerSrc",get:function(){return r(t,this,Rc)._},set:function(e){if("string"!=typeof e)throw new Error("Invalid `workerSrc` type.");Rc._=r(t,this,e)}}])}(),Tc={_:null},Rc={_:""},Pc=new WeakMap,Ic=new WeakMap,Dc=function(){return m((function t(e){var n=e.parsedData,i=e.rawData;c(this,t),f(this,Pc,void 0),f(this,Ic,void 0),v(Pc,this,n),v(Ic,this,i)}),[{key:"getRaw",value:function(){return d(Ic,this)}},{key:"get",value:function(t){var e;return null!==(e=d(Pc,this).get(t))&&void 0!==e?e:null}},{key:Symbol.iterator,value:function(){return d(Pc,this).entries()}}])}(),Lc=Symbol("INTERNAL"),Oc=new WeakMap,Fc=new WeakMap,Nc=new WeakMap,Wc=new WeakMap,Bc=function(){return m((function t(e,n){var i=n.name,r=n.intent,a=n.usage,s=n.rbGroups;c(this,t),f(this,Oc,!1),f(this,Fc,!1),f(this,Nc,!1),f(this,Wc,!0),v(Oc,this,!!(e&Yi)),v(Fc,this,!!(e&Ki)),this.name=i,this.intent=r,this.usage=a,this.rbGroups=s}),[{key:"visible",get:function(){if(d(Nc,this))return d(Wc,this);if(!d(Wc,this))return!1;var t=this.usage,e=t.print,n=t.view;return d(Oc,this)?"OFF"!==(null==n?void 0:n.viewState):!d(Fc,this)||"OFF"!==(null==e?void 0:e.printState)}},{key:"_setVisible",value:function(t,e){var n=arguments.length>2&&arguments[2]!==undefined&&arguments[2];t!==Lc&&Pr("Internal method `_setVisible` called."),v(Nc,this,n),v(Wc,this,e)}}])}(),jc=new WeakMap,Hc=new WeakMap,Uc=new WeakMap,zc=new WeakMap,Gc=new WeakSet,Vc=function(){return m((function t(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Yi;if(c(this,t),g(this,Gc),f(this,jc,null),f(this,Hc,new Map),f(this,Uc,null),f(this,zc,null),this.renderingIntent=n,this.name=null,this.creator=null,null!==e){this.name=e.name,this.creator=e.creator,v(zc,this,e.order);var i,r=w(e.groups);try{for(r.s();!(i=r.n()).done;){var a=i.value;d(Hc,this).set(a.id,new Bc(n,a))}}catch(b){r.e(b)}finally{r.f()}if("OFF"===e.baseState){var s,o=w(d(Hc,this).values());try{for(o.s();!(s=o.n()).done;){s.value._setVisible(Lc,!1)}}catch(b){o.e(b)}finally{o.f()}}var l,u=w(e.on);try{for(u.s();!(l=u.n()).done;){var h=l.value;d(Hc,this).get(h)._setVisible(Lc,!0)}}catch(b){u.e(b)}finally{u.f()}var p,y=w(e.off);try{for(y.s();!(p=y.n()).done;){var m=p.value;d(Hc,this).get(m)._setVisible(Lc,!1)}}catch(b){y.e(b)}finally{y.f()}v(Uc,this,this.getHash())}}),[{key:"isVisible",value:function(t){if(0===d(Hc,this).size)return!0;if(!t)return Tr("Optional content group not defined."),!0;if("OCG"===t.type)return d(Hc,this).has(t.id)?d(Hc,this).get(t.id).visible:(Rr("Optional content group not found: ".concat(t.id)),!0);if("OCMD"===t.type){if(t.expression)return r(Gc,this,qc).call(this,t.expression);if(!t.policy||"AnyOn"===t.policy){var e,n=w(t.ids);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(!d(Hc,this).has(i))return Rr("Optional content group not found: ".concat(i)),!0;if(d(Hc,this).get(i).visible)return!0}}catch(p){n.e(p)}finally{n.f()}return!1}if("AllOn"===t.policy){var a,s=w(t.ids);try{for(s.s();!(a=s.n()).done;){var o=a.value;if(!d(Hc,this).has(o))return Rr("Optional content group not found: ".concat(o)),!0;if(!d(Hc,this).get(o).visible)return!1}}catch(p){s.e(p)}finally{s.f()}return!0}if("AnyOff"===t.policy){var l,u=w(t.ids);try{for(u.s();!(l=u.n()).done;){var h=l.value;if(!d(Hc,this).has(h))return Rr("Optional content group not found: ".concat(h)),!0;if(!d(Hc,this).get(h).visible)return!0}}catch(p){u.e(p)}finally{u.f()}return!1}if("AllOff"===t.policy){var c,f=w(t.ids);try{for(f.s();!(c=f.n()).done;){var v=c.value;if(!d(Hc,this).has(v))return Rr("Optional content group not found: ".concat(v)),!0;if(d(Hc,this).get(v).visible)return!1}}catch(p){f.e(p)}finally{f.f()}return!0}return Rr("Unknown optional content policy ".concat(t.policy,".")),!0}return Rr("Unknown group type ".concat(t.type,".")),!0}},{key:"setVisibility",value:function(t){var e=!(arguments.length>1&&arguments[1]!==undefined)||arguments[1],n=!(arguments.length>2&&arguments[2]!==undefined)||arguments[2],i=d(Hc,this).get(t);if(i){if(n&&e&&i.rbGroups.length){var r,a=w(i.rbGroups);try{for(a.s();!(r=a.n()).done;){var s,o=w(r.value);try{for(o.s();!(s=o.n()).done;){var l,u=s.value;if(u!==t)null===(l=d(Hc,this).get(u))||void 0===l||l._setVisible(Lc,!1,!0)}}catch(h){o.e(h)}finally{o.f()}}}catch(h){a.e(h)}finally{a.f()}}i._setVisible(Lc,!!e,!0),v(jc,this,null)}else Rr("Optional content group not found: ".concat(t))}},{key:"setOCGState",value:function(t){var e,n,i=t.state,r=t.preserveRB,a=w(i);try{for(a.s();!(n=a.n()).done;){var s=n.value;switch(s){case"ON":case"OFF":case"Toggle":e=s;continue}var o=d(Hc,this).get(s);if(o)switch(e){case"ON":this.setVisibility(s,!0,r);break;case"OFF":this.setVisibility(s,!1,r);break;case"Toggle":this.setVisibility(s,!o.visible,r)}}}catch(l){a.e(l)}finally{a.f()}v(jc,this,null)}},{key:"hasInitialVisibility",get:function(){return null===d(Uc,this)||this.getHash()===d(Uc,this)}},{key:"getOrder",value:function(){return d(Hc,this).size?d(zc,this)?d(zc,this).slice():F(d(Hc,this).keys()):null}},{key:"getGroup",value:function(t){return d(Hc,this).get(t)||null}},{key:"getHash",value:function(){if(null!==d(jc,this))return d(jc,this);var t,e=new yu,n=w(d(Hc,this));try{for(n.s();!(t=n.n()).done;){var i=D(t.value,2),r=i[0],a=i[1];e.update("".concat(r,":").concat(a.visible))}}catch(s){n.e(s)}finally{n.f()}return v(jc,this,e.hexdigest())}},{key:Symbol.iterator,value:function(){return d(Hc,this).entries()}}])}();function qc(t){var e=t.length;if(e<2)return!0;for(var n=t[0],i=1;i<e;i++){var a=t[i],s=void 0;if(Array.isArray(a))s=r(Gc,this,qc).call(this,a);else{if(!d(Hc,this).has(a))return Rr("Optional content group not found: ".concat(a)),!0;s=d(Hc,this).get(a).visible}switch(n){case"And":if(!s)return!1;break;case"Or":if(s)return!0;break;case"Not":return!s;default:return!0}}return"And"===n}var Xc=function(){return m((function t(e,n){var i=this,r=n.disableRange,a=void 0!==r&&r,s=n.disableStream,o=void 0!==s&&s;c(this,t),Ir(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');var l=e.length,u=e.initialData,h=e.progressiveDone,d=e.contentDispositionFilename;if(this._queuedChunks=[],this._progressiveDone=h,this._contentDispositionFilename=d,(null==u?void 0:u.length)>0){var f=u instanceof Uint8Array&&u.byteLength===u.buffer.byteLength?u.buffer:new Uint8Array(u).buffer;this._queuedChunks.push(f)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!o,this._isRangeSupported=!a,this._contentLength=l,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((function(t,e){i._onReceiveData({begin:t,chunk:e})})),e.addProgressListener((function(t,e){i._onProgress({loaded:t,total:e})})),e.addProgressiveReadListener((function(t){i._onReceiveData({chunk:t})})),e.addProgressiveDoneListener((function(){i._onProgressiveDone()})),e.transportReady()}),[{key:"_onReceiveData",value:function(t){var e=t.begin,n=t.chunk,i=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;e===undefined?this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i):Ir(this._rangeReaders.some((function(t){return t._begin===e&&(t._enqueue(i),!0)})),"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}},{key:"_progressiveDataLength",get:function(){var t,e;return null!==(t=null===(e=this._fullRequestReader)||void 0===e?void 0:e._loaded)&&void 0!==t?t:0}},{key:"_onProgress",value:function(t){var e,n,i,r;t.total===undefined?null===(e=this._rangeReaders[0])||void 0===e||null===(n=e.onProgress)||void 0===n||n.call(e,{loaded:t.loaded}):null===(i=this._fullRequestReader)||void 0===i||null===(r=i.onProgress)||void 0===r||r.call(i,{loaded:t.loaded,total:t.total})}},{key:"_onProgressiveDone",value:function(){var t;null===(t=this._fullRequestReader)||void 0===t||t.progressiveDone(),this._progressiveDone=!0}},{key:"_removeRangeReader",value:function(t){var e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}},{key:"getFullReader",value:function(){Ir(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");var t=this._queuedChunks;return this._queuedChunks=null,new Yc(this,t,this._progressiveDone,this._contentDispositionFilename)}},{key:"getRangeReader",value:function(t,e){if(e<=this._progressiveDataLength)return null;var n=new Kc(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}},{key:"cancelAllRequests",value:function(t){var e;null===(e=this._fullRequestReader)||void 0===e||e.cancel(t);var n,i=w(this._rangeReaders.slice(0));try{for(i.s();!(n=i.n()).done;){n.value.cancel(t)}}catch(r){i.e(r)}finally{i.f()}this._pdfDataRangeTransport.abort()}}])}(),Yc=function(){return m((function e(t,n){var i=arguments.length>2&&arguments[2]!==undefined&&arguments[2],r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;c(this,e),this._stream=t,this._done=i||!1,this._filename=ha(r)?r:null,this._queuedChunks=n||[],this._loaded=0;var a,s=w(this._queuedChunks);try{for(s.s();!(a=s.n()).done;){var o=a.value;this._loaded+=o.byteLength}}catch(l){s.e(l)}finally{s.f()}this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}),[{key:"_enqueue",value:function(t){if(!this._done){if(this._requests.length>0)this._requests.shift().resolve({value:t,done:!1});else this._queuedChunks.push(t);this._loaded+=t.byteLength}}},{key:"headersReady",get:function(){return this._headersReady}},{key:"filename",get:function(){return this._filename}},{key:"isRangeSupported",get:function(){return this._stream._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._stream._isStreamingSupported}},{key:"contentLength",get:function(){return this._stream._contentLength}},{key:"read",value:(t=l(T().m((function n(){var t,e;return T().w((function(n){for(;;)switch(n.n){case 0:if(!(this._queuedChunks.length>0)){n.n=1;break}return t=this._queuedChunks.shift(),n.a(2,{value:t,done:!1});case 1:if(!this._done){n.n=2;break}return n.a(2,{value:undefined,done:!0});case 2:return e=Promise.withResolvers(),this._requests.push(e),n.a(2,e.promise)}}),n,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(t){this._done=!0;var e,n=w(this._requests);try{for(n.s();!(e=n.n()).done;){e.value.resolve({value:undefined,done:!0})}}catch(i){n.e(i)}finally{n.f()}this._requests.length=0}},{key:"progressiveDone",value:function(){this._done||(this._done=!0)}}]);var t}(),Kc=function(){return m((function e(t,n,i){c(this,e),this._stream=t,this._begin=n,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}),[{key:"_enqueue",value:function(t){if(!this._done){if(0===this._requests.length)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});var e,n=w(this._requests);try{for(n.s();!(e=n.n()).done;){e.value.resolve({value:undefined,done:!0})}}catch(i){n.e(i)}finally{n.f()}this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}},{key:"isStreamingSupported",get:function(){return!1}},{key:"read",value:(t=l(T().m((function n(){var t,e;return T().w((function(n){for(;;)switch(n.n){case 0:if(!this._queuedChunk){n.n=1;break}return t=this._queuedChunk,this._queuedChunk=null,n.a(2,{value:t,done:!1});case 1:if(!this._done){n.n=2;break}return n.a(2,{value:undefined,done:!0});case 2:return e=Promise.withResolvers(),this._requests.push(e),n.a(2,e.promise)}}),n,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(t){this._done=!0;var e,n=w(this._requests);try{for(n.s();!(e=n.n()).done;){e.value.resolve({value:undefined,done:!0})}}catch(i){n.e(i)}finally{n.f()}this._requests.length=0,this._stream._removeRangeReader(this)}}]);var t}();function Qc(t,e){var n=new Headers;if(!t||!e||"object"!==B(e))return n;for(var i in e){var r=e[i];r!==undefined&&n.append(i,r)}return n}function Jc(t){var e,n;return null!==(e=null===(n=URL.parse(t))||void 0===n?void 0:n.origin)&&void 0!==e?e:null}function Zc(t){var e=t.responseHeaders,n=t.isHttp,i=t.rangeChunkSize,r=t.disableRange,a={allowRangeRequests:!1,suggestedLength:undefined},s=parseInt(e.get("Content-Length"),10);return Number.isInteger(s)?(a.suggestedLength=s,s<=2*i||r||!n||"bytes"!==e.get("Accept-Ranges")||"identity"!==(e.get("Content-Encoding")||"identity")||(a.allowRangeRequests=!0),a):a}function $c(t){var e=t.get("Content-Disposition");if(e){var n=function(t){var e=!0,n=a("filename\\*","i").exec(t);if(n){var i=l(n=n[1]);return o(i=h(i=u(i=unescape(i))))}if(n=function(t){for(var e,n=[],i=a("filename\\*((?!0\\d)\\d+)(\\*?)","ig");null!==(e=i.exec(t));){var r=D(e,4),s=r[1],o=r[2],h=r[3];if((s=parseInt(s,10))in n){if(0===s)break}else n[s]=[o,h]}for(var c=[],d=0;d<n.length&&d in n;++d){var f=D(n[d],2),v=f[0],p=f[1];p=l(p),v&&(p=unescape(p),0===d&&(p=u(p))),c.push(p)}return c.join("")}(t))return o(h(n));if(n=a("filename","i").exec(t)){var r=l(n=n[1]);return o(r=h(r))}function a(t,e){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',e)}function s(t,n){if(t){if(!/^[\x00-\xFF]+$/.test(n))return n;try{var i=new TextDecoder(t,{fatal:!0}),r=Gr(n);n=i.decode(r),e=!1}catch(a){}}return n}function o(t){return e&&/[\x80-\xff]/.test(t)&&(t=s("utf-8",t),e&&(t=s("iso-8859-1",t))),t}function l(t){if(t.startsWith('"')){for(var e=t.slice(1).split('\\"'),n=0;n<e.length;++n){var i=e[n].indexOf('"');-1!==i&&(e[n]=e[n].slice(0,i),e.length=n+1),e[n]=e[n].replaceAll(/\\(.)/g,"$1")}t=e.join('"')}return t}function u(t){var e=t.indexOf("'");return-1===e?t:s(t.slice(0,e),t.slice(e+1).replace(/^[^']*'/,""))}function h(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(t,e,n,i){if("q"===n||"Q"===n)return s(e,i=(i=i.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,(function(t,e){return String.fromCharCode(parseInt(e,16))})));try{i=atob(i)}catch(r){}return s(e,i)}))}return""}(e);if(n.includes("%"))try{n=decodeURIComponent(n)}catch(i){}if(ha(n))return n}return null}function td(t,e){return new jr("Unexpected server response (".concat(t,') while retrieving PDF "').concat(e,'".'),t,404===t||0===t&&e.startsWith("file:"))}function ed(t){return 200===t||206===t}function nd(t,e,n){return{method:"GET",headers:t,signal:n.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function id(t){return t instanceof Uint8Array?t.buffer:t instanceof ArrayBuffer?t:(Rr("getArrayBuffer - unexpected data format: ".concat(t)),new Uint8Array(t).buffer)}var rd=function(){return m((function t(e){c(this,t),b(this,"_responseOrigin",null),this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Qc(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}),[{key:"_progressiveDataLength",get:function(){var t,e;return null!==(t=null===(e=this._fullRequestReader)||void 0===e?void 0:e._loaded)&&void 0!==t?t:0}},{key:"getFullReader",value:function(){return Ir(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new ad(this),this._fullRequestReader}},{key:"getRangeReader",value:function(t,e){if(e<=this._progressiveDataLength)return null;var n=new sd(this,t,e);return this._rangeRequestReaders.push(n),n}},{key:"cancelAllRequests",value:function(t){var e;null===(e=this._fullRequestReader)||void 0===e||e.cancel(t);var n,i=w(this._rangeRequestReaders.slice(0));try{for(i.s();!(n=i.n()).done;){n.value.cancel(t)}}catch(r){i.e(r)}finally{i.f()}}}])}(),ad=function(){return m((function e(t){var n=this;c(this,e),this._stream=t,this._reader=null,this._loaded=0,this._filename=null;var i=t.source;this._withCredentials=i.withCredentials||!1,this._contentLength=i.length,this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange;var r=new Headers(t.headers),a=i.url;fetch(a,nd(r,this._withCredentials,this._abortController)).then((function(e){if(t._responseOrigin=Jc(e.url),!ed(e.status))throw td(e.status,a);n._reader=e.body.getReader(),n._headersCapability.resolve();var i=e.headers,r=Zc({responseHeaders:i,isHttp:t.isHttp,rangeChunkSize:n._rangeChunkSize,disableRange:n._disableRange}),s=r.allowRangeRequests,o=r.suggestedLength;n._isRangeSupported=s,n._contentLength=o||n._contentLength,n._filename=$c(i),!n._isStreamingSupported&&n._isRangeSupported&&n.cancel(new Ur("Streaming is disabled."))}))["catch"](this._headersCapability.reject),this.onProgress=null}),[{key:"headersReady",get:function(){return this._headersCapability.promise}},{key:"filename",get:function(){return this._filename}},{key:"contentLength",get:function(){return this._contentLength}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"read",value:(t=l(T().m((function n(){var t,e,i,r;return T().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,this._headersCapability.promise;case 1:return n.n=2,this._reader.read();case 2:if(e=n.v,i=e.value,!(r=e.done)){n.n=3;break}return n.a(2,{value:i,done:r});case 3:return this._loaded+=i.byteLength,null===(t=this.onProgress)||void 0===t||t.call(this,{loaded:this._loaded,total:this._contentLength}),n.a(2,{value:id(i),done:!1})}}),n,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(t){var e;null===(e=this._reader)||void 0===e||e.cancel(t),this._abortController.abort()}}]);var t}(),sd=function(){return m((function e(t,n,i){var r=this;c(this,e),this._stream=t,this._reader=null,this._loaded=0;var a=t.source;this._withCredentials=a.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!a.disableStream,this._abortController=new AbortController;var s=new Headers(t.headers);s.append("Range","bytes=".concat(n,"-").concat(i-1));var o=a.url;fetch(o,nd(s,this._withCredentials,this._abortController)).then((function(e){var n=Jc(e.url);if(n!==t._responseOrigin)throw new Error('Expected range response-origin "'.concat(n,'" to match "').concat(t._responseOrigin,'".'));if(!ed(e.status))throw td(e.status,o);r._readCapability.resolve(),r._reader=e.body.getReader()}))["catch"](this._readCapability.reject),this.onProgress=null}),[{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"read",value:(t=l(T().m((function n(){var t,e,i,r;return T().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,this._readCapability.promise;case 1:return n.n=2,this._reader.read();case 2:if(e=n.v,i=e.value,!(r=e.done)){n.n=3;break}return n.a(2,{value:i,done:r});case 3:return this._loaded+=i.byteLength,null===(t=this.onProgress)||void 0===t||t.call(this,{loaded:this._loaded}),n.a(2,{value:id(i),done:!1})}}),n,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(t){var e;null===(e=this._reader)||void 0===e||e.cancel(t),this._abortController.abort()}}]);var t}();var od=function(){return m((function t(e){var n=e.url,i=e.httpHeaders,r=e.withCredentials;c(this,t),b(this,"_responseOrigin",null),this.url=n,this.isHttp=/^https?:/i.test(n),this.headers=Qc(this.isHttp,i),this.withCredentials=r||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}),[{key:"request",value:function(t){var e=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;var r,a=w(this.headers);try{for(a.s();!(r=a.n()).done;){var s=D(r.value,2),o=s[0],l=s[1];e.setRequestHeader(o,l)}}catch(u){a.e(u)}finally{a.f()}return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range","bytes=".concat(t.begin,"-").concat(t.end-1)),i.expectedStatus=206):i.expectedStatus=200,e.responseType="arraybuffer",Ir(t.onError,"Expected `onError` callback to be provided."),e.onerror=function(){t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=t.onHeadersReceived,i.onDone=t.onDone,i.onError=t.onError,i.onProgress=t.onProgress,e.send(null),n}},{key:"onProgress",value:function(t,e){var n,i=this.pendingRequests[t];i&&(null===(n=i.onProgress)||void 0===n||n.call(i,e))}},{key:"onStateChange",value:function(t,e){var n=this.pendingRequests[t];if(n){var i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4===i.readyState&&t in this.pendingRequests)if(delete this.pendingRequests[t],0===i.status&&this.isHttp)n.onError(i.status);else{var r=i.status||200;if(200===r&&206===n.expectedStatus||r===n.expectedStatus){var a=function(t){var e=t.response;return"string"!=typeof e?e:Gr(e).buffer}(i);if(206===r){var s=i.getResponseHeader("Content-Range"),o=/bytes (\d+)-(\d+)\/(\d+)/.exec(s);o?n.onDone({begin:parseInt(o[1],10),chunk:a}):(Rr('Missing or invalid "Content-Range" header.'),n.onError(0))}else a?n.onDone({begin:0,chunk:a}):n.onError(i.status)}else n.onError(i.status)}}}},{key:"getRequestXhr",value:function(t){return this.pendingRequests[t].xhr}},{key:"isPendingRequest",value:function(t){return t in this.pendingRequests}},{key:"abortRequest",value:function(t){var e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}])}(),ld=function(){return m((function t(e){c(this,t),this._source=e,this._manager=new od(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}),[{key:"_onRangeRequestReaderClosed",value:function(t){var e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}},{key:"getFullReader",value:function(){return Ir(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new ud(this._manager,this._source),this._fullRequestReader}},{key:"getRangeReader",value:function(t,e){var n=new hd(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}},{key:"cancelAllRequests",value:function(t){var e;null===(e=this._fullRequestReader)||void 0===e||e.cancel(t);var n,i=w(this._rangeRequestReaders.slice(0));try{for(i.s();!(n=i.n()).done;){n.value.cancel(t)}}catch(r){i.e(r)}finally{i.f()}}}])}(),ud=function(){return m((function e(t,n){c(this,e),this._manager=t,this._url=n.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=n.disableRange||!1,this._contentLength=n.length,this._rangeChunkSize=n.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=undefined,this._filename=null,this.onProgress=null}),[{key:"_onHeadersReceived",value:function(){var t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=Jc(e.responseURL);var n=e.getAllResponseHeaders(),i=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map((function(t){var e=O(t.split(": "));return[e[0],e.slice(1).join(": ")]})):[]),r=Zc({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange}),a=r.allowRangeRequests,s=r.suggestedLength;a&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=$c(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}},{key:"_onDone",value:function(t){t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk));if(this._done=!0,!(this._cachedChunks.length>0)){var e,n=w(this._requests);try{for(n.s();!(e=n.n()).done;){e.value.resolve({value:undefined,done:!0})}}catch(i){n.e(i)}finally{n.f()}this._requests.length=0}}},{key:"_onError",value:function(t){this._storedError=td(t,this._url),this._headersCapability.reject(this._storedError);var e,n=w(this._requests);try{for(n.s();!(e=n.n()).done;){e.value.reject(this._storedError)}}catch(i){n.e(i)}finally{n.f()}this._requests.length=0,this._cachedChunks.length=0}},{key:"_onProgress",value:function(t){var e;null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}},{key:"filename",get:function(){return this._filename}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"contentLength",get:function(){return this._contentLength}},{key:"headersReady",get:function(){return this._headersCapability.promise}},{key:"read",value:(t=l(T().m((function n(){var t,e;return T().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,this._headersCapability.promise;case 1:if(!this._storedError){n.n=2;break}throw this._storedError;case 2:if(!(this._cachedChunks.length>0)){n.n=3;break}return t=this._cachedChunks.shift(),n.a(2,{value:t,done:!1});case 3:if(!this._done){n.n=4;break}return n.a(2,{value:undefined,done:!0});case 4:return e=Promise.withResolvers(),this._requests.push(e),n.a(2,e.promise)}}),n,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(t){this._done=!0,this._headersCapability.reject(t);var e,n=w(this._requests);try{for(n.s();!(e=n.n()).done;){e.value.resolve({value:undefined,done:!0})}}catch(i){n.e(i)}finally{n.f()}this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}]);var t}(),hd=function(){return m((function e(t,n,i){c(this,e),this._manager=t,this._url=t.url,this._requestId=t.request({begin:n,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=undefined,this.onProgress=null,this.onClosed=null}),[{key:"_onHeadersReceived",value:function(){var t,e=Jc(null===(t=this._manager.getRequestXhr(this._requestId))||void 0===t?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error('Expected range response-origin "'.concat(e,'" to match "').concat(this._manager._responseOrigin,'".')),this._onError(0))}},{key:"_close",value:function(){var t;null===(t=this.onClosed)||void 0===t||t.call(this,this)}},{key:"_onDone",value:function(t){var e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e;this._done=!0;var n,i=w(this._requests);try{for(i.s();!(n=i.n()).done;){n.value.resolve({value:undefined,done:!0})}}catch(r){i.e(r)}finally{i.f()}this._requests.length=0,this._close()}},{key:"_onError",value:function(t){var e;null!==(e=this._storedError)&&void 0!==e||(this._storedError=td(t,this._url));var n,i=w(this._requests);try{for(i.s();!(n=i.n()).done;){n.value.reject(this._storedError)}}catch(r){i.e(r)}finally{i.f()}this._requests.length=0,this._queuedChunk=null}},{key:"_onProgress",value:function(t){var e;this.isStreamingSupported||(null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:t.loaded}))}},{key:"isStreamingSupported",get:function(){return!1}},{key:"read",value:(t=l(T().m((function n(){var t,e;return T().w((function(n){for(;;)switch(n.n){case 0:if(!this._storedError){n.n=1;break}throw this._storedError;case 1:if(null===this._queuedChunk){n.n=2;break}return t=this._queuedChunk,this._queuedChunk=null,n.a(2,{value:t,done:!1});case 2:if(!this._done){n.n=3;break}return n.a(2,{value:undefined,done:!0});case 3:return e=Promise.withResolvers(),this._requests.push(e),n.a(2,e.promise)}}),n,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(t){this._done=!0;var e,n=w(this._requests);try{for(n.s();!(e=n.n()).done;){e.value.resolve({value:undefined,done:!0})}}catch(i){n.e(i)}finally{n.f()}this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}]);var t}(),cd=/^[a-z][a-z0-9\-+.]+:/i;var dd=function(){return m((function t(e){c(this,t),this.source=e,this.url=function(t){if(cd.test(t))return new URL(t);var e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(t))}(e.url),Ir("file:"===this.url.protocol,"PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}),[{key:"_progressiveDataLength",get:function(){var t,e;return null!==(t=null===(e=this._fullRequestReader)||void 0===e?void 0:e._loaded)&&void 0!==t?t:0}},{key:"getFullReader",value:function(){return Ir(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new fd(this),this._fullRequestReader}},{key:"getRangeReader",value:function(t,e){if(e<=this._progressiveDataLength)return null;var n=new vd(this,t,e);return this._rangeRequestReaders.push(n),n}},{key:"cancelAllRequests",value:function(t){var e;null===(e=this._fullRequestReader)||void 0===e||e.cancel(t);var n,i=w(this._rangeRequestReaders.slice(0));try{for(i.s();!(n=i.n()).done;){n.value.cancel(t)}}catch(r){i.e(r)}finally{i.f()}}}])}(),fd=function(){return m((function e(t){var n=this;c(this,e),this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;var i=t.source;this._contentLength=i.length,this._loaded=0,this._filename=null,this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();var r=process.getBuiltinModule("fs");r.promises.lstat(this._url).then((function(t){n._contentLength=t.size,n._setReadableStream(r.createReadStream(n._url)),n._headersCapability.resolve()}),(function(t){"ENOENT"===t.code&&(t=td(0,n._url.href)),n._storedError=t,n._headersCapability.reject(t)}))}),[{key:"headersReady",get:function(){return this._headersCapability.promise}},{key:"filename",get:function(){return this._filename}},{key:"contentLength",get:function(){return this._contentLength}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"read",value:(t=l(T().m((function n(){var t,e,i;return T().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,this._readCapability.promise;case 1:if(!this._done){n.n=2;break}return n.a(2,{value:undefined,done:!0});case 2:if(!this._storedError){n.n=3;break}throw this._storedError;case 3:if(null!==(e=this._readableStream.read())){n.n=4;break}return this._readCapability=Promise.withResolvers(),n.a(2,this.read());case 4:return this._loaded+=e.length,null===(t=this.onProgress)||void 0===t||t.call(this,{loaded:this._loaded,total:this._contentLength}),i=new Uint8Array(e).buffer,n.a(2,{value:i,done:!1})}}),n,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}},{key:"_error",value:function(t){this._storedError=t,this._readCapability.resolve()}},{key:"_setReadableStream",value:function(t){var e=this;this._readableStream=t,t.on("readable",(function(){e._readCapability.resolve()})),t.on("end",(function(){t.destroy(),e._done=!0,e._readCapability.resolve()})),t.on("error",(function(t){e._error(t)})),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Ur("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}]);var t}(),vd=function(){return m((function e(t,n,i){c(this,e),this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();var r=t.source;this._isStreamingSupported=!r.disableStream;var a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:n,end:i-1}))}),[{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"read",value:(t=l(T().m((function n(){var t,e,i;return T().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,this._readCapability.promise;case 1:if(!this._done){n.n=2;break}return n.a(2,{value:undefined,done:!0});case 2:if(!this._storedError){n.n=3;break}throw this._storedError;case 3:if(null!==(e=this._readableStream.read())){n.n=4;break}return this._readCapability=Promise.withResolvers(),n.a(2,this.read());case 4:return this._loaded+=e.length,null===(t=this.onProgress)||void 0===t||t.call(this,{loaded:this._loaded}),i=new Uint8Array(e).buffer,n.a(2,{value:i,done:!1})}}),n,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}},{key:"_error",value:function(t){this._storedError=t,this._readCapability.resolve()}},{key:"_setReadableStream",value:function(t){var e=this;this._readableStream=t,t.on("readable",(function(){e._readCapability.resolve()})),t.on("end",(function(){t.destroy(),e._done=!0,e._readCapability.resolve()})),t.on("error",(function(t){e._error(t)})),this._storedError&&this._readableStream.destroy(this._storedError)}}]);var t}(),pd=Symbol("INITIAL_DATA"),gd=new WeakMap,yd=new WeakSet,md=function(){return m((function t(){c(this,t),g(this,yd),f(this,gd,Object.create(null))}),[{key:"get",value:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(e){var n=r(yd,this,wd).call(this,t);return n.promise.then((function(){return e(n.data)})),null}var i=d(gd,this)[t];if(!i||i.data===pd)throw new Error("Requesting object that isn't resolved yet ".concat(t,"."));return i.data}},{key:"has",value:function(t){var e=d(gd,this)[t];return!!e&&e.data!==pd}},{key:"delete",value:function(t){var e=d(gd,this)[t];return!(!e||e.data===pd)&&(delete d(gd,this)[t],!0)}},{key:"resolve",value:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null,n=r(yd,this,wd).call(this,t);n.data=e,n.resolve()}},{key:"clear",value:function(){for(var t in d(gd,this)){var e,n=d(gd,this)[t].data;null==n||null===(e=n.bitmap)||void 0===e||e.close()}v(gd,this,Object.create(null))}},{key:Symbol.iterator,value:T().m((function e(){var t,n,i,r;return T().w((function(e){for(;;)switch(e.n){case 0:i=P(d(gd,this));case 1:if((r=i()).done){e.n=4;break}if(t=r.value,(n=d(gd,this)[t].data)!==pd){e.n=2;break}return e.a(3,1);case 2:return e.n=3,[t,n];case 3:e.n=1;break;case 4:return e.a(2)}}),e,this)}))}])}();function wd(t){var e;return(e=d(gd,this))[t]||(e[t]=C(C({},Promise.withResolvers()),{},{data:pd}))}var bd=new WeakMap,kd=new WeakMap,Ad=new WeakMap,_d=new WeakMap,xd=new WeakMap,Sd=new WeakMap,Ed=new WeakMap,Md=new WeakMap,Cd=new WeakMap,Td=new WeakMap,Rd=new WeakMap,Pd=new WeakMap,Id=new WeakMap,Dd=new WeakMap,Ld=new WeakMap,Od=new WeakMap,Fd=new WeakMap,Nd=new WeakMap,Wd=new WeakSet,Bd=function(){function t(e){var n,i=this,r=e.textContentSource,a=e.container,s=e.viewport;if(c(this,t),g(this,Wd),f(this,bd,Promise.withResolvers()),f(this,kd,null),f(this,Ad,!1),f(this,_d,!(null===(n=globalThis.FontInspector)||void 0===n||!n.enabled)),f(this,xd,null),f(this,Sd,null),f(this,Ed,0),f(this,Md,0),f(this,Cd,null),f(this,Td,null),f(this,Rd,0),f(this,Pd,0),f(this,Id,Object.create(null)),f(this,Dd,[]),f(this,Ld,null),f(this,Od,[]),f(this,Fd,new WeakMap),f(this,Nd,null),r instanceof ReadableStream)v(Ld,this,r);else{if("object"!==B(r))throw new Error('No "textContentSource" parameter specified.');v(Ld,this,new ReadableStream({start:function(t){t.enqueue(r),t.close()}}))}v(kd,this,v(Td,this,a)),v(Pd,this,s.scale*xa.pixelRatio),v(Rd,this,s.rotation),v(Sd,this,{div:null,properties:null,ctx:null});var o=s.rawDims,l=o.pageWidth,u=o.pageHeight,h=o.pageX,p=o.pageY;v(Nd,this,[1,0,0,-1,-h,p+u]),v(Md,this,l),v(Ed,this,u),Vd.call(t),_a(a,s),d(bd,this).promise["finally"]((function(){Jd._["delete"](i),v(Sd,i,null),v(Id,i,null)}))["catch"]((function(){}))}return m(t,[{key:"render",value:function(){var t=this,e=function(){d(Cd,t).read().then((function(n){var i,a=n.value;n.done?d(bd,t).resolve():(null!==(i=d(xd,t))&&void 0!==i||v(xd,t,a.lang),Object.assign(d(Id,t),a.styles),r(Wd,t,jd).call(t,a.items),e())}),d(bd,t).reject)};return v(Cd,this,d(Ld,this).getReader()),Jd._.add(this),e(),d(bd,this).promise}},{key:"update",value:function(e){var n=e.viewport,i=e.onBefore,a=void 0===i?null:i,s=n.scale*xa.pixelRatio,o=n.rotation;if(o!==d(Rd,this)&&(null==a||a(),v(Rd,this,o),_a(d(Td,this),{rotation:o})),s!==d(Pd,this)){null==a||a(),v(Pd,this,s);var l,u={div:null,properties:null,ctx:zd.call(t,d(xd,this))},h=w(d(Od,this));try{for(h.s();!(l=h.n()).done;){var c=l.value;u.properties=d(Fd,this).get(c),u.div=c,r(Wd,this,Ud).call(this,u)}}catch(f){h.e(f)}finally{h.f()}}}},{key:"cancel",value:function(){var t,e=new Ur("TextLayer task cancelled.");null===(t=d(Cd,this))||void 0===t||t.cancel(e)["catch"]((function(){})),v(Cd,this,null),d(bd,this).reject(e)}},{key:"textDivs",get:function(){return d(Od,this)}},{key:"textContentItemsStr",get:function(){return d(Dd,this)}}],[{key:"fontFamilyMap",get:function(){var t=Vr.platform,e=t.isWindows,n=t.isFirefox;return Or(this,"fontFamilyMap",new Map([["sans-serif","".concat(e&&n?"Calibri, ":"","sans-serif")],["monospace","".concat(e&&n?"Lucida Console, ":"","monospace")]]))}},{key:"cleanup",value:function(){if(!(r(t,this,Jd)._.size>0)){r(t,this,Xd)._.clear();var e,n=w(r(t,this,Yd)._.values());try{for(n.s();!(e=n.n()).done;){e.value.canvas.remove()}}catch(i){n.e(i)}finally{n.f()}r(t,this,Yd)._.clear()}}}])}();function jd(t){var e,n;if(!d(Ad,this)){null!==(n=(e=d(Sd,this)).ctx)&&void 0!==n||(e.ctx=zd.call(Ei,d(xd,this)));var i,a=d(Od,this),s=d(Dd,this),o=w(t);try{for(o.s();!(i=o.n()).done;){var l=i.value;if(a.length>1e5)return Rr("Ignoring additional textDivs for performance reasons."),void v(Ad,this,!0);if(l.str!==undefined)s.push(l.str),r(Wd,this,Hd).call(this,l);else if("beginMarkedContentProps"===l.type||"beginMarkedContent"===l.type){var u=d(kd,this);v(kd,this,document.createElement("span")),d(kd,this).classList.add("markedContent"),l.id&&d(kd,this).setAttribute("id","".concat(l.id)),u.append(d(kd,this))}else"endMarkedContent"===l.type&&v(kd,this,d(kd,this).parentNode)}}catch(h){o.e(h)}finally{o.f()}}}function Hd(t){var e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:""!==t.str,hasEOL:t.hasEOL,fontSize:0};d(Od,this).push(e);var i=Xr.transform(d(Nd,this),t.transform),a=Math.atan2(i[1],i[0]),s=d(Id,this)[t.fontName];s.vertical&&(a+=Math.PI/2);var o=d(_d,this)&&s.fontSubstitution||s.fontFamily;o=Ei.fontFamilyMap.get(o)||o;var l,u,h=Math.hypot(i[2],i[3]),c=h*qd.call(Ei,o,s,d(xd,this));0===a?(l=i[4],u=i[5]-c):(l=i[4]+c*Math.sin(a),u=i[5]-c*Math.cos(a));var f="calc(var(--total-scale-factor) *",v=e.style;d(kd,this)===d(Td,this)?(v.left="".concat((100*l/d(Md,this)).toFixed(2),"%"),v.top="".concat((100*u/d(Ed,this)).toFixed(2),"%")):(v.left="".concat(f).concat(l.toFixed(2),"px)"),v.top="".concat(f).concat(u.toFixed(2),"px)")),v.fontSize="".concat(f).concat((Qd._*h).toFixed(2),"px)"),v.fontFamily=o,n.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,d(_d,this)&&(e.dataset.fontName=s.fontSubstitutionLoadedName||t.fontName),0!==a&&(n.angle=a*(180/Math.PI));var p=!1;if(t.str.length>1)p=!0;else if(" "!==t.str&&t.transform[0]!==t.transform[3]){var g=Math.abs(t.transform[0]),y=Math.abs(t.transform[3]);g!==y&&Math.max(g,y)/Math.min(g,y)>1.5&&(p=!0)}if(p&&(n.canvasWidth=s.vertical?t.height:t.width),d(Fd,this).set(e,n),d(Sd,this).div=e,d(Sd,this).properties=n,r(Wd,this,Ud).call(this,d(Sd,this)),n.hasText&&d(kd,this).append(e),n.hasEOL){var m=document.createElement("br");m.setAttribute("role","presentation"),d(kd,this).append(m)}}function Ud(t){var e=t.div,n=t.properties,i=t.ctx,r=e.style,a="";if(Qd._>1&&(a="scale(".concat(1/Qd._,")")),0!==n.canvasWidth&&n.hasText){var s=r.fontFamily,o=n.canvasWidth,l=n.fontSize;Gd.call(Ei,i,l*d(Pd,this),s);var u=i.measureText(e.textContent).width;u>0&&(a="scaleX(".concat(o*d(Pd,this)/u,") ").concat(a))}0!==n.angle&&(a="rotate(".concat(n.angle,"deg) ").concat(a)),a.length>0&&(r.transform=a)}function zd(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null,e=r(Ei,this,Yd)._.get(t||(t=""));if(!e){var n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),r(Ei,this,Yd)._.set(t,e),r(Ei,this,Kd)._.set(e,{size:0,family:""})}return e}function Gd(t,e,n){var i=r(Ei,this,Kd)._.get(t);e===i.size&&n===i.family||(t.font="".concat(e,"px ").concat(n),i.size=e,i.family=n)}function Vd(){if(null===r(Ei,this,Qd)._){var t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),Qd._=r(Ei,this,t.getBoundingClientRect().height),t.remove()}}function qd(t,e,n){var i=r(Ei,this,Xd)._.get(t);if(i)return i;var a=r(Ei,this,zd).call(this,n);a.canvas.width=a.canvas.height=30,r(Ei,this,Gd).call(this,a,30,t);var s=a.measureText(""),o=s.fontBoundingBoxAscent,l=Math.abs(s.fontBoundingBoxDescent);a.canvas.width=a.canvas.height=0;var u=.8;return o?u=o/(o+l):(Vr.platform.isFirefox&&Rr("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?u=e.ascent:e.descent&&(u=1+e.descent)),r(Ei,this,Xd)._.set(t,u),u}Ei=Bd;var Xd={_:new Map},Yd={_:new Map},Kd={_:new WeakMap},Qd={_:null},Jd={_:new Set},Zd=function(){function t(){c(this,t)}return m(t,null,[{key:"textContent",value:function(e){var n=[],i={items:n,styles:Object.create(null)};return function r(e){var i;if(e){var a=null,s=e.name;if("#text"===s)a=e.value;else{if(!t.shouldBuildText(s))return;null!=e&&null!==(i=e.attributes)&&void 0!==i&&i.textContent?a=e.attributes.textContent:e.value&&(a=e.value)}if(null!==a&&n.push({str:a}),e.children){var o,l=w(e.children);try{for(l.s();!(o=l.n()).done;){r(o.value)}}catch(u){l.e(u)}finally{l.f()}}}}(e),i}},{key:"shouldBuildText",value:function(t){return!("textarea"===t||"input"===t||"option"===t||"select"===t)}}])}();function $d(){var t,e,n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};"string"==typeof n||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});var i=new tf,r=i.docId,a=n.url?function(t){if(t instanceof URL)return t.href;if("string"==typeof t){if(Gi)return t;var e=URL.parse(t,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}(n.url):null,s=n.data?function(t){if(Gi&&"undefined"!=typeof Buffer&&t instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength)return t;if("string"==typeof t)return Gr(t);if(t instanceof ArrayBuffer||ArrayBuffer.isView(t)||"object"===B(t)&&!isNaN(null==t?void 0:t.length))return new Uint8Array(t);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}(n.data):null,o=n.httpHeaders||null,l=!0===n.withCredentials,u=null!==(t=n.password)&&void 0!==t?t:null,h=n.range instanceof lf?n.range:null,c=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:Math.pow(2,16),d=n.worker instanceof wf?n.worker:null,f=n.verbosity,v="string"!=typeof n.docBaseUrl||ua(n.docBaseUrl)?null:n.docBaseUrl,p=Ru(n.cMapUrl),g=!1!==n.cMapPacked,y=n.CMapReaderFactory||(Gi?zh:sh),m=Ru(n.iccUrl),w=Ru(n.standardFontDataUrl),b=n.StandardFontDataFactory||(Gi?Gh:Rh),k=Ru(n.wasmUrl),A=n.WasmFactory||(Gi?Vh:Ih),_=!0!==n.stopAtErrors,x=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,S=!1!==n.isEvalSupported,E="boolean"==typeof n.isOffscreenCanvasSupported?n.isOffscreenCanvasSupported:!Gi,M="boolean"==typeof n.isImageDecoderSupported?n.isImageDecoderSupported:!Gi&&(Vr.platform.isFirefox||!globalThis.chrome),C=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,T="boolean"==typeof n.disableFontFace?n.disableFontFace:Gi,R=!0===n.fontExtraProperties,P=!0===n.enableXfa,I=n.ownerDocument||globalThis.document,D=!0===n.disableRange,L=!0===n.disableStream,O=!0===n.disableAutoFetch,F=!0===n.pdfBug,N=n.CanvasFactory||(Gi?Uh:rh),W=n.FilterFactory||(Gi?Hh:gh),j=!0===n.enableHWA,H=!1!==n.useWasm,U=h?h.length:null!==(e=n.length)&&void 0!==e?e:NaN,z="boolean"==typeof n.useSystemFonts?n.useSystemFonts:!Gi&&!T,G="boolean"==typeof n.useWorkerFetch?n.useWorkerFetch:!!(y===sh&&b===Rh&&A===Ih&&p&&w&&k&&va(p,document.baseURI)&&va(w,document.baseURI)&&va(k,document.baseURI));Mr(f);var V={canvasFactory:new N({ownerDocument:I,enableHWA:j}),filterFactory:new W({docId:r,ownerDocument:I}),cMapReaderFactory:G?null:new y({baseUrl:p,isCompressed:g}),standardFontDataFactory:G?null:new b({baseUrl:w}),wasmFactory:G?null:new A({baseUrl:k})};d||(d=wf.create({verbosity:f,port:Cc.workerPort}),i._worker=d);var q={docId:r,apiVersion:"5.4.78",data:s,password:u,disableAutoFetch:O,rangeChunkSize:c,length:U,docBaseUrl:v,enableXfa:P,evaluatorOptions:{maxImageSize:x,disableFontFace:T,ignoreErrors:_,isEvalSupported:S,isOffscreenCanvasSupported:E,isImageDecoderSupported:M,canvasMaxAreaInBytes:C,fontExtraProperties:R,useSystemFonts:z,useWasm:H,useWorkerFetch:G,cMapUrl:p,iccUrl:m,standardFontDataUrl:w,wasmUrl:k}},X={ownerDocument:I,pdfBug:F,styleElement:null,loadingParams:{disableAutoFetch:O,enableXfa:P}};return d.promise.then((function(){if(i.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");var t,e=d.messageHandler.sendWithPromise("GetDocRequest",q,s?[s.buffer]:null);if(h)t=new Xc(h,{disableRange:D,disableStream:L});else if(!s){if(!a)throw new Error("getDocument - no `url` parameter provided.");var n=va(a)?rd:Gi?dd:ld;t=new n({url:a,length:U,httpHeaders:o,withCredentials:l,rangeChunkSize:c,disableRange:D,disableStream:L})}return e.then((function(e){if(i.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");var n=new Qu(r,e,d.port),a=new Lf(n,i,t,X,V,j);i._transport=a,n.send("Ready",null)}))}))["catch"](i._capability.reject),i}var tf=function(){return m((function n(){c(this,n),b(this,"_capability",Promise.withResolvers()),b(this,"_transport",null),b(this,"_worker",null),b(this,"docId","d".concat((ef._=(Mi=ef._,Ci=Mi++,Mi),Ci))),b(this,"destroyed",!1),b(this,"onPassword",null),b(this,"onProgress",null)}),[{key:"promise",get:function(){return this._capability.promise}},{key:"destroy",value:(e=l(T().m((function i(){var t,e,n,r,a;return T().w((function(i){for(;;)switch(i.p=i.n){case 0:return this.destroyed=!0,i.p=1,null!==(e=this._worker)&&void 0!==e&&e.port&&(this._worker._pendingDestroy=!0),i.n=2,null===(n=this._transport)||void 0===n?void 0:n.destroy();case 2:i.n=4;break;case 3:throw i.p=3,a=i.v,null!==(r=this._worker)&&void 0!==r&&r.port&&delete this._worker._pendingDestroy,a;case 4:this._transport=null,null===(t=this._worker)||void 0===t||t.destroy(),this._worker=null;case 5:return i.a(2)}}),i,this,[[1,3]])}))),function(){return e.apply(this,arguments)})},{key:"getData",value:(t=l(T().m((function r(){return T().w((function(t){for(;;)if(0===t.n)return t.a(2,this._transport.getData())}),r,this)}))),function(){return t.apply(this,arguments)})}]);var t,e}(),ef={_:0},nf=new WeakMap,rf=new WeakMap,af=new WeakMap,sf=new WeakMap,of=new WeakMap,lf=function(){return m((function t(e,n){var i=arguments.length>2&&arguments[2]!==undefined&&arguments[2],r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;c(this,t),f(this,nf,Promise.withResolvers()),f(this,rf,[]),f(this,af,[]),f(this,sf,[]),f(this,of,[]),this.length=e,this.initialData=n,this.progressiveDone=i,this.contentDispositionFilename=r}),[{key:"addRangeListener",value:function(t){d(of,this).push(t)}},{key:"addProgressListener",value:function(t){d(sf,this).push(t)}},{key:"addProgressiveReadListener",value:function(t){d(af,this).push(t)}},{key:"addProgressiveDoneListener",value:function(t){d(rf,this).push(t)}},{key:"onDataRange",value:function(t,e){var n,i=w(d(of,this));try{for(i.s();!(n=i.n()).done;){(0,n.value)(t,e)}}catch(r){i.e(r)}finally{i.f()}}},{key:"onDataProgress",value:function(t,e){var n=this;d(nf,this).promise.then((function(){var i,r=w(d(sf,n));try{for(r.s();!(i=r.n()).done;){(0,i.value)(t,e)}}catch(a){r.e(a)}finally{r.f()}}))}},{key:"onDataProgressiveRead",value:function(t){var e=this;d(nf,this).promise.then((function(){var n,i=w(d(af,e));try{for(i.s();!(n=i.n()).done;){(0,n.value)(t)}}catch(r){i.e(r)}finally{i.f()}}))}},{key:"onDataProgressiveDone",value:function(){var t=this;d(nf,this).promise.then((function(){var e,n=w(d(rf,t));try{for(n.s();!(e=n.n()).done;){(0,e.value)()}}catch(i){n.e(i)}finally{n.f()}}))}},{key:"transportReady",value:function(){d(nf,this).resolve()}},{key:"requestDataRange",value:function(t,e){Pr("Abstract method PDFDataRangeTransport.requestDataRange")}},{key:"abort",value:function(){}}])}(),uf=function(){return m((function t(e,n){c(this,t),this._pdfInfo=e,this._transport=n}),[{key:"annotationStorage",get:function(){return this._transport.annotationStorage}},{key:"canvasFactory",get:function(){return this._transport.canvasFactory}},{key:"filterFactory",get:function(){return this._transport.filterFactory}},{key:"numPages",get:function(){return this._pdfInfo.numPages}},{key:"fingerprints",get:function(){return this._pdfInfo.fingerprints}},{key:"isPureXfa",get:function(){return Or(this,"isPureXfa",!!this._transport._htmlForXfa)}},{key:"allXfaHtml",get:function(){return this._transport._htmlForXfa}},{key:"getPage",value:function(t){return this._transport.getPage(t)}},{key:"getPageIndex",value:function(t){return this._transport.getPageIndex(t)}},{key:"getDestinations",value:function(){return this._transport.getDestinations()}},{key:"getDestination",value:function(t){return this._transport.getDestination(t)}},{key:"getPageLabels",value:function(){return this._transport.getPageLabels()}},{key:"getPageLayout",value:function(){return this._transport.getPageLayout()}},{key:"getPageMode",value:function(){return this._transport.getPageMode()}},{key:"getViewerPreferences",value:function(){return this._transport.getViewerPreferences()}},{key:"getOpenAction",value:function(){return this._transport.getOpenAction()}},{key:"getAttachments",value:function(){return this._transport.getAttachments()}},{key:"getJSActions",value:function(){return this._transport.getDocJSActions()}},{key:"getOutline",value:function(){return this._transport.getOutline()}},{key:"getOptionalContentConfig",value:function(){var t=(arguments.length>0&&arguments[0]!==undefined?arguments[0]:{}).intent,e=void 0===t?"display":t,n=this._transport.getRenderingIntent(e).renderingIntent;return this._transport.getOptionalContentConfig(n)}},{key:"getPermissions",value:function(){return this._transport.getPermissions()}},{key:"getMetadata",value:function(){return this._transport.getMetadata()}},{key:"getMarkInfo",value:function(){return this._transport.getMarkInfo()}},{key:"getData",value:function(){return this._transport.getData()}},{key:"saveDocument",value:function(){return this._transport.saveDocument()}},{key:"getDownloadInfo",value:function(){return this._transport.downloadInfoCapability.promise}},{key:"cleanup",value:function(){var t=arguments.length>0&&arguments[0]!==undefined&&arguments[0];return this._transport.startCleanup(t||this.isPureXfa)}},{key:"destroy",value:function(){return this.loadingTask.destroy()}},{key:"cachedPageNumber",value:function(t){return this._transport.cachedPageNumber(t)}},{key:"loadingParams",get:function(){return this._transport.loadingParams}},{key:"loadingTask",get:function(){return this._transport.loadingTask}},{key:"getFieldObjects",value:function(){return this._transport.getFieldObjects()}},{key:"hasJSActions",value:function(){return this._transport.hasJSActions()}},{key:"getCalculationOrderIds",value:function(){return this._transport.getCalculationOrderIds()}}])}(),hf=new WeakMap,cf=new WeakSet,df=function(){return m((function e(t,n,i){var r=arguments.length>3&&arguments[3]!==undefined&&arguments[3];c(this,e),g(this,cf),f(this,hf,!1),this._pageIndex=t,this._pageInfo=n,this._transport=i,this._stats=r?new fa:null,this._pdfBug=r,this.commonObjs=i.commonObjs,this.objs=new md,this._intentStates=new Map,this.destroyed=!1}),[{key:"pageNumber",get:function(){return this._pageIndex+1}},{key:"rotate",get:function(){return this._pageInfo.rotate}},{key:"ref",get:function(){return this._pageInfo.ref}},{key:"userUnit",get:function(){return this._pageInfo.userUnit}},{key:"view",get:function(){return this._pageInfo.view}},{key:"getViewport",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},e=t.scale,n=t.rotation,i=void 0===n?this.rotate:n,r=t.offsetX,a=void 0===r?0:r,s=t.offsetY,o=void 0===s?0:s,l=t.dontFlip,u=void 0!==l&&l;return new oa({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:i,offsetX:a,offsetY:o,dontFlip:u})}},{key:"getAnnotations",value:function(){var t=(arguments.length>0&&arguments[0]!==undefined?arguments[0]:{}).intent,e=void 0===t?"display":t,n=this._transport.getRenderingIntent(e).renderingIntent;return this._transport.getAnnotations(this._pageIndex,n)}},{key:"getJSActions",value:function(){return this._transport.getPageJSActions(this._pageIndex)}},{key:"filterFactory",get:function(){return this._transport.filterFactory}},{key:"isPureXfa",get:function(){return Or(this,"isPureXfa",!!this._transport._htmlForXfa)}},{key:"getXfa",value:(t=l(T().m((function n(){var t;return T().w((function(e){for(;;)if(0===e.n)return e.a(2,(null===(t=this._transport._htmlForXfa)||void 0===t?void 0:t.children[this._pageIndex])||null)}),n,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(t){var e,n,i=this,a=t.canvasContext,s=t.canvas,o=void 0===s?a.canvas:s,l=t.viewport,u=t.intent,h=void 0===u?"display":u,c=t.annotationMode,d=void 0===c?er.ENABLE:c,f=t.transform,p=void 0===f?null:f,g=t.background,y=void 0===g?null:g,m=t.optionalContentConfigPromise,w=void 0===m?null:m,b=t.annotationCanvasMap,k=void 0===b?null:b,A=t.pageColors,_=void 0===A?null:A,x=t.printAnnotationStorage,S=void 0===x?null:x,E=t.isEditing,M=void 0!==E&&E;null===(e=this._stats)||void 0===e||e.time("Overall");var C=this._transport.getRenderingIntent(h,d,S,M),T=C.renderingIntent,R=C.cacheKey;v(hf,this,!1),w||(w=this._transport.getOptionalContentConfig(T));var P=this._intentStates.get(R);P||(P=Object.create(null),this._intentStates.set(R,P)),P.streamReaderCancelTimeout&&(clearTimeout(P.streamReaderCancelTimeout),P.streamReaderCancelTimeout=null);var I,L=!!(T&Ki);P.displayReadyCapability||(P.displayReadyCapability=Promise.withResolvers(),P.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},null===(I=this._stats)||void 0===I||I.time("Page Request"),this._pumpOperatorList(C));var O=function(t){var e;(P.renderTasks["delete"](F),L&&v(hf,i,!0),r(cf,i,ff).call(i),t?(F.capability.reject(t),i._abortOperatorList({intentState:P,reason:t instanceof Error?t:new Error(t)})):F.capability.resolve(),i._stats)&&(i._stats.timeEnd("Rendering"),i._stats.timeEnd("Overall"),null!==(e=globalThis.Stats)&&void 0!==e&&e.enabled&&globalThis.Stats.add(i.pageNumber,i._stats))},F=new Bf({callback:O,params:{canvas:o,canvasContext:a,viewport:l,transform:p,background:y},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:k,operatorList:P.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!L,pdfBug:this._pdfBug,pageColors:_,enableHWA:this._transport.enableHWA});((n=P).renderTasks||(n.renderTasks=new Set)).add(F);var N=F.task;return Promise.all([P.displayReadyCapability.promise,w]).then((function(t){var e,n=D(t,2),r=n[0],a=n[1];if(i.destroyed)O();else{if(null===(e=i._stats)||void 0===e||e.time("Rendering"),!(a.renderingIntent&T))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");F.initializeGraphics({transparency:r,optionalContentConfig:a}),F.operatorListChanged()}}))["catch"](O),N}},{key:"getOperatorList",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},e=t.intent,n=void 0===e?"display":e,i=t.annotationMode,r=void 0===i?er.ENABLE:i,a=t.printAnnotationStorage,s=void 0===a?null:a,o=t.isEditing,l=void 0!==o&&o;var u,h,c,d=this._transport.getRenderingIntent(n,r,s,l,!0),f=this._intentStates.get(d.cacheKey);(f||(f=Object.create(null),this._intentStates.set(d.cacheKey,f)),f.opListReadCapability)||((u=Object.create(null)).operatorListChanged=function(){f.operatorList.lastChunk&&(f.opListReadCapability.resolve(f.operatorList),f.renderTasks["delete"](u))},f.opListReadCapability=Promise.withResolvers(),((h=f).renderTasks||(h.renderTasks=new Set)).add(u),f.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},null===(c=this._stats)||void 0===c||c.time("Page Request"),this._pumpOperatorList(d));return f.opListReadCapability.promise}},{key:"streamTextContent",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},e=t.includeMarkedContent,n=void 0!==e&&e,i=t.disableNormalization,r=void 0!==i&&i;return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===n,disableNormalization:!0===r},{highWaterMark:100,size:function(t){return t.items.length}})}},{key:"getTextContent",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(this._transport._htmlForXfa)return this.getXfa().then((function(t){return Zd.textContent(t)}));var e=this.streamTextContent(t);return new Promise((function(t,n){var i=e.getReader(),r={items:[],styles:Object.create(null),lang:null};!function a(){i.read().then((function(e){var n,i,s=e.value;e.done?t(r):(null!==(n=r.lang)&&void 0!==n||(r.lang=s.lang),Object.assign(r.styles,s.styles),(i=r.items).push.apply(i,F(s.items)),a())}),n)}()}))}},{key:"getStructTree",value:function(){return this._transport.getStructTree(this._pageIndex)}},{key:"_destroy",value:function(){this.destroyed=!0;var t,e=[],n=w(this._intentStates.values());try{for(n.s();!(t=n.n()).done;){var i=t.value;if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!i.opListReadCapability){var r,a=w(i.renderTasks);try{for(a.s();!(r=a.n()).done;){var s=r.value;e.push(s.completed),s.cancel()}}catch(o){a.e(o)}finally{a.f()}}}}catch(o){n.e(o)}finally{n.f()}return this.objs.clear(),v(hf,this,!1),Promise.all(e)}},{key:"cleanup",value:function(){var t=arguments.length>0&&arguments[0]!==undefined&&arguments[0];v(hf,this,!0);var e=r(cf,this,ff).call(this);return t&&e&&this._stats&&(this._stats=new fa),e}},{key:"_startRenderPage",value:function(t,e){var n,i,r=this._intentStates.get(e);r&&(null===(n=this._stats)||void 0===n||n.timeEnd("Page Request"),null===(i=r.displayReadyCapability)||void 0===i||i.resolve(t))}},{key:"_renderPageChunk",value:function(t,e){for(var n=0,i=t.length;n<i;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;var a,s=w(e.renderTasks);try{for(s.s();!(a=s.n()).done;){a.value.operatorListChanged()}}catch(o){s.e(o)}finally{s.f()}t.lastChunk&&r(cf,this,ff).call(this)}},{key:"_pumpOperatorList",value:function(t){var e=this,n=t.renderingIntent,i=t.cacheKey,a=t.annotationStorageSerializable,s=t.modifiedIds,o=a.map,l=a.transfer,u=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:n,cacheKey:i,annotationStorage:o,modifiedIds:s},l).getReader(),h=this._intentStates.get(i);h.streamReader=u;var c=function(){u.read().then((function(t){var n=t.value;t.done?h.streamReader=null:e._transport.destroyed||(e._renderPageChunk(n,h),c())}),(function(t){if(h.streamReader=null,!e._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;var n,i=w(h.renderTasks);try{for(i.s();!(n=i.n()).done;){n.value.operatorListChanged()}}catch(a){i.e(a)}finally{i.f()}r(cf,e,ff).call(e)}if(h.displayReadyCapability)h.displayReadyCapability.reject(t);else{if(!h.opListReadCapability)throw t;h.opListReadCapability.reject(t)}}}))};c()}},{key:"_abortOperatorList",value:function(t){var e=this,n=t.intentState,i=t.reason,r=t.force,a=void 0!==r&&r;if(n.streamReader){if(n.streamReaderCancelTimeout&&(clearTimeout(n.streamReaderCancelTimeout),n.streamReaderCancelTimeout=null),!a){if(n.renderTasks.size>0)return;if(i instanceof la){var s=100;return i.extraDelay>0&&i.extraDelay<1e3&&(s+=i.extraDelay),void(n.streamReaderCancelTimeout=setTimeout((function(){n.streamReaderCancelTimeout=null,e._abortOperatorList({intentState:n,reason:i,force:!0})}),s))}}if(n.streamReader.cancel(new Ur(i.message))["catch"]((function(){})),n.streamReader=null,!this._transport.destroyed){var o,l=w(this._intentStates);try{for(l.s();!(o=l.n()).done;){var u=D(o.value,2),h=u[0];if(u[1]===n){this._intentStates["delete"](h);break}}}catch(c){l.e(c)}finally{l.f()}this.cleanup()}}}},{key:"stats",get:function(){return this._stats}}]);var t}();function ff(){if(!d(hf,this)||this.destroyed)return!1;var t,e=w(this._intentStates.values());try{for(e.s();!(t=e.n()).done;){var n=t.value,i=n.renderTasks,r=n.operatorList;if(i.size>0||!r.lastChunk)return!1}}catch(a){e.e(a)}finally{e.f()}return this._intentStates.clear(),this.objs.clear(),v(hf,this,!1),!0}var vf=new WeakMap,pf=new WeakMap,gf=new WeakMap,yf=new WeakMap,mf=new WeakSet,wf=function(){function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=e.name,i=void 0===n?null:n,a=e.port,s=void 0===a?null:a,o=e.verbosity,l=void 0===o?Cr():o;if(c(this,t),g(this,mf),f(this,vf,Promise.withResolvers()),f(this,pf,null),f(this,gf,null),f(this,yf,null),this.name=i,this.destroyed=!1,this.verbosity=l,s){if(Mf._.has(s))throw new Error("Cannot use more than one PDFWorker per port.");Mf._.set(s,this),r(mf,this,kf).call(this,s)}else r(mf,this,Af).call(this)}return m(t,[{key:"promise",get:function(){return d(vf,this).promise}},{key:"port",get:function(){return d(gf,this)}},{key:"messageHandler",get:function(){return d(pf,this)}},{key:"destroy",value:function(){var t,e;this.destroyed=!0,null===(t=d(yf,this))||void 0===t||t.terminate(),v(yf,this,null),Mf._["delete"](d(gf,this)),v(gf,this,null),null===(e=d(pf,this))||void 0===e||e.destroy(),v(pf,this,null)}}],[{key:"create",value:function(e){var n=r(t,this,Mf)._.get(null==e?void 0:e.port);if(n){if(n._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return n}return new t(e)}},{key:"workerSrc",get:function(){if(Cc.workerSrc)return Cc.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}},{key:"_setupFakeWorkerGlobal",get:function(){var e=this,n=function(){var n=l(T().m((function i(){var n;return T().w((function(i){for(;;)switch(i.n){case 0:if(!p(t,e,xf)){i.n=1;break}return i.a(2,p(t,e,xf));case 1:return i.n=2,import(e.workerSrc);case 2:return n=i.v,i.a(2,n.WorkerMessageHandler)}}),i)})));return function(){return n.apply(this,arguments)}}();return Or(this,"_setupFakeWorkerGlobal",n())}}])}();function bf(){d(vf,this).resolve(),d(pf,this).send("configure",{verbosity:this.verbosity})}function kf(t){v(gf,this,t),v(pf,this,new Qu("main","worker",t)),d(pf,this).on("ready",(function(){})),r(mf,this,bf).call(this)}function Af(){var t=this;if(Ef._||xf())r(mf,this,_f).call(this);else{var e=Ti.workerSrc;try{Ti._isSameOrigin(window.location,e)||(e=Ti._createCDNWrapper(new URL(e,window.location).href));var n=new Worker(e,{type:"module"}),i=new Qu("main","worker",n),a=function(){s.abort(),i.destroy(),n.terminate(),t.destroyed?d(vf,t).reject(new Error("Worker was destroyed")):r(mf,t,_f).call(t)},s=new AbortController;n.addEventListener("error",(function(){d(yf,t)||a()}),{signal:s.signal}),i.on("test",(function(e){s.abort(),!t.destroyed&&e?(v(pf,t,i),v(gf,t,n),v(yf,t,n),r(mf,t,bf).call(t)):a()})),i.on("ready",(function(e){if(s.abort(),t.destroyed)a();else try{o()}catch(n){r(mf,t,_f).call(t)}}));var o=function(){var t=new Uint8Array;i.send("test",t,[t.buffer])};return void o()}catch(l){Tr("The worker has been disabled.")}r(mf,this,_f).call(this)}}function _f(){var t=this;Ef._||(Rr("Setting up fake worker."),Ef._=!0),Ti._setupFakeWorkerGlobal.then((function(e){var n,i;if(t.destroyed)d(vf,t).reject(new Error("Worker was destroyed"));else{var a=new Ou;v(gf,t,a);var s="fake".concat((Sf._=(n=Sf._,i=n++,n),i)),o=new Qu(s+"_worker",s,a);e.setup(o,a),v(pf,t,new Qu(s,s+"_worker",a)),r(mf,t,bf).call(t)}}))["catch"]((function(e){d(vf,t).reject(new Error('Setting up fake worker failed: "'.concat(e.message,'".')))}))}function xf(t){try{var e;return(null===(e=globalThis.pdfjsWorker)||void 0===e?void 0:e.WorkerMessageHandler)||null}catch(n){return null}}Ti=wf;var Sf={_:0},Ef={_:!1},Mf={_:new WeakMap};Gi&&(Ef._=r(Ti,Ti,!0),Cc.workerSrc||(Cc.workerSrc="./pdf.worker.mjs")),Ti._isSameOrigin=function(t,e){var n=URL.parse(t);if(null==n||!n.origin||"null"===n.origin)return!1;var i=new URL(e,n);return n.origin===i.origin},Ti._createCDNWrapper=function(t){var e='await import("'.concat(t,'");');return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Ti.fromPort=function(t){var e;if(e="`PDFWorker.fromPort` - please use `PDFWorker.create` instead.",console.log("Deprecated API usage: "+e),null==t||!t.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Ti.create(t)};var Cf=new WeakMap,Tf=new WeakMap,Rf=new WeakMap,Pf=new WeakMap,If=new WeakMap,Df=new WeakSet,Lf=function(){return m((function e(t,n,i,r,a,s){c(this,e),g(this,Df),f(this,Cf,new Map),f(this,Tf,new Map),f(this,Rf,new Map),f(this,Pf,new Map),f(this,If,null),this.messageHandler=t,this.loadingTask=n,this.commonObjs=new md,this.fontLoader=new Cu({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.wasmFactory=a.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=s,this.setupMessageHandler()}),[{key:"annotationStorage",get:function(){return Or(this,"annotationStorage",new _u)}},{key:"getRenderingIntent",value:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:er.ENABLE,n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null,i=arguments.length>3&&arguments[3]!==undefined&&arguments[3],r=arguments.length>4&&arguments[4]!==undefined&&arguments[4],a=Yi,s=mu;switch(t){case"any":a=Xi;break;case"display":break;case"print":a=Ki;break;default:Rr("getRenderingIntent - invalid intent: ".concat(t))}var o=a&Ki&&n instanceof Eu?n:this.annotationStorage;switch(e){case er.DISABLE:a+=Zi;break;case er.ENABLE:break;case er.ENABLE_FORMS:a+=Qi;break;case er.ENABLE_STORAGE:a+=Ji,s=o.serializable;break;default:Rr("getRenderingIntent - invalid annotationMode: ".concat(e))}i&&(a+=$i),r&&(a+=tr);var l=o.modifiedIds,u=l.ids,h=l.hash;return{renderingIntent:a,cacheKey:[a,s.hash,h].join("_"),annotationStorageSerializable:s,modifiedIds:u}}},{key:"destroy",value:function(){var t,e=this;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),null===(t=d(If,this))||void 0===t||t.reject(new Error("Worker was destroyed during onPassword callback"));var n,i=[],r=w(d(Tf,this).values());try{for(r.s();!(n=r.n()).done;){var a=n.value;i.push(a._destroy())}}catch(o){r.e(o)}finally{r.f()}d(Tf,this).clear(),d(Rf,this).clear(),d(Pf,this).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();var s=this.messageHandler.sendWithPromise("Terminate",null);return i.push(s),Promise.all(i).then((function(){var t,n;e.commonObjs.clear(),e.fontLoader.clear(),d(Cf,e).clear(),e.filterFactory.destroy(),Bd.cleanup(),null===(t=e._networkStream)||void 0===t||t.cancelAllRequests(new Ur("Worker was terminated.")),null===(n=e.messageHandler)||void 0===n||n.destroy(),e.messageHandler=null,e.destroyCapability.resolve()}),this.destroyCapability.reject),this.destroyCapability.promise}},{key:"setupMessageHandler",value:function(){var t=this,e=this.messageHandler,n=this.loadingTask;e.on("GetReader",(function(e,n){Ir(t._networkStream,"GetReader - no `IPDFStream` instance available."),t._fullReader=t._networkStream.getFullReader(),t._fullReader.onProgress=function(e){t._lastProgress={loaded:e.loaded,total:e.total}},n.onPull=function(){t._fullReader.read().then((function(t){var e=t.value;t.done?n.close():(Ir(e instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(e),1,[e]))}))["catch"]((function(t){n.error(t)}))},n.onCancel=function(e){t._fullReader.cancel(e),n.ready["catch"]((function(e){if(!t.destroyed)throw e}))}})),e.on("ReaderHeadersReady",function(){var e=l(T().m((function i(e){var r,a,s,o,l;return T().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,t._fullReader.headersReady;case 1:return r=t._fullReader,a=r.isStreamingSupported,s=r.isRangeSupported,o=r.contentLength,a&&s||(t._lastProgress&&(null===(l=n.onProgress)||void 0===l||l.call(n,t._lastProgress)),t._fullReader.onProgress=function(t){var e;null===(e=n.onProgress)||void 0===e||e.call(n,{loaded:t.loaded,total:t.total})}),e.a(2,{isStreamingSupported:a,isRangeSupported:s,contentLength:o})}}),i)})));return function(t){return e.apply(this,arguments)}}()),e.on("GetRangeReader",(function(e,n){Ir(t._networkStream,"GetRangeReader - no `IPDFStream` instance available.");var i=t._networkStream.getRangeReader(e.begin,e.end);i?(n.onPull=function(){i.read().then((function(t){var e=t.value;t.done?n.close():(Ir(e instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(e),1,[e]))}))["catch"]((function(t){n.error(t)}))},n.onCancel=function(e){i.cancel(e),n.ready["catch"]((function(e){if(!t.destroyed)throw e}))}):n.close()})),e.on("GetDoc",(function(e){var i=e.pdfInfo;t._numPages=i.numPages,t._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,n._capability.resolve(new uf(i,t))})),e.on("DocException",(function(t){n._capability.reject(Xu(t))})),e.on("PasswordRequest",(function(e){v(If,t,Promise.withResolvers());try{if(!n.onPassword)throw Xu(e);n.onPassword((function(e){e instanceof Error?d(If,t).reject(e):d(If,t).resolve({password:e})}),e.code)}catch(i){d(If,t).reject(i)}return d(If,t).promise})),e.on("DataLoaded",(function(e){var i;null===(i=n.onProgress)||void 0===i||i.call(n,{loaded:e.length,total:e.length}),t.downloadInfoCapability.resolve(e)})),e.on("StartRenderPage",(function(e){t.destroyed||d(Tf,t).get(e.pageIndex)._startRenderPage(e.transparency,e.cacheKey)})),e.on("commonobj",(function(n){var i,r=D(n,3),a=r[0],s=r[1],o=r[2];if(t.destroyed)return null;if(t.commonObjs.has(a))return null;switch(s){case"Font":if("error"in o){var l=o.error;Rr("Error during font loading: ".concat(l)),t.commonObjs.resolve(a,l);break}var u=t._params.pdfBug&&null!==(i=globalThis.FontInspector)&&void 0!==i&&i.enabled?function(t,e){return globalThis.FontInspector.fontAdded(t,e)}:null,h=new Tu(o,u);t.fontLoader.bind(h)["catch"]((function(){return e.sendWithPromise("FontFallback",{id:a})}))["finally"]((function(){!h.fontExtraProperties&&h.data&&(h.data=null),t.commonObjs.resolve(a,h)}));break;case"CopyLocalImage":var c=o.imageRef;Ir(c,"The imageRef must be defined.");var f,v=w(d(Tf,t).values());try{for(v.s();!(f=v.n()).done;){var p,g=w(f.value.objs);try{for(g.s();!(p=g.n()).done;){var y=D(p.value,2)[1];if((null==y?void 0:y.ref)===c)return y.dataLen?(t.commonObjs.resolve(a,structuredClone(y)),y.dataLen):null}}catch(m){g.e(m)}finally{g.f()}}}catch(m){v.e(m)}finally{v.f()}break;case"FontPath":case"Image":case"Pattern":t.commonObjs.resolve(a,o);break;default:throw new Error("Got unknown common object type ".concat(s))}return null})),e.on("obj",(function(e){var n=D(e,4),i=n[0],r=n[1],a=n[2],s=n[3];if(!t.destroyed){var o,l=d(Tf,t).get(r);if(!l.objs.has(i))if(0!==l._intentStates.size)switch(a){case"Image":case"Pattern":l.objs.resolve(i,s);break;default:throw new Error("Got unknown object type ".concat(a))}else null==s||null===(o=s.bitmap)||void 0===o||o.close()}})),e.on("DocProgress",(function(e){var i;t.destroyed||null===(i=n.onProgress)||void 0===i||i.call(n,{loaded:e.loaded,total:e.total})})),e.on("FetchBinaryData",function(){var e=l(T().m((function n(e){var i;return T().w((function(n){for(;;)switch(n.n){case 0:if(!t.destroyed){n.n=1;break}throw new Error("Worker was destroyed.");case 1:if(i=t[e.type]){n.n=2;break}throw new Error("".concat(e.type," not initialized, see the `useWorkerFetch` parameter."));case 2:return n.a(2,i.fetch(e))}}),n)})));return function(t){return e.apply(this,arguments)}}())}},{key:"getData",value:function(){return this.messageHandler.sendWithPromise("GetData",null)}},{key:"saveDocument",value:function(){var t,e,n=this;this.annotationStorage.size<=0&&Rr("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");var i=this.annotationStorage.serializable,r=i.map,a=i.transfer;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:r,filename:null!==(t=null===(e=this._fullReader)||void 0===e?void 0:e.filename)&&void 0!==t?t:null},a)["finally"]((function(){n.annotationStorage.resetModified()}))}},{key:"getPage",value:function(t){var e=this;if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));var n=t-1,i=d(Rf,this).get(n);if(i)return i;var r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:n}).then((function(i){if(e.destroyed)throw new Error("Transport destroyed");i.refStr&&d(Pf,e).set(i.refStr,t);var r=new df(n,i,e,e._params.pdfBug);return d(Tf,e).set(n,r),r}));return d(Rf,this).set(n,r),r}},{key:"getPageIndex",value:function(t){return Pu(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}},{key:"getAnnotations",value:function(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}},{key:"getFieldObjects",value:function(){return r(Df,this,Of).call(this,"GetFieldObjects")}},{key:"hasJSActions",value:function(){return r(Df,this,Of).call(this,"HasJSActions")}},{key:"getCalculationOrderIds",value:function(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}},{key:"getDestinations",value:function(){return this.messageHandler.sendWithPromise("GetDestinations",null)}},{key:"getDestination",value:function(t){return"string"!=typeof t?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}},{key:"getPageLabels",value:function(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}},{key:"getPageLayout",value:function(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}},{key:"getPageMode",value:function(){return this.messageHandler.sendWithPromise("GetPageMode",null)}},{key:"getViewerPreferences",value:function(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}},{key:"getOpenAction",value:function(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}},{key:"getAttachments",value:function(){return this.messageHandler.sendWithPromise("GetAttachments",null)}},{key:"getDocJSActions",value:function(){return r(Df,this,Of).call(this,"GetDocJSActions")}},{key:"getPageJSActions",value:function(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}},{key:"getStructTree",value:function(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}},{key:"getOutline",value:function(){return this.messageHandler.sendWithPromise("GetOutline",null)}},{key:"getOptionalContentConfig",value:function(t){return r(Df,this,Of).call(this,"GetOptionalContentConfig").then((function(e){return new Vc(e,t)}))}},{key:"getPermissions",value:function(){return this.messageHandler.sendWithPromise("GetPermissions",null)}},{key:"getMetadata",value:function(){var t=this,e="GetMetadata",n=d(Cf,this).get(e);if(n)return n;var i=this.messageHandler.sendWithPromise(e,null).then((function(e){var n,i,r,a;return{info:e[0],metadata:e[1]?new Dc(e[1]):null,contentDispositionFilename:null!==(n=null===(i=t._fullReader)||void 0===i?void 0:i.filename)&&void 0!==n?n:null,contentLength:null!==(r=null===(a=t._fullReader)||void 0===a?void 0:a.contentLength)&&void 0!==r?r:null}}));return d(Cf,this).set(e,i),i}},{key:"getMarkInfo",value:function(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}},{key:"startCleanup",value:(t=l(T().m((function n(){var t,e,i,r,a,s=arguments;return T().w((function(n){for(;;)switch(n.p=n.n){case 0:if(t=s.length>0&&s[0]!==undefined&&s[0],!this.destroyed){n.n=1;break}return n.a(2);case 1:return n.n=2,this.messageHandler.sendWithPromise("Cleanup",null);case 2:e=w(d(Tf,this).values()),n.p=3,e.s();case 4:if((i=e.n()).done){n.n=6;break}if((r=i.value).cleanup()){n.n=5;break}throw new Error("startCleanup: Page ".concat(r.pageNumber," is currently rendering."));case 5:n.n=4;break;case 6:n.n=8;break;case 7:n.p=7,a=n.v,e.e(a);case 8:return n.p=8,e.f(),n.f(8);case 9:this.commonObjs.clear(),t||this.fontLoader.clear(),d(Cf,this).clear(),this.filterFactory.destroy(!0),Bd.cleanup();case 10:return n.a(2)}}),n,this,[[3,7,8,9]])}))),function(){return t.apply(this,arguments)})},{key:"cachedPageNumber",value:function(t){var e;if(!Pu(t))return null;var n=0===t.gen?"".concat(t.num,"R"):"".concat(t.num,"R").concat(t.gen);return null!==(e=d(Pf,this).get(n))&&void 0!==e?e:null}}]);var t}();function Of(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null,n=d(Cf,this).get(t);if(n)return n;var i=this.messageHandler.sendWithPromise(t,e);return d(Cf,this).set(t,i),i}var Ff=new WeakMap,Nf=function(){return m((function t(e){c(this,t),f(this,Ff,null),b(this,"onContinue",null),b(this,"onError",null),v(Ff,this,e)}),[{key:"promise",get:function(){return d(Ff,this).capability.promise}},{key:"cancel",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;d(Ff,this).cancel(null,t)}},{key:"separateAnnots",get:function(){var t=d(Ff,this).operatorList.separateAnnots;if(!t)return!1;var e=d(Ff,this).annotationCanvasMap;return t.form||t.canvas&&(null==e?void 0:e.size)>0}}])}(),Wf=new WeakMap,Bf=function(){return m((function e(t){var n=t.callback,i=t.params,r=t.objs,a=t.commonObjs,s=t.annotationCanvasMap,o=t.operatorList,l=t.pageIndex,u=t.canvasFactory,h=t.filterFactory,d=t.useRequestAnimationFrame,v=void 0!==d&&d,p=t.pdfBug,g=void 0!==p&&p,y=t.pageColors,m=void 0===y?null:y,w=t.enableHWA,b=void 0!==w&&w;c(this,e),f(this,Wf,null),this.callback=n,this.params=i,this.objs=r,this.commonObjs=a,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=l,this.canvasFactory=u,this.filterFactory=h,this._pdfBug=g,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===v&&"undefined"!=typeof window,this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new Nf(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvas,this._canvasContext=i.canvas?null:i.canvasContext,this._enableHWA=b}),[{key:"completed",get:function(){return this.capability.promise["catch"]((function(){}))}},{key:"initializeGraphics",value:function(t){var e,n,i=t.transparency,r=void 0!==i&&i,a=t.optionalContentConfig;if(!this.cancelled){if(this._canvas){if(jf._.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");jf._.add(this._canvas)}this._pdfBug&&null!==(e=globalThis.StepperManager)&&void 0!==e&&e.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());var s=this.params,o=s.viewport,l=s.transform,u=s.background,h=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new _c(h,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:a},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:l,viewport:o,transparency:r,background:u}),this.operatorListIdx=0,this.graphicsReady=!0,null===(n=this.graphicsReadyCallback)||void 0===n||n.call(this)}}},{key:"cancel",value:function(){var t,e,n,i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null,r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;this.running=!1,this.cancelled=!0,null===(t=this.gfx)||void 0===t||t.endDrawing(),d(Wf,this)&&(window.cancelAnimationFrame(d(Wf,this)),v(Wf,this,null)),jf._["delete"](this._canvas),i||(i=new la("Rendering cancelled, page ".concat(this._pageIndex+1),r)),this.callback(i),null===(e=(n=this.task).onError)||void 0===e||e.call(n,i)}},{key:"operatorListChanged",value:function(){var t;this.graphicsReady?(null===(t=this.stepper)||void 0===t||t.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}},{key:"_continue",value:function(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}},{key:"_scheduleNext",value:function(){var t=this;this._useRequestAnimationFrame?v(Wf,this,window.requestAnimationFrame((function(){v(Wf,t,null),t._nextBound()["catch"](t._cancelBound)}))):Promise.resolve().then(this._nextBound)["catch"](this._cancelBound)}},{key:"_next",value:(t=l(T().m((function n(){return T().w((function(t){for(;;)switch(t.n){case 0:if(!this.cancelled){t.n=1;break}return t.a(2);case 1:this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),jf._["delete"](this._canvas),this.callback()));case 2:return t.a(2)}}),n,this)}))),function(){return t.apply(this,arguments)})}]);var t}(),jf={_:new WeakSet},Hf="5.4.78",Uf="e9a483014",zf=new WeakMap,Gf=new WeakMap,Vf=new WeakMap,qf=new WeakMap,Xf=new WeakMap,Yf=new WeakMap,Kf=new WeakMap,Qf=new WeakMap,Jf=new WeakMap,Zf=new WeakMap,$f=new WeakSet,tv=function(){function t(e){var n,i,r=e.editor,a=void 0===r?null:r,s=e.uiManager,o=void 0===s?null:s;c(this,t),g(this,$f),f(this,zf,null),f(this,Gf,null),f(this,Vf,void 0),f(this,qf,null),f(this,Xf,!1),f(this,Yf,!1),f(this,Kf,null),f(this,Qf,void 0),f(this,Jf,null),f(this,Zf,null),a?(v(Yf,this,!1),v(Kf,this,a)):v(Yf,this,!0),v(Zf,this,(null==a?void 0:a._uiManager)||o),v(Qf,this,d(Zf,this)._eventBus),v(Vf,this,(null==a||null===(n=a.color)||void 0===n?void 0:n.toUpperCase())||(null===(i=d(Zf,this))||void 0===i?void 0:i.highlightColors.values().next().value)||"#FFFF98"),ov._||(ov._=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}return m(t,[{key:"renderButton",value:function(){var t=v(zf,this,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",d(Kf,this)&&(t.ariaControls="".concat(d(Kf,this).id,"_colorpicker_dropdown"));var e=d(Zf,this)._signal;t.addEventListener("click",r($f,this,rv).bind(this),{signal:e}),t.addEventListener("keydown",r($f,this,iv).bind(this),{signal:e});var n=v(Gf,this,document.createElement("span"));return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=d(Vf,this),t.append(n),t}},{key:"renderMainDropdown",value:function(){var t=v(qf,this,r($f,this,ev).call(this));return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}},{key:"_colorSelectFromKeyboard",value:function(t){if(t.target!==d(zf,this)){var e=t.target.getAttribute("data-color");e&&r($f,this,nv).call(this,e,t)}else r($f,this,rv).call(this,t)}},{key:"_moveToNext",value:function(t){var e,n;p($f,this,sv)?t.target!==d(zf,this)?null===(e=t.target.nextSibling)||void 0===e||e.focus():null===(n=d(qf,this).firstChild)||void 0===n||n.focus():r($f,this,rv).call(this,t)}},{key:"_moveToPrevious",value:function(t){var e,n;t.target!==(null===(e=d(qf,this))||void 0===e?void 0:e.firstChild)&&t.target!==d(zf,this)?(p($f,this,sv)||r($f,this,rv).call(this,t),null===(n=t.target.previousSibling)||void 0===n||n.focus()):p($f,this,sv)&&this._hideDropdownFromKeyboard()}},{key:"_moveToBeginning",value:function(t){var e;p($f,this,sv)?null===(e=d(qf,this).firstChild)||void 0===e||e.focus():r($f,this,rv).call(this,t)}},{key:"_moveToEnd",value:function(t){var e;p($f,this,sv)?null===(e=d(qf,this).lastChild)||void 0===e||e.focus():r($f,this,rv).call(this,t)}},{key:"hideDropdown",value:function(){var t,e;null===(t=d(qf,this))||void 0===t||t.classList.add("hidden"),d(zf,this).ariaExpanded="false",null===(e=d(Jf,this))||void 0===e||e.abort(),v(Jf,this,null)}},{key:"_hideDropdownFromKeyboard",value:function(){var t;d(Yf,this)||(p($f,this,sv)?(this.hideDropdown(),d(zf,this).focus({preventScroll:!0,focusVisible:d(Xf,this)})):null===(t=d(Kf,this))||void 0===t||t.unselect())}},{key:"updateColor",value:function(t){if(d(Gf,this)&&(d(Gf,this).style.backgroundColor=t),d(qf,this)){var e,n=d(Zf,this).highlightColors.values(),i=w(d(qf,this).children);try{for(i.s();!(e=i.n()).done;){e.value.ariaSelected=n.next().value===t.toUpperCase()}}catch(r){i.e(r)}finally{i.f()}}}},{key:"destroy",value:function(){var t,e;null===(t=d(zf,this))||void 0===t||t.remove(),v(zf,this,null),v(Gf,this,null),null===(e=d(qf,this))||void 0===e||e.remove(),v(qf,this,null)}}],[{key:"_keyboardManager",get:function(){return Or(this,"_keyboardManager",new cs([[["Escape","mac+Escape"],t.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],t.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],t.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],t.prototype._moveToPrevious],[["Home","mac+Home"],t.prototype._moveToBeginning],[["End","mac+End"],t.prototype._moveToEnd]]))}}])}();function ev(){var t=document.createElement("div"),e=d(Zf,this)._signal;t.addEventListener("contextmenu",pa,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),d(Kf,this)&&(t.id="".concat(d(Kf,this).id,"_colorpicker_dropdown"));var n,i=w(d(Zf,this).highlightColors);try{for(i.s();!(n=i.n()).done;){var a=D(n.value,2),s=a[0],o=a[1],l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",o),l.title=s,l.setAttribute("data-l10n-id",ov._[s]);var u=document.createElement("span");l.append(u),u.className="swatch",u.style.backgroundColor=o,l.ariaSelected=o===d(Vf,this),l.addEventListener("click",r($f,this,nv).bind(this,o),{signal:e}),t.append(l)}}catch(h){i.e(h)}finally{i.f()}return t.addEventListener("keydown",r($f,this,iv).bind(this),{signal:e}),t}function nv(t,e){e.stopPropagation(),d(Qf,this).dispatch("switchannotationeditorparams",{source:this,type:rr.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}function iv(t){Ri._keyboardManager.exec(this,t)}function rv(t){if(p($f,this,sv))this.hideDropdown();else if(v(Xf,this,0===t.detail),d(Jf,this)||(v(Jf,this,new AbortController),window.addEventListener("pointerdown",r($f,this,av).bind(this),{signal:d(Zf,this).combinedSignal(d(Jf,this))})),d(zf,this).ariaExpanded="true",d(qf,this))d(qf,this).classList.remove("hidden");else{var e=v(qf,this,r($f,this,ev).call(this));d(zf,this).append(e)}}function av(t){var e;null!==(e=d(qf,this))&&void 0!==e&&e.contains(t.target)||this.hideDropdown()}function sv(t){return d(qf,t)&&!d(qf,t).classList.contains("hidden")}Ri=tv;var ov={_:null},lv=new WeakMap,uv=new WeakMap,hv=new WeakMap,cv=function(){return m((function t(e){c(this,t),f(this,lv,null),f(this,uv,null),f(this,hv,null),v(uv,this,e),v(hv,this,e._uiManager),dv._||(dv._=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}),[{key:"renderButton",value:function(){var t=this;if(d(lv,this))return d(lv,this);var e=d(uv,this),n=e.editorType,i=e.colorType,r=e.colorValue,a=v(lv,this,document.createElement("input"));return a.type="color",a.value=r||"#000000",a.className="basicColorPicker",a.tabIndex=0,a.setAttribute("data-l10n-id",dv._[n]),a.addEventListener("input",(function(){d(hv,t).updateParams(i,a.value)}),{signal:d(hv,this)._signal}),a}},{key:"update",value:function(t){d(lv,this)&&(d(lv,this).value=t)}},{key:"destroy",value:function(){var t;null===(t=d(lv,this))||void 0===t||t.remove(),v(lv,this,null)}},{key:"hideDropdown",value:function(){}}])}(),dv={_:null};function fv(t){return Math.floor(255*Math.max(0,Math.min(1,t))).toString(16).padStart(2,"0")}function vv(t){return Math.max(0,Math.min(255,255*t))}zi(531);var pv=function(){return m((function t(){c(this,t)}),null,[{key:"CMYK_G",value:function(t){var e=D(t,4),n=e[0],i=e[1],r=e[2],a=e[3];return["G",1-Math.min(1,.3*n+.59*r+.11*i+a)]}},{key:"G_CMYK",value:function(t){return["CMYK",0,0,0,1-D(t,1)[0]]}},{key:"G_RGB",value:function(t){var e=D(t,1)[0];return["RGB",e,e,e]}},{key:"G_rgb",value:function(t){var e=D(t,1)[0];return[e=vv(e),e,e]}},{key:"G_HTML",value:function(t){var e=fv(D(t,1)[0]);return"#".concat(e).concat(e).concat(e)}},{key:"RGB_G",value:function(t){var e=D(t,3);return["G",.3*e[0]+.59*e[1]+.11*e[2]]}},{key:"RGB_rgb",value:function(t){return t.map(vv)}},{key:"RGB_HTML",value:function(t){return"#".concat(t.map(fv).join(""))}},{key:"T_HTML",value:function(){return"#00000000"}},{key:"T_rgb",value:function(){return[null]}},{key:"CMYK_RGB",value:function(t){var e=D(t,4),n=e[0],i=e[1],r=e[2],a=e[3];return["RGB",1-Math.min(1,n+a),1-Math.min(1,r+a),1-Math.min(1,i+a)]}},{key:"CMYK_rgb",value:function(t){var e=D(t,4),n=e[0],i=e[1],r=e[2],a=e[3];return[vv(1-Math.min(1,n+a)),vv(1-Math.min(1,r+a)),vv(1-Math.min(1,i+a))]}},{key:"CMYK_HTML",value:function(t){var e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}},{key:"RGB_CMYK",value:function(t){var e=D(t,3),n=1-e[0],i=1-e[1],r=1-e[2];return["CMYK",n,i,r,Math.min(n,i,r)]}}])}(),gv=function(){return m((function t(){c(this,t)}),[{key:"create",value:function(t,e){var n=arguments.length>2&&arguments[2]!==undefined&&arguments[2];if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");var i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width","".concat(t,"px")),i.setAttribute("height","".concat(e,"px"))),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox","0 0 ".concat(t," ").concat(e)),i}},{key:"createElement",value:function(t){if("string"!=typeof t)throw new Error("Invalid SVG element type");return this._createSVG(t)}},{key:"_createSVG",value:function(t){Pr("Abstract method `_createSVG` called.")}}])}(),yv=function(t){function e(){return c(this,e),u(this,e,arguments)}return _(e,t),m(e,[{key:"_createSVG",value:function(t){return document.createElementNS(ia,t)}}])}(gv),mv=function(){return m((function t(){c(this,t)}),null,[{key:"setupStorage",value:function(t,e,n,i,r){var a=i.getValue(e,{value:null});switch(n.name){case"textarea":if(null!==a.value&&(t.textContent=a.value),"print"===r)break;t.addEventListener("input",(function(t){i.setValue(e,{value:t.target.value})}));break;case"input":if("radio"===n.attributes.type||"checkbox"===n.attributes.type){if(a.value===n.attributes.xfaOn?t.setAttribute("checked",!0):a.value===n.attributes.xfaOff&&t.removeAttribute("checked"),"print"===r)break;t.addEventListener("change",(function(t){i.setValue(e,{value:t.target.checked?t.target.getAttribute("xfaOn"):t.target.getAttribute("xfaOff")})}))}else{if(null!==a.value&&t.setAttribute("value",a.value),"print"===r)break;t.addEventListener("input",(function(t){i.setValue(e,{value:t.target.value})}))}break;case"select":if(null!==a.value){t.setAttribute("value",a.value);var s,o=w(n.children);try{for(o.s();!(s=o.n()).done;){var l=s.value;l.attributes.value===a.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}}catch(u){o.e(u)}finally{o.f()}}t.addEventListener("input",(function(t){var n=t.target.options,r=-1===n.selectedIndex?"":n[n.selectedIndex].value;i.setValue(e,{value:r})}))}}},{key:"setAttributes",value:function(t){var e=t.html,n=t.element,i=t.storage,r=void 0===i?null:i,a=t.intent,s=t.linkService,o=n.attributes,l=e instanceof HTMLAnchorElement;"radio"===o.type&&(o.name="".concat(o.name,"-").concat(a));for(var u=0,h=Object.entries(o);u<h.length;u++){var c=D(h[u],2),d=c[0],f=c[1];if(null!==f&&f!==undefined)switch(d){case"class":f.length&&e.setAttribute(d,f.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",f);break;case"style":Object.assign(e.style,f);break;case"textContent":e.textContent=f;break;default:(!l||"href"!==d&&"newWindow"!==d)&&e.setAttribute(d,f)}}l&&s.addLinkAttributes(e,o.href,o.newWindow),r&&o.dataId&&this.setupStorage(e,o.dataId,n,r)}},{key:"render",value:function(t){var e=t.annotationStorage,n=t.linkService,i=t.xfaHtml,r=t.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:r,linkService:n});var s="richText"!==r,o=t.div;if(o.append(a),t.viewport){var l="matrix(".concat(t.viewport.transform.join(","),")");o.style.transform=l}s&&o.setAttribute("class","xfaLayer xfaFont");var u=[];if(0===i.children.length){if(i.value){var h=document.createTextNode(i.value);a.append(h),s&&Zd.shouldBuildText(i.name)&&u.push(h)}return{textDivs:u}}for(var c=[[i,-1,a]];c.length>0;){var d,f,v=D(c.at(-1),3),p=v[0],g=v[1],y=v[2];if(g+1!==p.children.length){var m=p.children[++c.at(-1)[1]];if(null!==m){var b=m.name;if("#text"!==b){var k=null!=m&&null!==(d=m.attributes)&&void 0!==d&&d.xmlns?document.createElementNS(m.attributes.xmlns,b):document.createElement(b);if(y.append(k),m.attributes&&this.setAttributes({html:k,element:m,storage:e,intent:r,linkService:n}),(null===(f=m.children)||void 0===f?void 0:f.length)>0)c.push([m,-1,k]);else if(m.value){var A=document.createTextNode(m.value);s&&Zd.shouldBuildText(b)&&u.push(A),k.append(A)}}else{var _=document.createTextNode(m.value);u.push(_),y.append(_)}}}else c.pop()}var x,S=w(o.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"));try{for(S.s();!(x=S.n()).done;){x.value.setAttribute("readOnly",!0)}}catch(E){S.e(E)}finally{S.f()}return{textDivs:u}}},{key:"update",value:function(t){var e="matrix(".concat(t.viewport.transform.join(","),")");t.div.style.transform=e,t.div.hidden=!1}}])}(),wv=new WeakSet,bv=60*(new Date).getTimezoneOffset()*1e3,kv=function(){return m((function t(){c(this,t)}),null,[{key:"create",value:function(t){switch(t.data.annotationType){case fr.LINK:return new Tv(t);case fr.TEXT:return new Dv(t);case fr.WIDGET:switch(t.data.fieldType){case"Tx":return new Ov(t);case"Btn":return t.data.radioButton?new Wv(t):t.data.checkBox?new Nv(t):new Bv(t);case"Ch":return new jv(t);case"Sig":return new Fv(t)}return new Lv(t);case fr.POPUP:return new Hv(t);case fr.FREETEXT:return new bp(t);case fr.LINE:return new Ap(t);case fr.SQUARE:return new xp(t);case fr.CIRCLE:return new Ep(t);case fr.POLYLINE:return new Cp(t);case fr.CARET:return new Rp(t);case fr.INK:return new Lp(t);case fr.POLYGON:return new Tp(t);case fr.HIGHLIGHT:return new Fp(t);case fr.UNDERLINE:return new Np(t);case fr.SQUIGGLY:return new Wp(t);case fr.STRIKEOUT:return new Bp(t);case fr.STAMP:return new jp(t);case fr.FILEATTACHMENT:return new zp(t);default:return new Ev(t)}}}])}(),Av=new WeakMap,_v=new WeakMap,xv=new WeakMap,Sv=new WeakSet,Ev=function(){function t(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},i=n.isRenderable,r=void 0!==i&&i,a=n.ignoreBorder,s=void 0!==a&&a,o=n.createQuadrilaterals,l=void 0!==o&&o;c(this,t),g(this,Sv),f(this,Av,null),f(this,_v,!1),f(this,xv,null),this.isRenderable=r,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,r&&(this.container=this._createContainer(s)),l&&this._createQuadrilaterals()}return m(t,[{key:"_isEditable",get:function(){return this.data.isEditable}},{key:"hasPopupData",get:function(){return t._hasPopupData(this.data)}},{key:"updateEdited",value:function(t){var e;if(this.container){t.rect&&(d(Av,this)||v(Av,this,{rect:this.data.rect.slice(0)}));var n=t.rect,i=t.popup;n&&r(Sv,this,Mv).call(this,n);var a=(null===(e=d(xv,this))||void 0===e?void 0:e.popup)||this.popup;!a&&null!=i&&i.text&&(this._createPopup(i),a=d(xv,this).popup),a&&(a.updateEdited(t),null!=i&&i.deleted&&(a.remove(),v(xv,this,null),this.popup=null))}}},{key:"resetEdited",value:function(){var t;d(Av,this)&&(r(Sv,this,Mv).call(this,d(Av,this).rect),null===(t=d(xv,this))||void 0===t||t.popup.resetEdited(),v(Av,this,null))}},{key:"_createContainer",value:function(t){var e=this.data,n=this.parent,i=n.page,r=n.viewport,a=document.createElement("section");a.setAttribute("data-annotation-id",e.id),this instanceof Lv||this instanceof Tv||(a.tabIndex=0);var s=a.style;if(s.zIndex=this.parent.zIndex++,e.alternativeText&&(a.title=e.alternativeText),e.noRotate&&a.classList.add("norotate"),!e.rect||this instanceof Hv){var o=e.rotation;return e.hasOwnCanvas||0===o||this.setRotation(o,a),a}var l=this.width,u=this.height;if(!t&&e.borderStyle.width>0){s.borderWidth="".concat(e.borderStyle.width,"px");var h=e.borderStyle.horizontalCornerRadius,c=e.borderStyle.verticalCornerRadius;if(h>0||c>0){var d="calc(".concat(h,"px * var(--total-scale-factor)) / calc(").concat(c,"px * var(--total-scale-factor))");s.borderRadius=d}else if(this instanceof Wv){var f="calc(".concat(l,"px * var(--total-scale-factor)) / calc(").concat(u,"px * var(--total-scale-factor))");s.borderRadius=f}switch(e.borderStyle.style){case vr:s.borderStyle="solid";break;case pr:s.borderStyle="dashed";break;case gr:Rr("Unimplemented border style: beveled");break;case yr:Rr("Unimplemented border style: inset");break;case mr:s.borderBottomStyle="solid"}var p=e.borderColor||null;p?(v(_v,this,!0),s.borderColor=Xr.makeHexColor(0|p[0],0|p[1],0|p[2])):s.borderWidth=0}var g=Xr.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),y=r.rawDims,m=y.pageWidth,w=y.pageHeight,b=y.pageX,k=y.pageY;s.left="".concat(100*(g[0]-b)/m,"%"),s.top="".concat(100*(g[1]-k)/w,"%");var A=e.rotation;return e.hasOwnCanvas||0===A?(s.width="".concat(100*l/m,"%"),s.height="".concat(100*u/w,"%")):this.setRotation(A,a),a}},{key:"setRotation",value:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.container;if(this.data.rect){var n=this.parent.viewport.rawDims,i=n.pageWidth,r=n.pageHeight,a=this.width,s=this.height;if(t%180!=0){var o=[s,a];a=o[0],s=o[1]}e.style.width="".concat(100*a/i,"%"),e.style.height="".concat(100*s/r,"%"),e.setAttribute("data-main-rotation",(360-t)%360)}}},{key:"_commonActions",get:function(){var t=this,e=function(e,n,i){var r=i.detail[e],a=r[0],s=r.slice(1);i.target.style[n]=pv["".concat(a,"_HTML")](s),t.annotationStorage.setValue(t.data.id,b({},n,pv["".concat(a,"_rgb")](s)))};return Or(this,"_commonActions",{display:function(e){var n=e.detail.display,i=n%2==1;t.container.style.visibility=i?"hidden":"visible",t.annotationStorage.setValue(t.data.id,{noView:i,noPrint:1===n||2===n})},print:function(e){t.annotationStorage.setValue(t.data.id,{noPrint:!e.detail.print})},hidden:function(e){var n=e.detail.hidden;t.container.style.visibility=n?"hidden":"visible",t.annotationStorage.setValue(t.data.id,{noPrint:n,noView:n})},focus:function(t){setTimeout((function(){return t.target.focus({preventScroll:!1})}),0)},userName:function(t){t.target.title=t.detail.userName},readonly:function(t){t.target.disabled=t.detail.readonly},required:function(e){t._setRequired(e.target,e.detail.required)},bgColor:function(t){e("bgColor","backgroundColor",t)},fillColor:function(t){e("fillColor","backgroundColor",t)},fgColor:function(t){e("fgColor","color",t)},textColor:function(t){e("textColor","color",t)},borderColor:function(t){e("borderColor","borderColor",t)},strokeColor:function(t){e("strokeColor","borderColor",t)},rotation:function(e){var n=e.detail.rotation;t.setRotation(n),t.annotationStorage.setValue(t.data.id,{rotation:n})}})}},{key:"_dispatchEventFromSandbox",value:function(t,e){for(var n=this._commonActions,i=0,r=Object.keys(e.detail);i<r.length;i++){var a=r[i],s=t[a]||n[a];null==s||s(e)}}},{key:"_setDefaultPropertiesFromJS",value:function(t){if(this.enableScripting){var e=this.annotationStorage.getRawValue(this.data.id);if(e)for(var n=this._commonActions,i=0,r=Object.entries(e);i<r.length;i++){var a=D(r[i],2),s=a[0],o=a[1],l=n[s];if(l)l({detail:b({},s,o),target:t}),delete e[s]}}}},{key:"_createQuadrilaterals",value:function(){if(this.container){var t=this.data.quadPoints;if(t){var e=this.data.rect.map((function(t){return Math.fround(t)})),n=D(e,4),i=n[0],r=n[1],a=n[2],s=n[3];if(8===t.length){var o=D(t.subarray(2,6),4),l=o[0],u=o[1],h=o[2],c=o[3];if(a===l&&s===u&&i===h&&r===c)return}var f,v=this.container.style;if(d(_v,this)){var p=v.borderColor,g=v.borderWidth;v.borderWidth=0,f=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">','<g fill="transparent" stroke="'.concat(p,'" stroke-width="').concat(g,'">')],this.container.classList.add("hasBorder")}var y=a-i,m=s-r,w=this.svgFactory,b=w.createElement("svg");b.classList.add("quadrilateralsContainer"),b.setAttribute("width",0),b.setAttribute("height",0),b.role="none";var k=w.createElement("defs");b.append(k);var A=w.createElement("clipPath"),_="clippath_".concat(this.data.id);A.setAttribute("id",_),A.setAttribute("clipPathUnits","objectBoundingBox"),k.append(A);for(var x=2,S=t.length;x<S;x+=8){var E,M=t[x],C=t[x+1],T=t[x+2],R=t[x+3],P=w.createElement("rect"),I=(T-i)/y,L=(s-C)/m,O=(M-T)/y,F=(C-R)/m;P.setAttribute("x",I),P.setAttribute("y",L),P.setAttribute("width",O),P.setAttribute("height",F),A.append(P),null===(E=f)||void 0===E||E.push('<rect vector-effect="non-scaling-stroke" x="'.concat(I,'" y="').concat(L,'" width="').concat(O,'" height="').concat(F,'"/>'))}d(_v,this)&&(f.push("</g></svg>')"),v.backgroundImage=f.join("")),this.container.append(b),this.container.style.clipPath="url(#".concat(_,")")}}}},{key:"_createPopup",value:function(){var t,e,n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null,i=this.data;n?(t={str:n.text},e=n.date):(t=i.contentsObj,e=i.modificationDate);var r=v(xv,this,new Hv({data:{color:i.color,titleObj:i.titleObj,modificationDate:e,contentsObj:t,richText:i.richText,parentRect:i.rect,borderStyle:0,id:"popup_".concat(i.id),rotation:i.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}));this.parent.div.append(r.render())}},{key:"hasPopupElement",get:function(){return!!(d(xv,this)||this.popup||this.data.popupRef)}},{key:"render",value:function(){Pr("Abstract method `AnnotationElement.render` called")}},{key:"_getElementsByName",value:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null,n=[];if(this._fieldObjects){var i=this._fieldObjects[t];if(i){var r,a=w(i);try{for(a.s();!(r=a.n()).done;){var s=r.value,o=s.page,l=s.id,u=s.exportValues;if(-1!==o&&l!==e){var h="string"==typeof u?u:null,c=document.querySelector('[data-element-id="'.concat(l,'"]'));!c||wv.has(c)?n.push({id:l,exportValue:h,domElement:c}):Rr("_getElementsByName - element not allowed: ".concat(l))}}}catch(y){a.e(y)}finally{a.f()}}return n}var d,f=w(document.getElementsByName(t));try{for(f.s();!(d=f.n()).done;){var v=d.value,p=v.exportValue,g=v.getAttribute("data-element-id");g!==e&&(wv.has(v)&&n.push({id:g,exportValue:p,domElement:v}))}}catch(y){f.e(y)}finally{f.f()}return n}},{key:"show",value:function(){var t;this.container&&(this.container.hidden=!1),null===(t=this.popup)||void 0===t||t.maybeShow()}},{key:"hide",value:function(){var t;this.container&&(this.container.hidden=!0),null===(t=this.popup)||void 0===t||t.forceHide()}},{key:"getElementsToTriggerPopup",value:function(){return this.container}},{key:"addHighlightArea",value:function(){var t=this.getElementsToTriggerPopup();if(Array.isArray(t)){var e,n=w(t);try{for(n.s();!(e=n.n()).done;){e.value.classList.add("highlightArea")}}catch(i){n.e(i)}finally{n.f()}}else t.classList.add("highlightArea")}},{key:"_editOnDoubleClick",value:function(){var t=this;if(this._isEditable){var e=this.annotationEditorType,n=this.data.id;this.container.addEventListener("dblclick",(function(){var i;null===(i=t.linkService.eventBus)||void 0===i||i.dispatch("switchannotationeditormode",{source:t,mode:e,editId:n,mustEnterInEditMode:!0})}))}}},{key:"width",get:function(){return this.data.rect[2]-this.data.rect[0]}},{key:"height",get:function(){return this.data.rect[3]-this.data.rect[1]}}],[{key:"_hasPopupData",value:function(t){var e=t.contentsObj,n=t.richText;return!!(null!=e&&e.str||null!=n&&n.str)}}])}();function Mv(t){var e=this.container.style,n=this.data,i=n.rect,r=n.rotation,a=this.parent.viewport.rawDims,s=a.pageWidth,o=a.pageHeight,l=a.pageX,u=a.pageY;null==i||i.splice.apply(i,[0,4].concat(F(t))),e.left="".concat(100*(t[0]-l)/s,"%"),e.top="".concat(100*(o-t[3]+u)/o,"%"),0===r?(e.width="".concat(100*(t[2]-t[0])/s,"%"),e.height="".concat(100*(t[3]-t[1])/o,"%")):this.setRotation(r)}var Cv=new WeakSet,Tv=function(t){function e(t){var n,i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return c(this,e),g(n=u(this,e,[t,{isRenderable:!0,ignoreBorder:!(null==i||!i.ignoreBorder),createQuadrilaterals:!0}]),Cv),n.isTooltipOnly=t.data.isTooltipOnly,n}return _(e,t),m(e,[{key:"render",value:function(){var t=this.data,e=this.linkService,n=document.createElement("a");n.setAttribute("data-element-id",t.id);var i=!1;return t.url?(e.addLinkAttributes(n,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(n,t.action,t.overlaidText),i=!0):t.attachment?(r(Cv,this,Pv).call(this,n,t.attachment,t.overlaidText,t.attachmentDest),i=!0):t.setOCGState?(r(Cv,this,Iv).call(this,n,t.setOCGState,t.overlaidText),i=!0):t.dest?(this._bindLink(n,t.dest,t.overlaidText),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,t),i=!0),t.resetForm?(this._bindResetFormAction(n,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(n),this.container}},{key:"_bindLink",value:function(t,e){var n=this,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";t.href=this.linkService.getDestinationHash(e),t.onclick=function(){return e&&n.linkService.goToDestination(e),!1},(e||""===e)&&r(Cv,this,Rv).call(this),i&&(t.title=i)}},{key:"_bindNamedAction",value:function(t,e){var n=this,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";t.href=this.linkService.getAnchorUrl(""),t.onclick=function(){return n.linkService.executeNamedAction(e),!1},i&&(t.title=i),r(Cv,this,Rv).call(this)}},{key:"_bindJSAction",value:function(t,e){var n=this;t.href=this.linkService.getAnchorUrl("");for(var i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]),a=function(){var r=o[s],a=i.get(r);if(!a)return 1;t[a]=function(){var t;return null===(t=n.linkService.eventBus)||void 0===t||t.dispatch("dispatcheventinsandbox",{source:n,detail:{id:e.id,name:r}}),!1}},s=0,o=Object.keys(e.actions);s<o.length;s++)a();e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=function(){return!1}),r(Cv,this,Rv).call(this)}},{key:"_bindResetFormAction",value:function(t,e){var n=this,i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),r(Cv,this,Rv).call(this),!this._fieldObjects)return Rr('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(i||(t.onclick=function(){return!1}));t.onclick=function(){null==i||i();var t=e.fields,r=e.refs,a=e.include,s=[];if(0!==t.length||0!==r.length){var o,l=new Set(r),u=w(t);try{for(u.s();!(o=u.n()).done;){var h,c=o.value,d=w(n._fieldObjects[c]||[]);try{for(d.s();!(h=d.n()).done;){var f=h.value.id;l.add(f)}}catch(L){d.e(L)}finally{d.f()}}}catch(L){u.e(L)}finally{u.f()}for(var v=0,p=Object.values(n._fieldObjects);v<p.length;v++){var g,y=w(p[v]);try{for(y.s();!(g=y.n()).done;){var m=g.value;l.has(m.id)===a&&s.push(m)}}catch(L){y.e(L)}finally{y.f()}}}else for(var b=0,k=Object.values(n._fieldObjects);b<k.length;b++){var A=k[b];s.push.apply(s,F(A))}for(var _,x=n.annotationStorage,S=[],E=0,M=s;E<M.length;E++){var C=M[E],T=C.id;switch(S.push(T),C.type){case"text":var R=C.defaultValue||"";x.setValue(T,{value:R});break;case"checkbox":case"radiobutton":var P=C.defaultValue===C.exportValues;x.setValue(T,{value:P});break;case"combobox":case"listbox":var I=C.defaultValue||"";x.setValue(T,{value:I});break;default:continue}var D=document.querySelector('[data-element-id="'.concat(T,'"]'));D&&(wv.has(D)?D.dispatchEvent(new Event("resetform")):Rr("_bindResetFormAction - element not allowed: ".concat(T)))}n.enableScripting&&(null===(_=n.linkService.eventBus)||void 0===_||_.dispatch("dispatcheventinsandbox",{source:n,detail:{id:"app",ids:S,name:"ResetForm"}}));return!1}}}])}(Ev);function Rv(){this.container.setAttribute("data-internal-link","")}function Pv(t,e){var n=this,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"",a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:i&&(t.title=i),t.onclick=function(){var t;return null===(t=n.downloadManager)||void 0===t||t.openOrDownloadData(e.content,e.filename,a),!1},r(Cv,this,Rv).call(this)}function Iv(t,e){var n=this,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";t.href=this.linkService.getAnchorUrl(""),t.onclick=function(){return n.linkService.executeSetOCGState(e),!1},i&&(t.title=i),r(Cv,this,Rv).call(this)}var Dv=function(t){function e(t){return c(this,e),u(this,e,[t,{isRenderable:!0}])}return _(e,t),m(e,[{key:"render",value:function(){this.container.classList.add("textAnnotation");var t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}])}(Ev),Lv=function(t){function e(){return c(this,e),u(this,e,arguments)}return _(e,t),m(e,[{key:"render",value:function(){return this.container}},{key:"showElementAndHideCanvas",value:function(t){var e;this.data.hasOwnCanvas&&("CANVAS"===(null===(e=t.previousSibling)||void 0===e?void 0:e.nodeName)&&(t.previousSibling.hidden=!0),t.hidden=!1)}},{key:"_getKeyModifier",value:function(t){return Vr.platform.isMac?t.metaKey:t.ctrlKey}},{key:"_setEventListener",value:function(t,e,n,i,r){var a=this;n.includes("mouse")?t.addEventListener(n,(function(t){var e;null===(e=a.linkService.eventBus)||void 0===e||e.dispatch("dispatcheventinsandbox",{source:a,detail:{id:a.data.id,name:i,value:r(t),shift:t.shiftKey,modifier:a._getKeyModifier(t)}})})):t.addEventListener(n,(function(t){var s;if("blur"===n){if(!e.focused||!t.relatedTarget)return;e.focused=!1}else if("focus"===n){if(e.focused)return;e.focused=!0}r&&(null===(s=a.linkService.eventBus)||void 0===s||s.dispatch("dispatcheventinsandbox",{source:a,detail:{id:a.data.id,name:i,value:r(t)}}))}))}},{key:"_setEventListeners",value:function(t,e,n,i){var r,a=w(n);try{for(a.s();!(r=a.n()).done;){var s,o,l,u=D(r.value,2),h=u[0],c=u[1];if("Action"===c||null!==(s=this.data.actions)&&void 0!==s&&s[c])"Focus"!==c&&"Blur"!==c||e||(e={focused:!1}),this._setEventListener(t,e,h,c,i),"Focus"!==c||null!==(o=this.data.actions)&&void 0!==o&&o.Blur?"Blur"!==c||null!==(l=this.data.actions)&&void 0!==l&&l.Focus||this._setEventListener(t,e,"focus","Focus",null):this._setEventListener(t,e,"blur","Blur",null)}}catch(d){a.e(d)}finally{a.f()}}},{key:"_setBackgroundColor",value:function(t){var e=this.data.backgroundColor||null;t.style.backgroundColor=null===e?"transparent":Xr.makeHexColor(e[0],e[1],e[2])}},{key:"_setTextStyle",value:function(t){var e,n=this.data.defaultAppearanceData.fontColor,i=this.data.defaultAppearanceData.fontSize||9,r=t.style,a=function(t){return Math.round(10*t)/10};if(this.data.multiLine){var s=Math.abs(this.data.rect[3]-this.data.rect[1]-2),o=s/(Math.round(s/(qi*i))||1);e=Math.min(i,a(o/qi))}else{var l=Math.abs(this.data.rect[3]-this.data.rect[1]-2);e=Math.min(i,a(l/qi))}r.fontSize="calc(".concat(e,"px * var(--total-scale-factor))"),r.color=Xr.makeHexColor(n[0],n[1],n[2]),null!==this.data.textAlignment&&(r.textAlign=["left","center","right"][this.data.textAlignment])}},{key:"_setRequired",value:function(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}])}(Ev),Ov=function(t){function e(t){return c(this,e),u(this,e,[t,{isRenderable:t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue}])}return _(e,t),m(e,[{key:"setPropertyOnSiblings",value:function(t,e,n,i){var r,a=this.annotationStorage,s=w(this._getElementsByName(t.name,t.id));try{for(s.s();!(r=s.n()).done;){var o=r.value;o.domElement&&(o.domElement[e]=n),a.setValue(o.id,b({},i,n))}}catch(l){s.e(l)}finally{s.f()}}},{key:"render",value:function(){var t=this,e=this.annotationStorage,n=this.data.id;this.container.classList.add("textWidgetAnnotation");var i=null;if(this.renderForms){var r,a=e.getValue(n,{value:this.data.fieldValue}),s=a.value||"",o=e.getValue(n,{charLimit:this.data.maxLen}).charLimit;o&&s.length>o&&(s=s.slice(0,o));var l=a.formattedValue||(null===(r=this.data.textContent)||void 0===r?void 0:r.join("\n"))||null;l&&this.data.comb&&(l=l.replaceAll(/\s+/g,""));var u={userValue:s,formattedValue:l,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?((i=document.createElement("textarea")).textContent=null!=l?l:s,this.data.doNotScroll&&(i.style.overflowY="hidden")):((i=document.createElement("input")).type=this.data.password?"password":"text",i.setAttribute("value",null!=l?l:s),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),wv.add(i),i.setAttribute("data-element-id",n),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;var h=this.data,c=h.datetimeFormat,d=h.datetimeType,f=h.timeStep,v=!!d&&this.enableScripting;c&&(i.title=c),this._setRequired(i,this.data.required),o&&(i.maxLength=o),i.addEventListener("input",(function(r){e.setValue(n,{value:r.target.value}),t.setPropertyOnSiblings(i,"value",r.target.value,"value"),u.formattedValue=null})),i.addEventListener("resetform",(function(e){var n,r=null!==(n=t.data.defaultFieldValue)&&void 0!==n?n:"";i.value=u.userValue=r,u.formattedValue=null}));var p=function(t){var e=u.formattedValue;null!==e&&e!==undefined&&(t.target.value=e),t.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){var g;i.addEventListener("focus",(function(e){var n;if(!u.focused){var i=e.target;if(v&&(i.type=d,f&&(i.step=f)),u.userValue){var r=u.userValue;if(v)if("time"===d){var a=new Date(r),s=[a.getHours(),a.getMinutes(),a.getSeconds()];i.value=s.map((function(t){return t.toString().padStart(2,"0")})).join(":")}else i.value=new Date(r-bv).toISOString().split("date"===d?"T":".",1)[0];else i.value=r}u.lastCommittedValue=i.value,u.commitKey=1,null!==(n=t.data.actions)&&void 0!==n&&n.Focus||(u.focused=!0)}})),i.addEventListener("updatefromsandbox",(function(i){t.showElementAndHideCanvas(i.target);var r={value:function(t){var i;u.userValue=null!==(i=t.detail.value)&&void 0!==i?i:"",v||e.setValue(n,{value:u.userValue.toString()}),t.target.value=u.userValue},formattedValue:function(t){var i=t.detail.formattedValue;u.formattedValue=i,null!==i&&i!==undefined&&t.target!==document.activeElement&&(t.target.value=i);var r={formattedValue:i};v&&(r.value=i),e.setValue(n,r)},selRange:function(t){var e;(e=t.target).setSelectionRange.apply(e,F(t.detail.selRange))},charLimit:function(i){var r,a=i.detail.charLimit,s=i.target;if(0!==a){s.setAttribute("maxLength",a);var o=u.userValue;!o||o.length<=a||(o=o.slice(0,a),s.value=u.userValue=o,e.setValue(n,{value:o}),null===(r=t.linkService.eventBus)||void 0===r||r.dispatch("dispatcheventinsandbox",{source:t,detail:{id:n,name:"Keystroke",value:o,willCommit:!0,commitKey:1,selStart:s.selectionStart,selEnd:s.selectionEnd}}))}else s.removeAttribute("maxLength")}};t._dispatchEventFromSandbox(r,i)})),i.addEventListener("keydown",(function(e){var i;u.commitKey=1;var r=-1;if("Escape"===e.key?r=0:"Enter"!==e.key||t.data.multiLine?"Tab"===e.key&&(u.commitKey=3):r=2,-1!==r){var a=e.target.value;u.lastCommittedValue!==a&&(u.lastCommittedValue=a,u.userValue=a,null===(i=t.linkService.eventBus)||void 0===i||i.dispatch("dispatcheventinsandbox",{source:t,detail:{id:n,name:"Keystroke",value:a,willCommit:!0,commitKey:r,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}))}}));var y=p;p=null,i.addEventListener("blur",(function(e){var i;if(u.focused&&e.relatedTarget){null!==(i=t.data.actions)&&void 0!==i&&i.Blur||(u.focused=!1);var r,a=e.target,s=a.value;if(v){if(s&&"time"===d){var o=s.split(":").map((function(t){return parseInt(t,10)}));s=new Date(2e3,0,1,o[0],o[1],o[2]||0).valueOf(),a.step=""}else s=new Date(s).valueOf();a.type="text"}if(u.userValue=s,u.lastCommittedValue!==s)null===(r=t.linkService.eventBus)||void 0===r||r.dispatch("dispatcheventinsandbox",{source:t,detail:{id:n,name:"Keystroke",value:s,willCommit:!0,commitKey:u.commitKey,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}});y(e)}})),null!==(g=this.data.actions)&&void 0!==g&&g.Keystroke&&i.addEventListener("beforeinput",(function(e){var i;u.lastCommittedValue=null;var r=e.data,a=e.target,s=a.value,o=a.selectionStart,l=a.selectionEnd,h=o,c=l;switch(e.inputType){case"deleteWordBackward":var d=s.substring(0,o).match(/\w*[^\w]*$/);d&&(h-=d[0].length);break;case"deleteWordForward":var f=s.substring(o).match(/^[^\w]*\w*/);f&&(c+=f[0].length);break;case"deleteContentBackward":o===l&&(h-=1);break;case"deleteContentForward":o===l&&(c+=1)}e.preventDefault(),null===(i=t.linkService.eventBus)||void 0===i||i.dispatch("dispatcheventinsandbox",{source:t,detail:{id:n,name:"Keystroke",value:s,change:r||"",willCommit:!1,selStart:h,selEnd:c}})})),this._setEventListeners(i,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(function(t){return t.target.value}))}if(p&&i.addEventListener("blur",p),this.data.comb){var m=(this.data.rect[2]-this.data.rect[0])/o;i.classList.add("comb"),i.style.letterSpacing="calc(".concat(m,"px * var(--total-scale-factor) - 1ch)")}}else(i=document.createElement("div")).textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}])}(Lv),Fv=function(t){function e(t){return c(this,e),u(this,e,[t,{isRenderable:!!t.data.hasOwnCanvas}])}return _(e,t),m(e)}(Lv),Nv=function(t){function e(t){return c(this,e),u(this,e,[t,{isRenderable:t.renderForms}])}return _(e,t),m(e,[{key:"render",value:function(){var t=this,e=this.annotationStorage,n=this.data,i=n.id,r=e.getValue(i,{value:n.exportValue===n.fieldValue}).value;"string"==typeof r&&(r="Off"!==r,e.setValue(i,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");var a=document.createElement("input");return wv.add(a),a.setAttribute("data-element-id",i),a.disabled=n.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=n.fieldName,r&&a.setAttribute("checked",!0),a.setAttribute("exportValue",n.exportValue),a.tabIndex=0,a.addEventListener("change",(function(r){var a,s=r.target,o=s.name,l=s.checked,u=w(t._getElementsByName(o,i));try{for(u.s();!(a=u.n()).done;){var h=a.value,c=l&&h.exportValue===n.exportValue;h.domElement&&(h.domElement.checked=c),e.setValue(h.id,{value:c})}}catch(d){u.e(d)}finally{u.f()}e.setValue(i,{value:l})})),a.addEventListener("resetform",(function(t){var e=n.defaultFieldValue||"Off";t.target.checked=e===n.exportValue})),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",(function(n){var r={value:function(t){t.target.checked="Off"!==t.detail.value,e.setValue(i,{value:t.target.checked})}};t._dispatchEventFromSandbox(r,n)})),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(function(t){return t.target.checked}))),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}])}(Lv),Wv=function(t){function e(t){return c(this,e),u(this,e,[t,{isRenderable:t.renderForms}])}return _(e,t),m(e,[{key:"render",value:function(){var t=this;this.container.classList.add("buttonWidgetAnnotation","radioButton");var e=this.annotationStorage,n=this.data,i=n.id,r=e.getValue(i,{value:n.fieldValue===n.buttonValue}).value;if("string"==typeof r&&(r=r!==n.buttonValue,e.setValue(i,{value:r})),r){var a,s=w(this._getElementsByName(n.fieldName,i));try{for(s.s();!(a=s.n()).done;){var o=a.value;e.setValue(o.id,{value:!1})}}catch(h){s.e(h)}finally{s.f()}}var l=document.createElement("input");if(wv.add(l),l.setAttribute("data-element-id",i),l.disabled=n.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=n.fieldName,r&&l.setAttribute("checked",!0),l.tabIndex=0,l.addEventListener("change",(function(n){var r,a=n.target,s=a.name,o=a.checked,l=w(t._getElementsByName(s,i));try{for(l.s();!(r=l.n()).done;){var u=r.value;e.setValue(u.id,{value:!1})}}catch(h){l.e(h)}finally{l.f()}e.setValue(i,{value:o})})),l.addEventListener("resetform",(function(t){var e=n.defaultFieldValue;t.target.checked=null!==e&&e!==undefined&&e===n.buttonValue})),this.enableScripting&&this.hasJSActions){var u=n.buttonValue;l.addEventListener("updatefromsandbox",(function(n){var r={value:function(n){var r,a=u===n.detail.value,s=w(t._getElementsByName(n.target.name));try{for(s.s();!(r=s.n()).done;){var o=r.value,l=a&&o.id===i;o.domElement&&(o.domElement.checked=l),e.setValue(o.id,{value:l})}}catch(h){s.e(h)}finally{s.f()}}};t._dispatchEventFromSandbox(r,n)})),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(function(t){return t.target.checked}))}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}])}(Lv),Bv=function(t){function e(t){return c(this,e),u(this,e,[t,{ignoreBorder:t.data.hasAppearance}])}return _(e,t),m(e,[{key:"render",value:function(){var t=this,n=L(e,"render",this,3)([]);n.classList.add("buttonWidgetAnnotation","pushButton");var i=n.lastChild;return this.enableScripting&&this.hasJSActions&&i&&(this._setDefaultPropertiesFromJS(i),i.addEventListener("updatefromsandbox",(function(e){t._dispatchEventFromSandbox({},e)}))),n}}])}(Tv),jv=function(t){function e(t){return c(this,e),u(this,e,[t,{isRenderable:t.renderForms}])}return _(e,t),m(e,[{key:"render",value:function(){var t=this;this.container.classList.add("choiceWidgetAnnotation");var e=this.annotationStorage,n=this.data.id,i=e.getValue(n,{value:this.data.fieldValue}),r=document.createElement("select");wv.add(r),r.setAttribute("data-element-id",n),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;var a=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",(function(e){var n,i=t.data.defaultFieldValue,a=w(r.options);try{for(a.s();!(n=a.n()).done;){var s=n.value;s.selected=s.value===i}}catch(o){a.e(o)}finally{a.f()}}));var s,o=w(this.data.options);try{for(o.s();!(s=o.n()).done;){var l=s.value,u=document.createElement("option");u.textContent=l.displayValue,u.value=l.exportValue,i.value.includes(l.exportValue)&&(u.setAttribute("selected",!0),a=!1),r.append(u)}}catch(p){o.e(p)}finally{o.f()}var h=null;if(a){var c=document.createElement("option");c.value=" ",c.setAttribute("hidden",!0),c.setAttribute("selected",!0),r.prepend(c),h=function(){c.remove(),r.removeEventListener("input",h),h=null},r.addEventListener("input",h)}var d=function(t){var e=t?"value":"textContent",n=r.options;return r.multiple?Array.prototype.filter.call(n,(function(t){return t.selected})).map((function(t){return t[e]})):-1===n.selectedIndex?null:n[n.selectedIndex][e]},f=d(!1),v=function(t){var e=t.target.options;return Array.prototype.map.call(e,(function(t){return{displayValue:t.textContent,exportValue:t.value}}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",(function(i){var a={value:function(t){var i;null===(i=h)||void 0===i||i();var a,s=t.detail.value,o=new Set(Array.isArray(s)?s:[s]),l=w(r.options);try{for(l.s();!(a=l.n()).done;){var u=a.value;u.selected=o.has(u.value)}}catch(p){l.e(p)}finally{l.f()}e.setValue(n,{value:d(!0)}),f=d(!1)},multipleSelection:function(t){r.multiple=!0},remove:function(t){var i=r.options,a=t.detail.remove;if(i[a].selected=!1,r.remove(a),i.length>0){var s=Array.prototype.findIndex.call(i,(function(t){return t.selected}));-1===s&&(i[0].selected=!0)}e.setValue(n,{value:d(!0),items:v(t)}),f=d(!1)},clear:function(t){for(;0!==r.length;)r.remove(0);e.setValue(n,{value:null,items:[]}),f=d(!1)},insert:function(t){var i=t.detail.insert,a=i.index,s=i.displayValue,o=i.exportValue,l=r.children[a],u=document.createElement("option");u.textContent=s,u.value=o,l?l.before(u):r.append(u),e.setValue(n,{value:d(!0),items:v(t)}),f=d(!1)},items:function(t){for(var i=t.detail.items;0!==r.length;)r.remove(0);var a,s=w(i);try{for(s.s();!(a=s.n()).done;){var o=a.value,l=o.displayValue,u=o.exportValue,h=document.createElement("option");h.textContent=l,h.value=u,r.append(h)}}catch(p){s.e(p)}finally{s.f()}r.options.length>0&&(r.options[0].selected=!0),e.setValue(n,{value:d(!0),items:v(t)}),f=d(!1)},indices:function(t){var i,r=new Set(t.detail.indices),a=w(t.target.options);try{for(a.s();!(i=a.n()).done;){var s=i.value;s.selected=r.has(s.index)}}catch(p){a.e(p)}finally{a.f()}e.setValue(n,{value:d(!0)}),f=d(!1)},editable:function(t){t.target.disabled=!t.detail.editable}};t._dispatchEventFromSandbox(a,i)})),r.addEventListener("input",(function(i){var r,a=d(!0),s=d(!1);e.setValue(n,{value:a}),i.preventDefault(),null===(r=t.linkService.eventBus)||void 0===r||r.dispatch("dispatcheventinsandbox",{source:t,detail:{id:n,name:"Keystroke",value:f,change:s,changeEx:a,willCommit:!1,commitKey:1,keyDown:!1}})})),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],(function(t){return t.target.value}))):r.addEventListener("input",(function(t){e.setValue(n,{value:d(!0)})})),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}])}(Lv),Hv=function(t){function e(t){var n;c(this,e);var i=t.data,r=t.elements;return(n=u(this,e,[t,{isRenderable:Ev._hasPopupData(i)}])).elements=r,n.popup=null,n}return _(e,t),m(e,[{key:"render",value:function(){var t=this.container;t.classList.add("popupAnnotation"),t.role="comment";var e,n=this.popup=new up({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),i=[],r=w(this.elements);try{for(r.s();!(e=r.n()).done;){var a=e.value;a.popup=n,a.container.ariaHasPopup="dialog",i.push(a.data.id),a.addHighlightArea()}}catch(s){r.e(s)}finally{r.f()}return this.container.setAttribute("aria-controls",i.map((function(t){return"".concat(ta).concat(t)})).join(",")),this.container}}])}(Ev),Uv=new WeakMap,zv=new WeakMap,Gv=new WeakMap,Vv=new WeakMap,qv=new WeakMap,Xv=new WeakMap,Yv=new WeakMap,Kv=new WeakMap,Qv=new WeakMap,Jv=new WeakMap,Zv=new WeakMap,$v=new WeakMap,tp=new WeakMap,ep=new WeakMap,np=new WeakMap,ip=new WeakMap,rp=new WeakMap,ap=new WeakMap,sp=new WeakMap,op=new WeakMap,lp=new WeakSet,up=function(){return m((function t(e){var n=e.container,i=e.color,a=e.elements,s=e.titleObj,o=e.modificationDate,l=e.contentsObj,u=e.richText,h=e.parent,p=e.rect,y=e.parentRect,m=e.open;c(this,t),g(this,lp),f(this,Uv,r(lp,this,pp).bind(this)),f(this,zv,r(lp,this,wp).bind(this)),f(this,Gv,r(lp,this,mp).bind(this)),f(this,Vv,r(lp,this,yp).bind(this)),f(this,qv,null),f(this,Xv,null),f(this,Yv,null),f(this,Kv,null),f(this,Qv,null),f(this,Jv,null),f(this,Zv,null),f(this,$v,!1),f(this,tp,null),f(this,ep,null),f(this,np,null),f(this,ip,null),f(this,rp,null),f(this,ap,null),f(this,sp,null),f(this,op,!1),v(Xv,this,n),v(ap,this,s),v(Yv,this,l),v(rp,this,u),v(Jv,this,h),v(qv,this,i),v(ip,this,p),v(Zv,this,y),v(Qv,this,a),v(Kv,this,ya.toDateObject(o)),this.trigger=a.flatMap((function(t){return t.getElementsToTriggerPopup()})),r(lp,this,hp).call(this),d(Xv,this).hidden=!0,m&&r(lp,this,yp).call(this)}),[{key:"render",value:function(){var t;if(!d(tp,this)){var e=v(tp,this,document.createElement("div"));if(e.className="popup",d(qv,this)){var n=e.style.outlineColor=Xr.makeHexColor.apply(Xr,F(d(qv,this)));e.style.backgroundColor="color-mix(in srgb, ".concat(n," 30%, white)")}var i=document.createElement("span");if(i.className="header",null!==(t=d(ap,this))&&void 0!==t&&t.str){var r=document.createElement("span");r.className="title",i.append(r);var a=d(ap,this);r.dir=a.dir,r.textContent=a.str}if(e.append(i),d(Kv,this)){var s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:d(Kv,this).valueOf()})),s.dateTime=d(Kv,this).toISOString(),i.append(s)}var o=p(lp,this,cp);if(o)mv.render({xfaHtml:o,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{var l=this._formatContents(d(Yv,this));e.append(l)}d(Xv,this).append(e)}}},{key:"_formatContents",value:function(t){var e=t.str,n=t.dir,i=document.createElement("p");i.classList.add("popupContent"),i.dir=n;for(var r=e.split(/(?:\r\n?|\n)/),a=0,s=r.length;a<s;++a){var o=r[a];i.append(document.createTextNode(o)),a<s-1&&i.append(document.createElement("br"))}return i}},{key:"updateEdited",value:function(t){var e,n=t.rect,i=t.popup;t.deleted||null!=i&&i.deleted?this.remove():(r(lp,this,hp).call(this),d(sp,this)||v(sp,this,{contentsObj:d(Yv,this),richText:d(rp,this)}),n&&v(np,this,null),i&&(v(rp,this,r(lp,this,vp).call(this,i.text)),v(Kv,this,ya.toDateObject(i.date)),v(Yv,this,null)),null===(e=d(tp,this))||void 0===e||e.remove(),v(tp,this,null))}},{key:"resetEdited",value:function(){var t;if(d(sp,this)){var e=d(sp,this);W(v,[Yv,this])._=e.contentsObj,W(v,[rp,this])._=e.richText,v(sp,this,null),null===(t=d(tp,this))||void 0===t||t.remove(),v(tp,this,null),v(np,this,null)}}},{key:"remove",value:function(){var t,e;null===(t=d(ep,this))||void 0===t||t.abort(),v(ep,this,null),null===(e=d(tp,this))||void 0===e||e.remove(),v(tp,this,null),v(op,this,!1),v($v,this,!1);var n,i=w(this.trigger);try{for(i.s();!(n=i.n()).done;){n.value.classList.remove("popupTriggerArea")}}catch(r){i.e(r)}finally{i.f()}}},{key:"forceHide",value:function(){v(op,this,this.isVisible),d(op,this)&&(d(Xv,this).hidden=!0)}},{key:"maybeShow",value:function(){r(lp,this,hp).call(this),d(op,this)&&(d(tp,this)||r(lp,this,mp).call(this),v(op,this,!1),d(Xv,this).hidden=!1)}},{key:"isVisible",get:function(){return!1===d(Xv,this).hidden}}])}();function hp(){if(!d(ep,this)){v(ep,this,new AbortController);var t,e=d(ep,this).signal,n=w(this.trigger);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.addEventListener("click",d(Vv,this),{signal:e}),i.addEventListener("mouseenter",d(Gv,this),{signal:e}),i.addEventListener("mouseleave",d(zv,this),{signal:e}),i.classList.add("popupTriggerArea")}}catch(o){n.e(o)}finally{n.f()}var r,a=w(d(Qv,this));try{for(a.s();!(r=a.n()).done;){var s;null===(s=r.value.container)||void 0===s||s.addEventListener("keydown",d(Uv,this),{signal:e})}}catch(o){a.e(o)}finally{a.f()}}}function cp(t){var e=d(rp,t),n=d(Yv,t);return null==e||!e.str||null!=n&&n.str&&n.str!==e.str?null:d(rp,t).html||null}function dp(t){var e;return(null===(e=p(lp,t,cp))||void 0===e||null===(e=e.attributes)||void 0===e||null===(e=e.style)||void 0===e?void 0:e.fontSize)||0}function fp(t){var e;return(null===(e=p(lp,t,cp))||void 0===e||null===(e=e.attributes)||void 0===e||null===(e=e.style)||void 0===e?void 0:e.color)||null}function vp(t){var e,n=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:n}]}},r={style:{color:p(lp,this,fp),fontSize:p(lp,this,dp)?"calc(".concat(p(lp,this,dp),"px * var(--total-scale-factor))"):""}},a=w(t.split("\n"));try{for(a.s();!(e=a.n()).done;){var s=e.value;n.push({name:"span",value:s,attributes:r})}}catch(o){a.e(o)}finally{a.f()}return i}function pp(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||("Enter"===t.key||"Escape"===t.key&&d($v,this))&&r(lp,this,yp).call(this)}function gp(){if(null===d(np,this)){var t,e=d(Jv,this),n=e.page.view,i=e.viewport.rawDims,r=i.pageWidth,a=i.pageHeight,s=i.pageX,o=i.pageY,l=!!d(Zv,this),u=d(l?Zv:ip,this),h=w(d(Qv,this));try{for(h.s();!(t=h.n()).done;){var c=t.value;if(!u||null!==Xr.intersect(c.data.rect,u)){u=c.data.rect,l=!0;break}}}catch(b){h.e(b)}finally{h.f()}var f=Xr.normalizeRect([u[0],n[3]-u[1]+n[1],u[2],n[3]-u[3]+n[1]]),p=l?u[2]-u[0]+5:0,g=f[0]+p,y=f[1];v(np,this,[100*(g-s)/r,100*(y-o)/a]);var m=d(Xv,this).style;m.left="".concat(d(np,this)[0],"%"),m.top="".concat(d(np,this)[1],"%")}}function yp(){v($v,this,!d($v,this)),d($v,this)?(r(lp,this,mp).call(this),d(Xv,this).addEventListener("click",d(Vv,this)),d(Xv,this).addEventListener("keydown",d(Uv,this))):(r(lp,this,wp).call(this),d(Xv,this).removeEventListener("click",d(Vv,this)),d(Xv,this).removeEventListener("keydown",d(Uv,this)))}function mp(){d(tp,this)||this.render(),this.isVisible?d($v,this)&&d(Xv,this).classList.add("focused"):(r(lp,this,gp).call(this),d(Xv,this).hidden=!1,d(Xv,this).style.zIndex=parseInt(d(Xv,this).style.zIndex)+1e3)}function wp(){d(Xv,this).classList.remove("focused"),!d($v,this)&&this.isVisible&&(d(Xv,this).hidden=!0,d(Xv,this).style.zIndex=parseInt(d(Xv,this).style.zIndex)-1e3)}var bp=function(t){function e(t){var n;return c(this,e),(n=u(this,e,[t,{isRenderable:!0,ignoreBorder:!0}])).textContent=t.data.textContent,n.textPosition=t.data.textPosition,n.annotationEditorType=ir.FREETEXT,n}return _(e,t),m(e,[{key:"render",value:function(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){var t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");var e,n=w(this.textContent);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=document.createElement("span");r.textContent=i,t.append(r)}}catch(a){n.e(a)}finally{n.f()}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}])}(Ev),kp=new WeakMap,Ap=function(t){function e(t){var n;return c(this,e),f(n=u(this,e,[t,{isRenderable:!0,ignoreBorder:!0}]),kp,null),n}return _(e,t),m(e,[{key:"render",value:function(){this.container.classList.add("lineAnnotation");var t=this.data,e=this.width,n=this.height,i=this.svgFactory.create(e,n,!0),r=v(kp,this,this.svgFactory.createElement("svg:line"));return r.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),r.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),r.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),r.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),r.setAttribute("stroke-width",t.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}},{key:"getElementsToTriggerPopup",value:function(){return d(kp,this)}},{key:"addHighlightArea",value:function(){this.container.classList.add("highlightArea")}}])}(Ev),_p=new WeakMap,xp=function(t){function e(t){var n;return c(this,e),f(n=u(this,e,[t,{isRenderable:!0,ignoreBorder:!0}]),_p,null),n}return _(e,t),m(e,[{key:"render",value:function(){this.container.classList.add("squareAnnotation");var t=this.data,e=this.width,n=this.height,i=this.svgFactory.create(e,n,!0),r=t.borderStyle.width,a=v(_p,this,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",r/2),a.setAttribute("y",r/2),a.setAttribute("width",e-r),a.setAttribute("height",n-r),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}},{key:"getElementsToTriggerPopup",value:function(){return d(_p,this)}},{key:"addHighlightArea",value:function(){this.container.classList.add("highlightArea")}}])}(Ev),Sp=new WeakMap,Ep=function(t){function e(t){var n;return c(this,e),f(n=u(this,e,[t,{isRenderable:!0,ignoreBorder:!0}]),Sp,null),n}return _(e,t),m(e,[{key:"render",value:function(){this.container.classList.add("circleAnnotation");var t=this.data,e=this.width,n=this.height,i=this.svgFactory.create(e,n,!0),r=t.borderStyle.width,a=v(Sp,this,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",e/2),a.setAttribute("cy",n/2),a.setAttribute("rx",e/2-r/2),a.setAttribute("ry",n/2-r/2),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}},{key:"getElementsToTriggerPopup",value:function(){return d(Sp,this)}},{key:"addHighlightArea",value:function(){this.container.classList.add("highlightArea")}}])}(Ev),Mp=new WeakMap,Cp=function(t){function e(t){var n;return c(this,e),f(n=u(this,e,[t,{isRenderable:!0,ignoreBorder:!0}]),Mp,null),n.containerClassName="polylineAnnotation",n.svgElementName="svg:polyline",n}return _(e,t),m(e,[{key:"render",value:function(){this.container.classList.add(this.containerClassName);var t=this.data,e=t.rect,n=t.vertices,i=t.borderStyle,r=t.popupRef,a=this.width,s=this.height;if(!n)return this.container;for(var o=this.svgFactory.create(a,s,!0),l=[],u=0,h=n.length;u<h;u+=2){var c=n[u]-e[0],d=e[3]-n[u+1];l.push("".concat(c,",").concat(d))}l=l.join(" ");var f=v(Mp,this,this.svgFactory.createElement(this.svgElementName));return f.setAttribute("points",l),f.setAttribute("stroke-width",i.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),o.append(f),this.container.append(o),!r&&this.hasPopupData&&this._createPopup(),this.container}},{key:"getElementsToTriggerPopup",value:function(){return d(Mp,this)}},{key:"addHighlightArea",value:function(){this.container.classList.add("highlightArea")}}])}(Ev),Tp=function(t){function e(t){var n;return c(this,e),(n=u(this,e,[t])).containerClassName="polygonAnnotation",n.svgElementName="svg:polygon",n}return _(e,t),m(e)}(Cp),Rp=function(t){function e(t){return c(this,e),u(this,e,[t,{isRenderable:!0,ignoreBorder:!0}])}return _(e,t),m(e,[{key:"render",value:function(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}])}(Ev),Pp=new WeakMap,Ip=new WeakMap,Dp=new WeakSet,Lp=function(t){function e(t){var n;return c(this,e),g(n=u(this,e,[t,{isRenderable:!0,ignoreBorder:!0}]),Dp),f(n,Pp,null),f(n,Ip,[]),n.containerClassName="inkAnnotation",n.svgElementName="svg:polyline",n.annotationEditorType="InkHighlight"===n.data.it?ir.HIGHLIGHT:ir.INK,n}return _(e,t),m(e,[{key:"render",value:function(){this.container.classList.add(this.containerClassName);var t=this.data,e=t.rect,n=t.rotation,i=t.inkLists,a=t.borderStyle,s=t.popupRef,o=r(Dp,this,Op).call(this,n,e),l=o.transform,u=o.width,h=o.height,c=this.svgFactory.create(u,h,!0),f=v(Pp,this,this.svgFactory.createElement("svg:g"));c.append(f),f.setAttribute("stroke-width",a.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",l);for(var p=0,g=i.length;p<g;p++){var y=this.svgFactory.createElement(this.svgElementName);d(Ip,this).push(y),y.setAttribute("points",i[p].join(",")),f.append(y)}return!s&&this.hasPopupData&&this._createPopup(),this.container.append(c),this._editOnDoubleClick(),this.container}},{key:"updateEdited",value:function(t){L(e,"updateEdited",this,3)([t]);var n=t.thickness,i=t.points,a=t.rect,s=d(Pp,this);if(n>=0&&s.setAttribute("stroke-width",n||1),i)for(var o=0,l=d(Ip,this).length;o<l;o++)d(Ip,this)[o].setAttribute("points",i[o].join(","));if(a){var u=r(Dp,this,Op).call(this,this.data.rotation,a),h=u.transform,c=u.width,f=u.height;s.parentElement.setAttribute("viewBox","0 0 ".concat(c," ").concat(f)),s.setAttribute("transform",h)}}},{key:"getElementsToTriggerPopup",value:function(){return d(Ip,this)}},{key:"addHighlightArea",value:function(){this.container.classList.add("highlightArea")}}])}(Ev);function Op(t,e){switch(t){case 90:return{transform:"rotate(90) translate(".concat(-e[0],",").concat(e[1],") scale(1,-1)"),width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:"rotate(180) translate(".concat(-e[2],",").concat(e[1],") scale(1,-1)"),width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:"rotate(270) translate(".concat(-e[2],",").concat(e[3],") scale(1,-1)"),width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:"translate(".concat(-e[0],",").concat(e[3],") scale(1,-1)"),width:e[2]-e[0],height:e[3]-e[1]}}}var Fp=function(t){function e(t){var n;return c(this,e),(n=u(this,e,[t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}])).annotationEditorType=ir.HIGHLIGHT,n}return _(e,t),m(e,[{key:"render",value:function(){var t=this.data,e=t.overlaidText;if(!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){var n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}])}(Ev),Np=function(t){function e(t){return c(this,e),u(this,e,[t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}])}return _(e,t),m(e,[{key:"render",value:function(){var t=this.data,e=t.overlaidText;if(!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){var n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}])}(Ev),Wp=function(t){function e(t){return c(this,e),u(this,e,[t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}])}return _(e,t),m(e,[{key:"render",value:function(){var t=this.data,e=t.overlaidText;if(!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){var n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}])}(Ev),Bp=function(t){function e(t){return c(this,e),u(this,e,[t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}])}return _(e,t),m(e,[{key:"render",value:function(){var t=this.data,e=t.overlaidText;if(!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){var n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}])}(Ev),jp=function(t){function e(t){var n;return c(this,e),(n=u(this,e,[t,{isRenderable:!0,ignoreBorder:!0}])).annotationEditorType=ir.STAMP,n}return _(e,t),m(e,[{key:"render",value:function(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}])}(Ev),Hp=new WeakMap,Up=new WeakSet,zp=function(t){function e(t){var n,i;c(this,e),g(i=u(this,e,[t,{isRenderable:!0}]),Up),f(i,Hp,null);var r=i.data.file;return i.filename=r.filename,i.content=r.content,null===(n=i.linkService.eventBus)||void 0===n||n.dispatch("fileattachmentannotation",C({source:i},r)),i}return _(e,t),m(e,[{key:"render",value:function(){var t=this;this.container.classList.add("fileAttachmentAnnotation");var e,n=this.container,i=this.data;i.hasAppearance||0===i.fillAlpha?e=document.createElement("div"):((e=document.createElement("img")).src="".concat(this.imageResourcesPath,"annotation-").concat(/paperclip/i.test(i.name)?"paperclip":"pushpin",".svg"),i.fillAlpha&&i.fillAlpha<1&&(e.style="filter: opacity(".concat(Math.round(100*i.fillAlpha),"%);"))),e.addEventListener("dblclick",r(Up,this,Gp).bind(this)),v(Hp,this,e);var a=Vr.platform.isMac;return n.addEventListener("keydown",(function(e){"Enter"===e.key&&(a?e.metaKey:e.ctrlKey)&&r(Up,t,Gp).call(t)})),!i.popupRef&&this.hasPopupData?this._createPopup():e.classList.add("popupTriggerArea"),n.append(e),n}},{key:"getElementsToTriggerPopup",value:function(){return d(Hp,this)}},{key:"addHighlightArea",value:function(){this.container.classList.add("highlightArea")}}])}(Ev);function Gp(){var t;null===(t=this.downloadManager)||void 0===t||t.openOrDownloadData(this.content,this.filename)}var Vp=new WeakMap,qp=new WeakMap,Xp=new WeakMap,Yp=new WeakMap,Kp=new WeakSet,Qp=function(){function t(e){var n=e.div,i=e.accessibilityManager,r=e.annotationCanvasMap,a=e.annotationEditorUIManager,s=e.page,o=e.viewport,l=e.structTreeLayer;c(this,t),g(this,Kp),f(this,Vp,null),f(this,qp,null),f(this,Xp,new Map),f(this,Yp,null),this.div=n,v(Vp,this,i),v(qp,this,r),v(Yp,this,l||null),this.page=s,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=a}return m(t,[{key:"hasEditableAnnotations",value:function(){return d(Xp,this).size>0}},{key:"render",value:(n=l(T().m((function i(t){var e,n,a,s,o,l,u,h,c,f,v,p,g,y;return T().w((function(i){for(;;)switch(i.p=i.n){case 0:e=t.annotations,_a(n=this.div,this.viewport),a=new Map,s={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:!1!==t.renderForms,svgFactory:new yv,annotationStorage:t.annotationStorage||new _u,enableScripting:!0===t.enableScripting,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null},o=w(e),i.p=1,o.s();case 2:if((l=o.n()).done){i.n=11;break}if(!(u=l.value).noHTML){i.n=3;break}return i.a(3,10);case 3:if(h=u.annotationType===fr.POPUP){i.n=5;break}if(u.rect[2]!==u.rect[0]&&u.rect[3]!==u.rect[1]){i.n=4;break}return i.a(3,10);case 4:i.n=7;break;case 5:if(c=a.get(u.id)){i.n=6;break}return i.a(3,10);case 6:s.elements=c;case 7:if(s.data=u,(f=kv.create(s)).isRenderable){i.n=8;break}return i.a(3,10);case 8:return!h&&u.popupRef&&((v=a.get(u.popupRef))?v.push(f):a.set(u.popupRef,[f])),p=f.render(),u.hidden&&(p.style.visibility="hidden"),i.n=9,r(Kp,this,Jp).call(this,p,u.id,s.elements);case 9:f._isEditable&&(d(Xp,this).set(f.data.id,f),null===(g=this._annotationEditorUIManager)||void 0===g||g.renderAnnotationElement(f));case 10:i.n=2;break;case 11:i.n=13;break;case 12:i.p=12,y=i.v,o.e(y);case 13:return i.p=13,o.f(),i.f(13);case 14:r(Kp,this,$p).call(this);case 15:return i.a(2)}}),i,this,[[1,12,13,14]])}))),function(t){return n.apply(this,arguments)})},{key:"addLinkAnnotations",value:(e=l(T().m((function a(e,n){var i,s,o,l,u,h,c;return T().w((function(a){for(;;)switch(a.p=a.n){case 0:i={data:null,layer:this.div,linkService:n,svgFactory:new yv,parent:this},s=w(e),a.p=1,s.s();case 2:if((o=s.n()).done){a.n=5;break}if((l=o.value).borderStyle||(l.borderStyle=t._defaultBorderStyle),i.data=l,(u=kv.create(i)).isRenderable){a.n=3;break}return a.a(3,4);case 3:return h=u.render(),a.n=4,r(Kp,this,Jp).call(this,h,l.id,null);case 4:a.n=2;break;case 5:a.n=7;break;case 6:a.p=6,c=a.v,s.e(c);case 7:return a.p=7,s.f(),a.f(7);case 8:return a.a(2)}}),a,this,[[1,6,7,8]])}))),function(t,n){return e.apply(this,arguments)})},{key:"update",value:function(t){var e=t.viewport,n=this.div;this.viewport=e,_a(n,{rotation:e.rotation}),r(Kp,this,$p).call(this),n.hidden=!1}},{key:"getEditableAnnotations",value:function(){return Array.from(d(Xp,this).values())}},{key:"getEditableAnnotation",value:function(t){return d(Xp,this).get(t)}}],[{key:"_defaultBorderStyle",get:function(){return Or(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:vr,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}]);var e,n}();function Jp(t,e,n){return Zp.apply(this,arguments)}function Zp(){return(Zp=l(T().m((function t(e,n,i){var r,a,s,o,l,u,h,c,f,v;return T().w((function(t){for(;;)switch(t.n){case 0:return a=e.firstChild||e,s=a.id="".concat(ta).concat(n),t.n=1,null===(r=d(Yp,this))||void 0===r?void 0:r.getAriaAttributes(s);case 1:if(o=t.v){l=w(o);try{for(l.s();!(u=l.n()).done;)h=D(u.value,2),c=h[0],f=h[1],a.setAttribute(c,f)}catch(p){l.e(p)}finally{l.f()}}i?i.at(-1).container.after(e):(this.div.append(e),null===(v=d(Vp,this))||void 0===v||v.moveElementInDOM(this.div,e,a,!1));case 2:return t.a(2)}}),t,this)})))).apply(this,arguments)}function $p(){if(d(qp,this)){var t,e=this.div,n=w(d(qp,this));try{for(n.s();!(t=n.n()).done;){var i=D(t.value,2),r=i[0],a=i[1],s=e.querySelector('[data-annotation-id="'.concat(r,'"]'));if(s){a.className="annotationContent";var o=s.firstChild;o?"CANVAS"===o.nodeName?o.replaceWith(a):o.classList.contains("annotationContent")?o.after(a):o.before(a):s.append(a);var l,u=d(Xp,this).get(r);if(u)if(u._hasNoCanvas)null===(l=this._annotationEditorUIManager)||void 0===l||l.setMissingCanvas(r,s.id,a),u._hasNoCanvas=!1;else u.canvas=a}}}catch(h){n.e(h)}finally{n.f()}d(qp,this).clear()}}var tg=/\r\n?|\n/g,eg=new WeakMap,ng=new WeakMap,ig=new WeakMap,rg=new WeakMap,ag=new WeakMap,sg=new WeakSet,og=function(t){function e(t){var n;return c(this,e),g(n=u(this,e,[C(C({},t),{},{name:"freeTextEditor"})]),sg),f(n,eg,void 0),f(n,ng,""),f(n,ig,"".concat(n.id,"-editor")),f(n,rg,null),f(n,ag,void 0),b(n,"_colorPicker",null),v(eg,n,t.color||e._defaultColor||Xl._defaultLineColor),v(ag,n,t.fontSize||e._defaultFontSize),n.annotationElementId||n._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),n}return _(e,t),m(e,[{key:"updateParams",value:function(t,e){switch(t){case rr.FREETEXT_SIZE:r(sg,this,lg).call(this,e);break;case rr.FREETEXT_COLOR:r(sg,this,ug).call(this,e)}}},{key:"propertiesToUpdate",get:function(){return[[rr.FREETEXT_SIZE,d(ag,this)],[rr.FREETEXT_COLOR,d(eg,this)]]}},{key:"toolbarButtons",get:function(){return this._colorPicker||(this._colorPicker=new cv(this)),[["colorPicker",this._colorPicker]]}},{key:"colorType",get:function(){return rr.FREETEXT_COLOR}},{key:"colorValue",get:function(){return d(eg,this)}},{key:"_translateEmpty",value:function(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}},{key:"getInitialTranslation",value:function(){var t=this.parentScale;return[-e._internalPadding*t,-(e._internalPadding+d(ag,this))*t]}},{key:"rebuild",value:function(){this.parent&&(L(e,"rebuild",this,3)([]),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}},{key:"enableEditMode",value:function(){if(!L(e,"enableEditMode",this,3)([]))return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),v(rg,this,new AbortController);var t=this._uiManager.combinedSignal(d(rg,this));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}},{key:"disableEditMode",value:function(){var t;return!!L(e,"disableEditMode",this,3)([])&&(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",d(ig,this)),this._isDraggable=!0,null===(t=d(rg,this))||void 0===t||t.abort(),v(rg,this,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0)}},{key:"focusin",value:function(t){this._focusEventsAllowed&&(L(e,"focusin",this,3)([t]),t.target!==this.editorDiv&&this.editorDiv.focus())}},{key:"onceAdded",value:function(t){var e;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),null!==(e=this._initialOptions)&&void 0!==e&&e.isCentered&&this.center(),this._initialOptions=null)}},{key:"isEmpty",value:function(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}},{key:"remove",value:function(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),L(e,"remove",this,3)([])}},{key:"commit",value:function(){var t=this;if(this.isInEditMode()){L(e,"commit",this,3)([]),this.disableEditMode();var n=d(ng,this),i=v(ng,this,r(sg,this,hg).call(this).trimEnd());if(n!==i){var a=function(e){v(ng,t,e),e?(r(sg,t,fg).call(t),t._uiManager.rebuild(t),r(sg,t,cg).call(t)):t.remove()};this.addCommands({cmd:function(){a(i)},undo:function(){a(n)},mustExec:!1}),r(sg,this,cg).call(this)}}}},{key:"shouldGetKeyboardEvents",value:function(){return this.isInEditMode()}},{key:"enterInEditMode",value:function(){this.enableEditMode(),this.editorDiv.focus()}},{key:"keydown",value:function(t){t.target===this.div&&"Enter"===t.key&&(this.enterInEditMode(),t.preventDefault())}},{key:"editorDivKeydown",value:function(t){e._keyboardManager.exec(this,t)}},{key:"editorDivFocus",value:function(t){this.isEditing=!0}},{key:"editorDivBlur",value:function(t){this.isEditing=!1}},{key:"editorDivInput",value:function(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}},{key:"disableEditing",value:function(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}},{key:"enableEditing",value:function(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}},{key:"canChangeContent",get:function(){return!0}},{key:"render",value:function(){if(this.div)return this.div;var t,n;(this._isCopy||this.annotationElementId)&&(t=this.x,n=this.y),L(e,"render",this,3)([]),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",d(ig,this)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;var i=this.editorDiv.style;if(i.fontSize="calc(".concat(d(ag,this),"px * var(--total-scale-factor))"),i.color=d(eg,this),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){var a=D(this.parentDimensions,2),s=a[0],o=a[1];if(this.annotationElementId){var l=this._initialData.position,u=D(this.getInitialTranslation(),2),h=u[0],c=u[1],f=D(this.pageTranslationToScreen(h,c),2);h=f[0],c=f[1];var v,p,g=D(this.pageDimensions,2),y=g[0],m=g[1],w=D(this.pageTranslation,2),b=w[0],k=w[1];switch(this.rotation){case 0:v=t+(l[0]-b)/y,p=n+this.height-(l[1]-k)/m;break;case 90:v=t+(l[0]-b)/y,p=n-(l[1]-k)/m;var A=[c,-h];h=A[0],c=A[1];break;case 180:v=t-this.width+(l[0]-b)/y,p=n-(l[1]-k)/m;var _=[-h,-c];h=_[0],c=_[1];break;case 270:v=t+(l[0]-b-this.height*m)/y,p=n+(l[1]-k-this.width*y)/m;var x=[-c,h];h=x[0],c=x[1]}this.setAt(v*s,p*o,h,c)}else this._moveAfterPaste(t,n);r(sg,this,fg).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}},{key:"editorDivPaste",value:function(t){var n=t.clipboardData||window.clipboardData,i=n.types;if(1!==i.length||"text/plain"!==i[0]){t.preventDefault();var a=pg.call(e,n.getData("text")||"").replaceAll(tg,"\n");if(a){var s=window.getSelection();if(s.rangeCount){this.editorDiv.normalize(),s.deleteFromDocument();var o=s.getRangeAt(0);if(!a.includes("\n"))return o.insertNode(document.createTextNode(a)),this.editorDiv.normalize(),void s.collapseToStart();var l=o.startContainer,u=o.startOffset,h=[],c=[];if(l.nodeType===Node.TEXT_NODE){var d=l.parentElement;if(c.push(l.nodeValue.slice(u).replaceAll(tg,"")),d!==this.editorDiv){var f,p=h,g=w(this.editorDiv.childNodes);try{for(g.s();!(f=g.n()).done;){var y=f.value;y!==d?p.push(dg.call(e,y)):p=c}}catch(R){g.e(R)}finally{g.f()}}h.push(l.nodeValue.slice(0,u).replaceAll(tg,""))}else if(l===this.editorDiv){var m,b=h,k=0,A=w(this.editorDiv.childNodes);try{for(A.s();!(m=A.n()).done;){var _=m.value;k++===u&&(b=c),b.push(dg.call(e,_))}}catch(R){A.e(R)}finally{A.f()}}v(ng,this,"".concat(h.join("\n")).concat(a).concat(c.join("\n"))),r(sg,this,fg).call(this);var x,S=new Range,E=Math.sumPrecise(h.map((function(t){return t.length}))),M=w(this.editorDiv.childNodes);try{for(M.s();!(x=M.n()).done;){var C=x.value.firstChild;if(C.nodeType===Node.TEXT_NODE){var T=C.nodeValue.length;if(E<=T){S.setStart(C,E),S.setEnd(C,E);break}E-=T}}}catch(R){M.e(R)}finally{M.f()}s.removeAllRanges(),s.addRange(S)}}}}},{key:"contentDiv",get:function(){return this.editorDiv}},{key:"serialize",value:function(){var t=arguments.length>0&&arguments[0]!==undefined&&arguments[0];if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();var n=e._internalPadding*this.parentScale,i=this.getRect(n,n),a=Xl._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:d(eg,this)),s={annotationType:ir.FREETEXT,color:a,fontSize:d(ag,this),value:r(sg,this,vg).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!r(sg,this,gg).call(this,s)?null:(s.id=this.annotationElementId,s)}},{key:"renderAnnotationElement",value:function(t){var n=L(e,"renderAnnotationElement",this,3)([t]),i=n.style;i.fontSize="calc(".concat(d(ag,this),"px * var(--total-scale-factor))"),i.color=d(eg,this),n.replaceChildren();var r,a=w(d(ng,this).split("\n"));try{for(a.s();!(r=a.n()).done;){var s=r.value,o=document.createElement("div");o.append(s?document.createTextNode(s):document.createElement("br")),n.append(o)}}catch(h){a.e(h)}finally{a.f()}var l=e._internalPadding*this.parentScale,u={rect:this.getRect(l,l)};return u.popup=this.hasEditedComment?this.comment:{text:d(ng,this)},t.updateEdited(u),n}},{key:"resetAnnotationElement",value:function(t){L(e,"resetAnnotationElement",this,3)([t]),t.resetEdited()}}],[{key:"_keyboardManager",get:function(){var t=e.prototype,n=function(t){return t.isEmpty()},i=lo.TRANSLATE_SMALL,r=lo.TRANSLATE_BIG;return Or(this,"_keyboardManager",new cs([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:n}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:n}]]))}},{key:"initialize",value:function(t,e){Xl.initialize(t,e);var n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}},{key:"updateDefaultParams",value:function(t,n){switch(t){case rr.FREETEXT_SIZE:e._defaultFontSize=n;break;case rr.FREETEXT_COLOR:e._defaultColor=n}}},{key:"defaultPropertiesToUpdate",get:function(){return[[rr.FREETEXT_SIZE,e._defaultFontSize],[rr.FREETEXT_COLOR,e._defaultColor||Xl._defaultLineColor]]}},{key:"deserialize",value:(n=l(T().m((function i(t,n,r){var a,s,o,l,u,h,c,d,f,p,g,y,m,w,b;return T().w((function(i){for(;;)switch(i.n){case 0:if(a=null,!(t instanceof bp)){i.n=2;break}if(o=(s=t).data,l=o.defaultAppearanceData,u=l.fontSize,h=l.fontColor,c=o.rect,d=o.rotation,f=o.id,p=o.popupRef,g=o.contentsObj,y=s.textContent,m=s.textPosition,w=s.parent.page.pageNumber,y&&0!==y.length){i.n=1;break}return i.a(2,null);case 1:a=t={annotationType:ir.FREETEXT,color:Array.from(h),fontSize:u,value:y.join("\n"),position:m,pageIndex:w-1,rect:c.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:p,comment:(null==g?void 0:g.str)||null};case 2:return i.n=3,L(e,"deserialize",this,2)([t,n,r]);case 3:return b=i.v,v(ag,b,t.fontSize),v(eg,b,Xr.makeHexColor.apply(Xr,F(t.color))),v(ng,b,pg.call(e,t.value)),b._initialData=a,t.comment&&b.setCommentData(t.comment),i.a(2,b)}}),i,this)}))),function(t,e,i){return n.apply(this,arguments)})}]);var n}(Xl);function lg(t){var e=this,n=function(t){e.editorDiv.style.fontSize="calc(".concat(t,"px * var(--total-scale-factor))"),e.translate(0,-(t-d(ag,e))*e.parentScale),v(ag,e,t),r(sg,e,cg).call(e)},i=d(ag,this);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:rr.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}function ug(t){var e=this,n=function(t){var n;v(eg,e,e.editorDiv.style.color=t),null===(n=e._colorPicker)||void 0===n||n.update(t)},i=d(eg,this);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:rr.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function hg(){var t=[];this.editorDiv.normalize();var e,n=null,i=w(this.editorDiv.childNodes);try{for(i.s();!(e=i.n()).done;){var r,a=e.value;(null===(r=n)||void 0===r?void 0:r.nodeType)===Node.TEXT_NODE&&"BR"===a.nodeName||(t.push(dg.call(Pi,a)),n=a)}}catch(s){i.e(s)}finally{i.f()}return t.join("\n")}function cg(){var t,e=D(this.parentDimensions,2),n=e[0],i=e[1];if(this.isAttachedToDOM)t=this.div.getBoundingClientRect();else{var r=this.currentLayer,a=this.div,s=a.style.display,o=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),t=a.getBoundingClientRect(),a.remove(),a.style.display=s,a.classList.toggle("hidden",o)}this.rotation%180==this.parentRotation%180?(this.width=t.width/n,this.height=t.height/i):(this.width=t.height/n,this.height=t.width/i),this.fixAndSetPosition()}function dg(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(tg,"")}function fg(){if(this.editorDiv.replaceChildren(),d(ng,this)){var t,e=w(d(ng,this).split("\n"));try{for(e.s();!(t=e.n()).done;){var n=t.value,i=document.createElement("div");i.append(n?document.createTextNode(n):document.createElement("br")),this.editorDiv.append(i)}}catch(r){e.e(r)}finally{e.f()}}}function vg(){return d(ng,this).replaceAll("Â "," ")}function pg(t){return t.replaceAll(" ","Â ")}function gg(t){var e=this._initialData,n=e.value,i=e.fontSize,r=e.color,a=e.pageIndex;return this.hasEditedComment||this._hasBeenMoved||t.value!==n||t.fontSize!==i||t.color.some((function(t,e){return t!==r[e]}))||t.pageIndex!==a}Pi=og,b(og,"_freeTextDefaultContent",""),b(og,"_internalPadding",0),b(og,"_defaultColor",null),b(og,"_defaultFontSize",10),b(og,"_type","freetext"),b(og,"_editorType",ir.FREETEXT);var yg=function(){return m((function t(){c(this,t)}),[{key:"toSVGPath",value:function(){Pr("Abstract method `toSVGPath` must be implemented.")}},{key:"box",get:function(){Pr("Abstract getter `box` must be implemented.")}},{key:"serialize",value:function(t,e){Pr("Abstract method `serialize` must be implemented.")}}],[{key:"_rescale",value:function(t,e,n,i,r,a){a||(a=new Float32Array(t.length));for(var s=0,o=t.length;s<o;s+=2)a[s]=e+t[s]*i,a[s+1]=n+t[s+1]*r;return a}},{key:"_rescaleAndSwap",value:function(t,e,n,i,r,a){a||(a=new Float32Array(t.length));for(var s=0,o=t.length;s<o;s+=2)a[s]=e+t[s+1]*i,a[s+1]=n+t[s]*r;return a}},{key:"_translate",value:function(t,e,n,i){i||(i=new Float32Array(t.length));for(var r=0,a=t.length;r<a;r+=2)i[r]=e+t[r],i[r+1]=n+t[r+1];return i}},{key:"svgRound",value:function(t){return Math.round(1e4*t)}},{key:"_normalizePoint",value:function(t,e,n,i,r){switch(r){case 90:return[1-e/n,t/i];case 180:return[1-t/n,1-e/i];case 270:return[e/n,1-t/i];default:return[t/n,e/i]}}},{key:"_normalizePagePoint",value:function(t,e,n){switch(n){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}},{key:"createBezierPoints",value:function(t,e,n,i,r,a){return[(t+5*n)/6,(e+5*i)/6,(5*n+r)/6,(5*i+a)/6,(n+r)/2,(i+a)/2]}}])}();b(yg,"PRECISION",1e-4);var mg=new WeakMap,wg=new WeakMap,bg=new WeakMap,kg=new WeakMap,Ag=new WeakMap,_g=new WeakMap,xg=new WeakMap,Sg=new WeakMap,Eg=new WeakMap,Mg=new WeakMap,Cg=new WeakMap,Tg=new WeakMap,Rg=new WeakMap,Pg=new WeakSet,Ig=function(){return m((function t(e,n,i,r,a){var s=e.x,o=e.y,l=arguments.length>5&&arguments[5]!==undefined?arguments[5]:0;c(this,t),g(this,Pg),f(this,mg,void 0),f(this,wg,[]),f(this,bg,void 0),f(this,kg,void 0),f(this,Ag,[]),f(this,_g,new Float32Array(18)),f(this,xg,void 0),f(this,Sg,void 0),f(this,Eg,void 0),f(this,Mg,void 0),f(this,Cg,void 0),f(this,Tg,void 0),f(this,Rg,[]),v(mg,this,n),v(Tg,this,r*i),v(kg,this,a),d(_g,this).set([NaN,NaN,NaN,NaN,s,o],6),v(bg,this,l),v(Mg,this,jg._*i),v(Eg,this,Hg._*i),v(Cg,this,i),d(Rg,this).push(s,o)}),[{key:"isEmpty",value:function(){return isNaN(d(_g,this)[8])}},{key:"add",value:function(t){var e,n=t.x,i=t.y;v(xg,this,n),v(Sg,this,i);var r=D(d(mg,this),4),a=r[0],s=r[1],o=r[2],l=r[3],u=D(d(_g,this).subarray(8,12),4),h=u[0],c=u[1],f=u[2],p=u[3],g=n-f,y=i-p,m=Math.hypot(g,y);if(m<d(Eg,this))return!1;var w=m-d(Mg,this),b=w/m,k=b*g,A=b*y,_=h,x=c;h=f,c=p,f+=k,p+=A,null===(e=d(Rg,this))||void 0===e||e.push(n,i);var S=k/w,E=-A/w*d(Tg,this),M=S*d(Tg,this);if(d(_g,this).set(d(_g,this).subarray(2,8),0),d(_g,this).set([f+E,p+M],4),d(_g,this).set(d(_g,this).subarray(14,18),12),d(_g,this).set([f-E,p-M],16),isNaN(d(_g,this)[6]))return 0===d(Ag,this).length&&(d(_g,this).set([h+E,c+M],2),d(Ag,this).push(NaN,NaN,NaN,NaN,(h+E-a)/o,(c+M-s)/l),d(_g,this).set([h-E,c-M],14),d(wg,this).push(NaN,NaN,NaN,NaN,(h-E-a)/o,(c-M-s)/l)),d(_g,this).set([_,x,h,c,f,p],6),!this.isEmpty();if(d(_g,this).set([_,x,h,c,f,p],6),Math.abs(Math.atan2(x-c,_-h)-Math.atan2(A,k))<Math.PI/2){var C=D(d(_g,this).subarray(2,6),4);h=C[0],c=C[1],f=C[2],p=C[3],d(Ag,this).push(NaN,NaN,NaN,NaN,((h+f)/2-a)/o,((c+p)/2-s)/l);var T=D(d(_g,this).subarray(14,18),4);return h=T[0],c=T[1],_=T[2],x=T[3],d(wg,this).push(NaN,NaN,NaN,NaN,((_+h)/2-a)/o,((x+c)/2-s)/l),!0}var R=D(d(_g,this).subarray(0,6),6);_=R[0],x=R[1],h=R[2],c=R[3],f=R[4],p=R[5],d(Ag,this).push(((_+5*h)/6-a)/o,((x+5*c)/6-s)/l,((5*h+f)/6-a)/o,((5*c+p)/6-s)/l,((h+f)/2-a)/o,((c+p)/2-s)/l);var P=D(d(_g,this).subarray(12,18),6);return f=P[0],p=P[1],h=P[2],c=P[3],_=P[4],x=P[5],d(wg,this).push(((_+5*h)/6-a)/o,((x+5*c)/6-s)/l,((5*h+f)/6-a)/o,((5*c+p)/6-s)/l,((h+f)/2-a)/o,((c+p)/2-s)/l),!0}},{key:"toSVGPath",value:function(){if(this.isEmpty())return"";var t=d(Ag,this),e=d(wg,this);if(isNaN(d(_g,this)[6])&&!this.isEmpty())return r(Pg,this,Lg).call(this);var n=[];n.push("M".concat(t[4]," ").concat(t[5]));for(var i=6;i<t.length;i+=6)isNaN(t[i])?n.push("L".concat(t[i+4]," ").concat(t[i+5])):n.push("C".concat(t[i]," ").concat(t[i+1]," ").concat(t[i+2]," ").concat(t[i+3]," ").concat(t[i+4]," ").concat(t[i+5]));r(Pg,this,Fg).call(this,n);for(var a=e.length-6;a>=6;a-=6)isNaN(e[a])?n.push("L".concat(e[a+4]," ").concat(e[a+5])):n.push("C".concat(e[a]," ").concat(e[a+1]," ").concat(e[a+2]," ").concat(e[a+3]," ").concat(e[a+4]," ").concat(e[a+5]));return r(Pg,this,Og).call(this,n),n.join(" ")}},{key:"newFreeDrawOutline",value:function(t,e,n,i,r,a){return new Qg(t,e,n,i,r,a)}},{key:"getOutlines",value:function(){for(var t,e,n=d(Ag,this),i=d(wg,this),a=d(_g,this),s=D(d(mg,this),4),o=s[0],l=s[1],u=s[2],h=s[3],c=new Float32Array((null!==(t=null===(e=d(Rg,this))||void 0===e?void 0:e.length)&&void 0!==t?t:0)+2),f=0,v=c.length-2;f<v;f+=2)c[f]=(d(Rg,this)[f]-o)/u,c[f+1]=(d(Rg,this)[f+1]-l)/h;if(c[c.length-2]=(d(xg,this)-o)/u,c[c.length-1]=(d(Sg,this)-l)/h,isNaN(a[6])&&!this.isEmpty())return r(Pg,this,Ng).call(this,c);for(var p=new Float32Array(d(Ag,this).length+24+d(wg,this).length),g=n.length,y=0;y<g;y+=2)isNaN(n[y])?p[y]=p[y+1]=NaN:(p[y]=n[y],p[y+1]=n[y+1]);g=r(Pg,this,Bg).call(this,p,g);for(var m=i.length-6;m>=6;m-=6)for(var w=0;w<6;w+=2)isNaN(i[m+w])?(p[g]=p[g+1]=NaN,g+=2):(p[g]=i[m+w],p[g+1]=i[m+w+1],g+=2);return r(Pg,this,Wg).call(this,p,g),this.newFreeDrawOutline(p,c,d(mg,this),d(Cg,this),d(bg,this),d(kg,this))}}])}();function Dg(){var t=d(_g,this).subarray(4,6),e=d(_g,this).subarray(16,18),n=D(d(mg,this),4),i=n[0],r=n[1],a=n[2],s=n[3];return[(d(xg,this)+(t[0]-e[0])/2-i)/a,(d(Sg,this)+(t[1]-e[1])/2-r)/s,(d(xg,this)+(e[0]-t[0])/2-i)/a,(d(Sg,this)+(e[1]-t[1])/2-r)/s]}function Lg(){var t=D(d(mg,this),4),e=t[0],n=t[1],i=t[2],a=t[3],s=D(r(Pg,this,Dg).call(this),4),o=s[0],l=s[1],u=s[2],h=s[3];return"M".concat((d(_g,this)[2]-e)/i," ").concat((d(_g,this)[3]-n)/a," L").concat((d(_g,this)[4]-e)/i," ").concat((d(_g,this)[5]-n)/a," L").concat(o," ").concat(l," L").concat(u," ").concat(h," L").concat((d(_g,this)[16]-e)/i," ").concat((d(_g,this)[17]-n)/a," L").concat((d(_g,this)[14]-e)/i," ").concat((d(_g,this)[15]-n)/a," Z")}function Og(t){var e=d(wg,this);t.push("L".concat(e[4]," ").concat(e[5]," Z"))}function Fg(t){var e=D(d(mg,this),4),n=e[0],i=e[1],a=e[2],s=e[3],o=d(_g,this).subarray(4,6),l=d(_g,this).subarray(16,18),u=D(r(Pg,this,Dg).call(this),4),h=u[0],c=u[1],f=u[2],v=u[3];t.push("L".concat((o[0]-n)/a," ").concat((o[1]-i)/s," L").concat(h," ").concat(c," L").concat(f," ").concat(v," L").concat((l[0]-n)/a," ").concat((l[1]-i)/s))}function Ng(t){var e=d(_g,this),n=D(d(mg,this),4),i=n[0],a=n[1],s=n[2],o=n[3],l=D(r(Pg,this,Dg).call(this),4),u=l[0],h=l[1],c=l[2],f=l[3],v=new Float32Array(36);return v.set([NaN,NaN,NaN,NaN,(e[2]-i)/s,(e[3]-a)/o,NaN,NaN,NaN,NaN,(e[4]-i)/s,(e[5]-a)/o,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,c,f,NaN,NaN,NaN,NaN,(e[16]-i)/s,(e[17]-a)/o,NaN,NaN,NaN,NaN,(e[14]-i)/s,(e[15]-a)/o],0),this.newFreeDrawOutline(v,t,d(mg,this),d(Cg,this),d(bg,this),d(kg,this))}function Wg(t,e){var n=d(wg,this);return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+6}function Bg(t,e){var n=d(_g,this).subarray(4,6),i=d(_g,this).subarray(16,18),a=D(d(mg,this),4),s=a[0],o=a[1],l=a[2],u=a[3],h=D(r(Pg,this,Dg).call(this),4),c=h[0],f=h[1],v=h[2],p=h[3];return t.set([NaN,NaN,NaN,NaN,(n[0]-s)/l,(n[1]-o)/u,NaN,NaN,NaN,NaN,c,f,NaN,NaN,NaN,NaN,v,p,NaN,NaN,NaN,NaN,(i[0]-s)/l,(i[1]-o)/u],e),e+24}var jg={_:8},Hg={_:jg._+2},Ug=new WeakMap,zg=new WeakMap,Gg=new WeakMap,Vg=new WeakMap,qg=new WeakMap,Xg=new WeakMap,Yg=new WeakMap,Kg=new WeakSet,Qg=function(t){function e(t,n,i,a,s,o){var l;c(this,e),g(l=u(this,e),Kg),f(l,Ug,void 0),f(l,zg,new Float32Array(4)),f(l,Gg,void 0),f(l,Vg,void 0),f(l,qg,void 0),f(l,Xg,void 0),f(l,Yg,void 0),v(Yg,l,t),v(qg,l,n),v(Ug,l,i),v(Xg,l,a),v(Gg,l,s),v(Vg,l,o),l.lastPoint=[NaN,NaN],r(Kg,l,Jg).call(l,o);for(var h=D(d(zg,l),4),p=h[0],y=h[1],m=h[2],w=h[3],b=0,k=t.length;b<k;b+=2)t[b]=(t[b]-p)/m,t[b+1]=(t[b+1]-y)/w;for(var A=0,_=n.length;A<_;A+=2)n[A]=(n[A]-p)/m,n[A+1]=(n[A+1]-y)/w;return l}return _(e,t),m(e,[{key:"toSVGPath",value:function(){for(var t=["M".concat(d(Yg,this)[4]," ").concat(d(Yg,this)[5])],e=6,n=d(Yg,this).length;e<n;e+=6)isNaN(d(Yg,this)[e])?t.push("L".concat(d(Yg,this)[e+4]," ").concat(d(Yg,this)[e+5])):t.push("C".concat(d(Yg,this)[e]," ").concat(d(Yg,this)[e+1]," ").concat(d(Yg,this)[e+2]," ").concat(d(Yg,this)[e+3]," ").concat(d(Yg,this)[e+4]," ").concat(d(Yg,this)[e+5]));return t.push("Z"),t.join(" ")}},{key:"serialize",value:function(t,e){var n,i,r=D(t,4),a=r[0],s=r[1],o=r[2],l=r[3],u=o-a,h=l-s;switch(e){case 0:n=yg._rescale(d(Yg,this),a,l,u,-h),i=yg._rescale(d(qg,this),a,l,u,-h);break;case 90:n=yg._rescaleAndSwap(d(Yg,this),a,s,u,h),i=yg._rescaleAndSwap(d(qg,this),a,s,u,h);break;case 180:n=yg._rescale(d(Yg,this),o,s,-u,h),i=yg._rescale(d(qg,this),o,s,-u,h);break;case 270:n=yg._rescaleAndSwap(d(Yg,this),o,l,-u,-h),i=yg._rescaleAndSwap(d(qg,this),o,l,-u,-h)}return{outline:Array.from(n),points:[Array.from(i)]}}},{key:"box",get:function(){return d(zg,this)}},{key:"newOutliner",value:function(t,e,n,i,r){var a=arguments.length>5&&arguments[5]!==undefined?arguments[5]:0;return new Ig(t,e,n,i,r,a)}},{key:"getNewOutline",value:function(t,e){for(var n=D(d(zg,this),4),i=n[0],r=n[1],a=n[2],s=n[3],o=D(d(Ug,this),4),l=o[0],u=o[1],h=o[2],c=o[3],f=a*h,v=s*c,p=i*h+l,g=r*c+u,y=this.newOutliner({x:d(qg,this)[0]*f+p,y:d(qg,this)[1]*v+g},d(Ug,this),d(Xg,this),t,d(Vg,this),null!=e?e:d(Gg,this)),m=2;m<d(qg,this).length;m+=2)y.add({x:d(qg,this)[m]*f+p,y:d(qg,this)[m+1]*v+g});return y.getOutlines()}}])}(yg);function Jg(t){for(var e=d(Yg,this),n=e[4],i=e[5],r=[n,i,n,i],a=n,s=i,o=t?Math.max:Math.min,l=6,u=e.length;l<u;l+=6){var h=e[l+4],c=e[l+5];if(isNaN(e[l]))Xr.pointBoundingBox(h,c,r),s<c?(a=h,s=c):s===c&&(a=o(a,h));else{var f=[Infinity,Infinity,-Infinity,-Infinity];Xr.bezierBoundingBox.apply(Xr,[n,i].concat(F(e.slice(l,l+6)),[f])),Xr.rectBoundingBox.apply(Xr,f.concat([r])),s<f[3]?(a=f[2],s=f[3]):s===f[3]&&(a=o(a,f[2]))}n=h,i=c}var v=d(zg,this);v[0]=r[0]-d(Gg,this),v[1]=r[1]-d(Gg,this),v[2]=r[2]-r[0]+2*d(Gg,this),v[3]=r[3]-r[1]+2*d(Gg,this),this.lastPoint=[a,s]}var Zg=new WeakMap,$g=new WeakMap,ty=new WeakMap,ey=new WeakMap,ny=new WeakSet,iy=function(){return m((function t(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,r=!(arguments.length>3&&arguments[3]!==undefined)||arguments[3];c(this,t),g(this,ny),f(this,Zg,void 0),f(this,$g,void 0),f(this,ty,[]),f(this,ey,[]);var a,s=[Infinity,Infinity,-Infinity,-Infinity],o=Math.pow(10,-4),l=w(e);try{for(l.s();!(a=l.n()).done;){var u=a.value,h=u.x,p=u.y,y=u.width,m=u.height,b=Math.floor((h-n)/o)*o,k=Math.ceil((h+y+n)/o)*o,A=Math.floor((p-n)/o)*o,_=Math.ceil((p+m+n)/o)*o,x=[b,A,_,!0],S=[k,A,_,!1];d(ty,this).push(x,S),Xr.rectBoundingBox(b,A,k,_,s)}}catch(j){l.e(j)}finally{l.f()}var E,M=s[2]-s[0]+2*i,C=s[3]-s[1]+2*i,T=s[0]-i,R=s[1]-i,P=d(ty,this).at(r?-1:-2),I=[P[0],P[2]],L=w(d(ty,this));try{for(L.s();!(E=L.n()).done;){var O=E.value,F=D(O,3),N=F[0],W=F[1],B=F[2];O[0]=(N-T)/M,O[1]=(W-R)/C,O[2]=(B-R)/C}}catch(j){L.e(j)}finally{L.f()}v(Zg,this,new Float32Array([T,R,M,C])),v($g,this,I)}),[{key:"getOutlines",value:function(){d(ty,this).sort((function(t,e){return t[0]-e[0]||t[1]-e[1]||t[2]-e[2]}));var t,e=[],n=w(d(ty,this));try{for(n.s();!(t=n.n()).done;){var i=t.value;i[3]?(e.push.apply(e,F(r(ny,this,ly).call(this,i))),r(ny,this,sy).call(this,i)):(r(ny,this,oy).call(this,i),e.push.apply(e,F(r(ny,this,ly).call(this,i))))}}catch(a){n.e(a)}finally{n.f()}return r(ny,this,ry).call(this,e)}}])}();function ry(t){var e,n=[],i=new Set,r=w(t);try{for(r.s();!(e=r.n()).done;){var a=e.value,s=D(a,3),o=s[0],l=s[1],u=s[2];n.push([o,l,a],[o,u,a])}}catch(T){r.e(T)}finally{r.f()}n.sort((function(t,e){return t[1]-e[1]||t[0]-e[0]}));for(var h=0,c=n.length;h<c;h+=2){var f=n[h][2],v=n[h+1][2];f.push(v),v.push(f),i.add(f),i.add(v)}for(var p,g=[];i.size>0;){var y=i.values().next().value,m=D(y,5),b=m[0],k=m[1],A=m[2],_=m[3],x=m[4];i["delete"](y);var S=b,E=k;for(p=[b,A],g.push(p);;){var M=void 0;if(i.has(_))M=_;else{if(!i.has(x))break;M=x}i["delete"](M);var C=D(M,5);b=C[0],k=C[1],A=C[2],_=C[3],x=C[4],S!==b&&(p.push(S,E,b,E===k?k:A),S=b),E=E===k?A:k}p.push(S,E)}return new cy(g,d(Zg,this),d($g,this))}function ay(t){for(var e=d(ey,this),n=0,i=e.length-1;n<=i;){var r=n+i>>1,a=e[r][0];if(a===t)return r;a<t?n=r+1:i=r-1}return i+1}function sy(t){var e=D(t,3),n=e[1],i=e[2],a=r(ny,this,ay).call(this,n);d(ey,this).splice(a,0,[n,i])}function oy(t){for(var e=D(t,3),n=e[1],i=e[2],a=r(ny,this,ay).call(this,n),s=a;s<d(ey,this).length;s++){var o=D(d(ey,this)[s],2),l=o[0],u=o[1];if(l!==n)break;if(l===n&&u===i)return void d(ey,this).splice(s,1)}for(var h=a-1;h>=0;h--){var c=D(d(ey,this)[h],2),f=c[0],v=c[1];if(f!==n)break;if(f===n&&v===i)return void d(ey,this).splice(h,1)}}function ly(t){for(var e=D(t,3),n=e[0],i=e[1],a=e[2],s=[[n,i,a]],o=r(ny,this,ay).call(this,a),l=0;l<o;l++)for(var u=D(d(ey,this)[l],2),h=u[0],c=u[1],f=0,v=s.length;f<v;f++){var p=D(s[f],3),g=p[1],y=p[2];if(!(c<=g||y<=h))if(g>=h)if(y>c)s[f][1]=c;else{if(1===v)return[];s.splice(f,1),f--,v--}else s[f][2]=h,y>c&&s.push([n,c,y])}return s}var uy=new WeakMap,hy=new WeakMap,cy=function(t){function e(t,n,i){var r;return c(this,e),f(r=u(this,e),uy,void 0),f(r,hy,void 0),v(hy,r,t),v(uy,r,n),r.lastPoint=i,r}return _(e,t),m(e,[{key:"toSVGPath",value:function(){var t,e=[],n=w(d(hy,this));try{for(n.s();!(t=n.n()).done;){var i=t.value,r=D(i,2),a=r[0],s=r[1];e.push("M".concat(a," ").concat(s));for(var o=2;o<i.length;o+=2){var l=i[o],u=i[o+1];l===a?(e.push("V".concat(u)),s=u):u===s&&(e.push("H".concat(l)),a=l)}e.push("Z")}}catch(h){n.e(h)}finally{n.f()}return e.join(" ")}},{key:"serialize",value:function(t,e){var n,i=D(t,4),r=i[0],a=i[1],s=i[2],o=i[3],l=[],u=s-r,h=o-a,c=w(d(hy,this));try{for(c.s();!(n=c.n()).done;){for(var f=n.value,v=new Array(f.length),p=0;p<f.length;p+=2)v[p]=r+f[p]*u,v[p+1]=o-f[p+1]*h;l.push(v)}}catch(g){c.e(g)}finally{c.f()}return l}},{key:"box",get:function(){return d(uy,this)}},{key:"classNamesForOutlining",get:function(){return["highlightOutline"]}}])}(yg),dy=function(t){function e(){return c(this,e),u(this,e,arguments)}return _(e,t),m(e,[{key:"newFreeDrawOutline",value:function(t,e,n,i,r,a){return new fy(t,e,n,i,r,a)}}])}(Ig),fy=function(t){function e(){return c(this,e),u(this,e,arguments)}return _(e,t),m(e,[{key:"newOutliner",value:function(t,e,n,i,r){var a=arguments.length>5&&arguments[5]!==undefined?arguments[5]:0;return new dy(t,e,n,i,r,a)}}])}(Qg),vy=new WeakMap,py=new WeakMap,gy=new WeakMap,yy=new WeakMap,my=new WeakMap,wy=new WeakMap,by=new WeakMap,ky=new WeakMap,Ay=new WeakMap,_y=new WeakMap,xy=new WeakMap,Sy=new WeakMap,Ey=new WeakMap,My=new WeakMap,Cy=new WeakMap,Ty=new WeakMap,Ry=new WeakMap,Py=new WeakMap,Iy=new WeakSet,Dy=function(t){function e(t){var n;return c(this,e),g(n=u(this,e,[C(C({},t),{},{name:"highlightEditor"})]),Iy),f(n,vy,null),f(n,py,0),f(n,gy,void 0),f(n,yy,null),f(n,my,null),f(n,wy,null),f(n,by,null),f(n,ky,0),f(n,Ay,null),f(n,_y,null),f(n,xy,null),f(n,Sy,!1),f(n,Ey,null),f(n,My,void 0),f(n,Cy,null),f(n,Ty,""),f(n,Ry,void 0),f(n,Py,""),n.color=t.color||e._defaultColor,v(Ry,n,t.thickness||e._defaultThickness),v(My,n,t.opacity||e._defaultOpacity),v(gy,n,t.boxes||null),v(Py,n,t.methodOfCreation||""),v(Ty,n,t.text||""),n._isDraggable=!1,n.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(v(Sy,n,!0),r(Iy,n,Oy).call(n,t),r(Iy,n,jy).call(n)):d(gy,n)&&(v(vy,n,t.anchorNode),v(py,n,t.anchorOffset),v(by,n,t.focusNode),v(ky,n,t.focusOffset),r(Iy,n,Ly).call(n),r(Iy,n,jy).call(n),n.rotate(n.rotation)),n.annotationElementId||n._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert"),n}return _(e,t),m(e,[{key:"telemetryInitialData",get:function(){return{action:"added",type:d(Sy,this)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:d(Ry,this),methodOfCreation:d(Py,this)}}},{key:"telemetryFinalData",get:function(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}},{key:"commentColor",get:function(){return this.color}},{key:"translateInPage",value:function(t,e){}},{key:"toolbarPosition",get:function(){return d(Ey,this)}},{key:"updateParams",value:function(t,e){switch(t){case rr.HIGHLIGHT_COLOR:r(Iy,this,Fy).call(this,e);break;case rr.HIGHLIGHT_THICKNESS:r(Iy,this,Ny).call(this,e)}}},{key:"propertiesToUpdate",get:function(){return[[rr.HIGHLIGHT_COLOR,this.color||e._defaultColor],[rr.HIGHLIGHT_THICKNESS,d(Ry,this)||e._defaultThickness],[rr.HIGHLIGHT_FREE,d(Sy,this)]]}},{key:"toolbarButtons",get:function(){return this._uiManager.highlightColors?[["colorPicker",v(my,this,new tv({editor:this}))]]:L(e,"toolbarButtons",this,1)}},{key:"disableEditing",value:function(){L(e,"disableEditing",this,3)([]),this.div.classList.toggle("disabled",!0)}},{key:"enableEditing",value:function(){L(e,"enableEditing",this,3)([]),this.div.classList.toggle("disabled",!1)}},{key:"fixAndSetPosition",value:function(){return L(e,"fixAndSetPosition",this,3)([r(Iy,this,Gy).call(this)])}},{key:"getBaseTranslation",value:function(){return[0,0]}},{key:"getRect",value:function(t,n){return L(e,"getRect",this,3)([t,n,r(Iy,this,Gy).call(this)])}},{key:"onceAdded",value:function(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}},{key:"remove",value:function(){r(Iy,this,By).call(this),this._reportTelemetry({action:"deleted"}),L(e,"remove",this,3)([])}},{key:"rebuild",value:function(){this.parent&&(L(e,"rebuild",this,3)([]),null!==this.div&&(r(Iy,this,jy).call(this),this.isAttachedToDOM||this.parent.add(this)))}},{key:"setParent",value:function(t){var n=!1;if(this.parent&&!t)r(Iy,this,By).call(this);else if(t){var i;r(Iy,this,jy).call(this,t),n=!this.parent&&(null===(i=this.div)||void 0===i?void 0:i.classList.contains("selectedEditor"))}L(e,"setParent",this,3)([t]),this.show(this._isVisible),n&&this.select()}},{key:"rotate",value:function(t){var n,i=this.parent.drawLayer;d(Sy,this)?(t=(t-this.rotation+360)%360,n=Hy.call(e,d(_y,this).box,t)):n=Hy.call(e,[this.x,this.y,this.width,this.height],t),i.updateProperties(d(xy,this),{bbox:n,root:{"data-main-rotation":t}}),i.updateProperties(d(Cy,this),{bbox:Hy.call(e,d(wy,this).box,t),root:{"data-main-rotation":t}})}},{key:"render",value:function(){if(this.div)return this.div;var t=L(e,"render",this,3)([]);d(Ty,this)&&(t.setAttribute("aria-label",d(Ty,this)),t.setAttribute("role","mark")),d(Sy,this)?t.classList.add("free"):this.div.addEventListener("keydown",r(Iy,this,Uy).bind(this),{signal:this._uiManager._signal});var n=v(Ay,this,document.createElement("div"));t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=d(yy,this);var i=D(this.parentDimensions,2),a=i[0],s=i[1];return this.setDims(this.width*a,this.height*s),Ka(this,d(Ay,this),["pointerover","pointerleave"]),this.enableEditing(),t}},{key:"pointerover",value:function(){var t;this.isSelected||(null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(d(Cy,this),{rootClass:{hovered:!0}}))}},{key:"pointerleave",value:function(){var t;this.isSelected||(null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(d(Cy,this),{rootClass:{hovered:!1}}))}},{key:"_moveCaret",value:function(t){switch(this.parent.unselect(this),t){case 0:case 2:r(Iy,this,zy).call(this,!0);break;case 1:case 3:r(Iy,this,zy).call(this,!1)}}},{key:"select",value:function(){var t;L(e,"select",this,3)([]),d(Cy,this)&&(null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(d(Cy,this),{rootClass:{hovered:!1,selected:!0}}))}},{key:"unselect",value:function(){var t;L(e,"unselect",this,3)([]),d(Cy,this)&&(null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(d(Cy,this),{rootClass:{selected:!1}}),d(Sy,this)||r(Iy,this,zy).call(this,!1))}},{key:"_mustFixPosition",get:function(){return!d(Sy,this)}},{key:"show",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this._isVisible;L(e,"show",this,3)([t]),this.parent&&(this.parent.drawLayer.updateProperties(d(xy,this),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(d(Cy,this),{rootClass:{hidden:!t}}))}},{key:"serialize",value:function(){var t=arguments.length>0&&arguments[0]!==undefined&&arguments[0];if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();var e=this.getRect(0,0),n=Xl._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i={annotationType:ir.HIGHLIGHT,color:n,opacity:d(My,this),thickness:d(Ry,this),quadPoints:r(Iy,this,Vy).call(this),outlines:r(Iy,this,qy).call(this,e),pageIndex:this.pageIndex,rect:e,rotation:r(Iy,this,Gy).call(this),structTreeParentId:this._structTreeParentId};return this.addComment(i),this.annotationElementId&&!r(Iy,this,Ky).call(this,i)?null:(i.id=this.annotationElementId,i)}},{key:"renderAnnotationElement",value:function(t){var e={rect:this.getRect(0,0)};return this.hasEditedComment&&(e.popup=this.comment),t.updateEdited(e),null}}],[{key:"_keyboardManager",get:function(){var t=e.prototype;return Or(this,"_keyboardManager",new cs([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}},{key:"computeTelemetryFinalData",value:function(t){return{numberOfColors:t.get("color").size}}},{key:"initialize",value:function(t,n){var i;Xl.initialize(t,n),e._defaultColor||(e._defaultColor=(null===(i=n.highlightColors)||void 0===i?void 0:i.values().next().value)||"#fff066")}},{key:"updateDefaultParams",value:function(t,n){switch(t){case rr.HIGHLIGHT_COLOR:e._defaultColor=n;break;case rr.HIGHLIGHT_THICKNESS:e._defaultThickness=n}}},{key:"defaultPropertiesToUpdate",get:function(){return[[rr.HIGHLIGHT_COLOR,e._defaultColor],[rr.HIGHLIGHT_THICKNESS,e._defaultThickness]]}},{key:"startHighlighting",value:function(t,n,i){var a=this,s=i.target,o=i.x,l=i.y,u=s.getBoundingClientRect(),h=u.x,c=u.y,d=u.width,f=u.height,v=new AbortController,p=t.combinedSignal(v),g=function(n){v.abort(),r(e,a,Yy).call(a,t,n)};window.addEventListener("blur",g,{signal:p}),window.addEventListener("pointerup",g,{signal:p}),window.addEventListener("pointerdown",ga,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",pa,{signal:p}),s.addEventListener("pointermove",r(e,this,Xy).bind(this,t),{signal:p}),this._freeHighlight=new dy({x:o,y:l},[h,c,d,f],t.scale,this._defaultThickness/2,n,.001);var y=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0);this._freeHighlightId=y.id,this._freeHighlightClipId=y.clipPathId}},{key:"deserialize",value:(n=l(T().m((function i(t,n,a){var s,o,l,u,h,c,f,p,g,y,m,w,b,k,A,_,x,S,E,M,C,R,P,I,O,N,W,B,j,H,U,z,G,V,q,X,Y,K,Q,J,Z,$,tt,et,nt;return T().w((function(i){for(;;)switch(i.n){case 0:return s=null,t instanceof Fp?(l=(o=t).data,u=l.quadPoints,h=l.rect,c=l.rotation,f=l.id,p=l.color,g=l.opacity,y=l.popupRef,m=l.contentsObj,w=o.parent.page.pageNumber,s=t={annotationType:ir.HIGHLIGHT,color:Array.from(p),opacity:g,quadPoints:u,boxes:null,pageIndex:w-1,rect:h.slice(0),rotation:c,annotationElementId:f,id:f,deleted:!1,popupRef:y,comment:(null==m?void 0:m.str)||null}):t instanceof Lp&&(k=(b=t).data,A=k.inkLists,_=k.rect,x=k.rotation,S=k.id,E=k.color,M=k.borderStyle.rawWidth,C=k.popupRef,R=k.contentsObj,P=b.parent.page.pageNumber,s=t={annotationType:ir.HIGHLIGHT,color:Array.from(E),thickness:M,inkLists:A,boxes:null,pageIndex:P-1,rect:_.slice(0),rotation:x,annotationElementId:S,id:S,deleted:!1,popupRef:C,comment:(null==R?void 0:R.str)||null}),O=(I=t).color,N=I.quadPoints,W=I.inkLists,B=I.opacity,i.n=1,L(e,"deserialize",this,2)([t,n,a]);case 1:if((j=i.v).color=Xr.makeHexColor.apply(Xr,F(O)),v(My,j,B||1),W&&v(Ry,j,t.thickness),j._initialData=s,t.comment&&j.setCommentData(t.comment),H=D(j.pageDimensions,2),U=H[0],z=H[1],G=D(j.pageTranslation,2),V=G[0],q=G[1],N){for(X=v(gy,j,[]),Y=0;Y<N.length;Y+=8)X.push({x:(N[Y]-V)/U,y:1-(N[Y+1]-q)/z,width:(N[Y+2]-N[Y])/U,height:(N[Y+1]-N[Y+5])/z});r(Iy,j,Ly).call(j),r(Iy,j,jy).call(j),j.rotate(j.rotation)}else if(W){for(v(Sy,j,!0),K=W[0],Q={x:K[0]-V,y:z-(K[1]-q)},J=new dy(Q,[0,0,U,z],1,d(Ry,j)/2,!0,.001),Z=0,$=K.length;Z<$;Z+=2)Q.x=K[Z]-V,Q.y=z-(K[Z+1]-q),J.add(Q);tt=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:j.color,"fill-opacity":j._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:J.toSVGPath()}},!0,!0),et=tt.id,nt=tt.clipPathId,r(Iy,j,Oy).call(j,{highlightOutlines:J.getOutlines(),highlightId:et,clipPathId:nt}),r(Iy,j,jy).call(j),j.rotate(j.parentRotation)}return i.a(2,j)}}),i,this)}))),function(t,e,i){return n.apply(this,arguments)})},{key:"canCreateNewEmptyEditor",value:function(){return!1}}]);var n}(Xl);function Ly(){var t=new iy(d(gy,this),.001);v(_y,this,t.getOutlines());var e=D(d(_y,this).box,4);this.x=e[0],this.y=e[1],this.width=e[2],this.height=e[3];var n=new iy(d(gy,this),.0025,.001,"ltr"===this._uiManager.direction);v(wy,this,n.getOutlines());var i=d(wy,this).lastPoint;v(Ey,this,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])}function Oy(t){var e=t.highlightOutlines,n=t.highlightId,i=t.clipPathId;v(_y,this,e);if(v(wy,this,e.getNewOutline(d(Ry,this)/2+1.5,.0025)),n>=0)v(xy,this,n),v(yy,this,i),this.parent.drawLayer.finalizeDraw(n,{bbox:e.box,path:{d:e.toSVGPath()}}),v(Cy,this,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:d(wy,this).box,path:{d:d(wy,this).toSVGPath()}},!0));else if(this.parent){var r=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(d(xy,this),{bbox:Hy.call(Ii,d(_y,this).box,(r-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(d(Cy,this),{bbox:Hy.call(Ii,d(wy,this).box,r),path:{d:d(wy,this).toSVGPath()}})}var a=D(e.box,4),s=a[0],o=a[1],l=a[2],u=a[3];switch(this.rotation){case 0:this.x=s,this.y=o,this.width=l,this.height=u;break;case 90:var h=D(this.parentDimensions,2),c=h[0],f=h[1];this.x=o,this.y=1-s,this.width=l*f/c,this.height=u*c/f;break;case 180:this.x=1-s,this.y=1-o,this.width=l,this.height=u;break;case 270:var p=D(this.parentDimensions,2),g=p[0],y=p[1];this.x=1-o,this.y=s,this.width=l*y/g,this.height=u*g/y}var m=d(wy,this).lastPoint;v(Ey,this,[(m[0]-s)/l,(m[1]-o)/u])}function Fy(t){var e=this,n=function(t,n){var i,r;e.color=t,v(My,e,n),null===(i=e.parent)||void 0===i||i.drawLayer.updateProperties(d(xy,e),{root:{fill:t,"fill-opacity":n}}),null===(r=d(my,e))||void 0===r||r.updateColor(t)},i=this.color,r=d(My,this);this.addCommands({cmd:n.bind(this,t,Ii._defaultOpacity),undo:n.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:rr.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}function Ny(t){var e=this,n=d(Ry,this),i=function(t){v(Ry,e,t),r(Iy,e,Wy).call(e,t)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:rr.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}function Wy(t){if(d(Sy,this)){r(Iy,this,Oy).call(this,{highlightOutlines:d(_y,this).getNewOutline(t/2)}),this.fixAndSetPosition();var e=D(this.parentDimensions,2),n=e[0],i=e[1];this.setDims(this.width*n,this.height*i)}}function By(){null!==d(xy,this)&&this.parent&&(this.parent.drawLayer.remove(d(xy,this)),v(xy,this,null),this.parent.drawLayer.remove(d(Cy,this)),v(Cy,this,null))}function jy(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.parent;if(null===d(xy,this)){var e=t.drawLayer.draw({bbox:d(_y,this).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":d(My,this)},rootClass:{highlight:!0,free:d(Sy,this)},path:{d:d(_y,this).toSVGPath()}},!1,!0);W(v,[xy,this])._=e.id,W(v,[yy,this])._=e.clipPathId,v(Cy,this,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:d(Sy,this)},bbox:d(wy,this).box,path:{d:d(wy,this).toSVGPath()}},d(Sy,this))),d(Ay,this)&&(d(Ay,this).style.clipPath=d(yy,this))}}function Hy(t,e){var n=D(t,4),i=n[0],r=n[1],a=n[2],s=n[3];switch(e){case 90:return[1-r-s,i,s,a];case 180:return[1-i-a,1-r-s,a,s];case 270:return[r,1-i-a,s,a]}return[i,r,a,s]}function Uy(t){Ii._keyboardManager.exec(this,t)}function zy(t){if(d(vy,this)){var e=window.getSelection();t?e.setPosition(d(vy,this),d(py,this)):e.setPosition(d(by,this),d(ky,this))}}function Gy(){return d(Sy,this)?this.rotation:0}function Vy(){if(d(Sy,this))return null;var t,e=D(this.pageDimensions,2),n=e[0],i=e[1],r=D(this.pageTranslation,2),a=r[0],s=r[1],o=d(gy,this),l=new Float32Array(8*o.length),u=0,h=w(o);try{for(h.s();!(t=h.n()).done;){var c=t.value,f=c.x,v=c.y,p=c.width,g=c.height,y=f*n+a,m=(1-v)*i+s;l[u]=l[u+4]=y,l[u+1]=l[u+3]=m,l[u+2]=l[u+6]=y+p*n,l[u+5]=l[u+7]=m-g*i,u+=8}}catch(b){h.e(b)}finally{h.f()}return l}function qy(t){return d(_y,this).serialize(t,r(Iy,this,Gy).call(this))}function Xy(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}function Yy(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}function Ky(t){var e=this._initialData.color;return this.hasEditedComment||t.color.some((function(t,n){return t!==e[n]}))}Ii=Dy,b(Dy,"_defaultColor",null),b(Dy,"_defaultOpacity",1),b(Dy,"_defaultThickness",12),b(Dy,"_type","highlight"),b(Dy,"_editorType",ir.HIGHLIGHT),b(Dy,"_freeHighlightId",-1),b(Dy,"_freeHighlight",null),b(Dy,"_freeHighlightClipId","");var Qy=new WeakMap,Jy=function(){return m((function t(){c(this,t),f(this,Qy,Object.create(null))}),[{key:"updateProperty",value:function(t,e){this[t]=e,this.updateSVGProperty(t,e)}},{key:"updateProperties",value:function(t){if(t)for(var e=0,n=Object.entries(t);e<n.length;e++){var i=D(n[e],2),r=i[0],a=i[1];r.startsWith("_")||this.updateProperty(r,a)}}},{key:"updateSVGProperty",value:function(t,e){d(Qy,this)[t]=e}},{key:"toSVGProperties",value:function(){var t=d(Qy,this);return v(Qy,this,Object.create(null)),{root:t}}},{key:"reset",value:function(){v(Qy,this,Object.create(null))}},{key:"updateAll",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this;this.updateProperties(t)}},{key:"clone",value:function(){Pr("Not implemented")}}])}(),Zy=new WeakMap,$y=new WeakMap,tm=new WeakSet,em=function(t){function e(t){var n;return c(this,e),g(n=u(this,e,[t]),tm),f(n,Zy,null),f(n,$y,void 0),b(n,"_colorPicker",null),b(n,"_drawId",null),v($y,n,t.mustBeCommitted||!1),n._addOutlines(t),n}return _(e,t),m(e,[{key:"_addOutlines",value:function(t){t.drawOutlines&&(r(tm,this,nm).call(this,t),r(tm,this,am).call(this))}},{key:"updateParams",value:function(t,e){var n=this.constructor.typesMap.get(t);n&&this._updateProperty(t,n,e)}},{key:"propertiesToUpdate",get:function(){var t,e=[],n=this._drawingOptions,i=w(this.constructor.typesMap);try{for(i.s();!(t=i.n()).done;){var r=D(t.value,2),a=r[0],s=r[1];e.push([a,n[s]])}}catch(o){i.e(o)}finally{i.f()}return e}},{key:"_updateProperty",value:function(t,e,n){var i=this,a=this._drawingOptions,s=a[e],o=function(n){var s;a.updateProperty(e,n);var o,l=d(Zy,i).updateProperty(e,n);(l&&r(tm,i,lm).call(i,l),null===(s=i.parent)||void 0===s||s.drawLayer.updateProperties(i._drawId,a.toSVGProperties()),t===i.colorType)&&(null===(o=i._colorPicker)||void 0===o||o.update(n))};this.addCommands({cmd:o.bind(this,n),undo:o.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}},{key:"_onResizing",value:function(){var t;null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(this._drawId,e._mergeSVGProperties(d(Zy,this).getPathResizingSVGProperties(r(tm,this,om).call(this)),{bbox:r(tm,this,um).call(this)}))}},{key:"_onResized",value:function(){var t;null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(this._drawId,e._mergeSVGProperties(d(Zy,this).getPathResizedSVGProperties(r(tm,this,om).call(this)),{bbox:r(tm,this,um).call(this)}))}},{key:"_onTranslating",value:function(t,e){var n;null===(n=this.parent)||void 0===n||n.drawLayer.updateProperties(this._drawId,{bbox:r(tm,this,um).call(this)})}},{key:"_onTranslated",value:function(){var t;null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(this._drawId,e._mergeSVGProperties(d(Zy,this).getPathTranslatedSVGProperties(r(tm,this,om).call(this),this.parentDimensions),{bbox:r(tm,this,um).call(this)}))}},{key:"_onStartDragging",value:function(){var t;null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}},{key:"_onStopDragging",value:function(){var t;null===(t=this.parent)||void 0===t||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}},{key:"commit",value:function(){L(e,"commit",this,3)([]),this.disableEditMode(),this.disableEditing()}},{key:"disableEditing",value:function(){L(e,"disableEditing",this,3)([]),this.div.classList.toggle("disabled",!0)}},{key:"enableEditing",value:function(){L(e,"enableEditing",this,3)([]),this.div.classList.toggle("disabled",!1)}},{key:"getBaseTranslation",value:function(){return[0,0]}},{key:"isResizable",get:function(){return!0}},{key:"onceAdded",value:function(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,d($y,this)&&(v($y,this,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}},{key:"remove",value:function(){r(tm,this,rm).call(this),L(e,"remove",this,3)([])}},{key:"rebuild",value:function(){this.parent&&(L(e,"rebuild",this,3)([]),null!==this.div&&(r(tm,this,am).call(this),r(tm,this,lm).call(this,d(Zy,this).box),this.isAttachedToDOM||this.parent.add(this)))}},{key:"setParent",value:function(t){var n=!1;if(this.parent&&!t)this._uiManager.removeShouldRescale(this),r(tm,this,rm).call(this);else if(t){var i;this._uiManager.addShouldRescale(this),r(tm,this,am).call(this,t),n=!this.parent&&(null===(i=this.div)||void 0===i?void 0:i.classList.contains("selectedEditor"))}L(e,"setParent",this,3)([t]),n&&this.select()}},{key:"rotate",value:function(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,e._mergeSVGProperties({bbox:r(tm,this,um).call(this)},d(Zy,this).updateRotation((this.parentRotation-this.rotation+360)%360)))}},{key:"onScaleChanging",value:function(){this.parent&&r(tm,this,lm).call(this,d(Zy,this).updateParentDimensions(this.parentDimensions,this.parent.scale))}},{key:"render",value:function(){if(this.div)return this.div;var t,n;this._isCopy&&(t=this.x,n=this.y);var i=L(e,"render",this,3)([]);i.classList.add("draw");var r=document.createElement("div");i.append(r),r.setAttribute("aria-hidden","true"),r.className="internal";var a=D(this.parentDimensions,2),s=a[0],o=a[1];return this.setDims(this.width*s,this.height*o),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,n),i}},{key:"createDrawingOptions",value:function(t){}},{key:"serializeDraw",value:function(t){var e=D(this.pageTranslation,2),n=e[0],i=e[1],r=D(this.pageDimensions,2),a=r[0],s=r[1];return d(Zy,this).serialize([n,i,a,s],t)}},{key:"renderAnnotationElement",value:function(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}],[{key:"_mergeSVGProperties",value:function(t,e){for(var n=new Set(Object.keys(t)),i=0,r=Object.entries(e);i<r.length;i++){var a=D(r[i],2),s=a[0],o=a[1];n.has(s)?Object.assign(t[s],o):t[s]=o}return t}},{key:"getDefaultDrawingOptions",value:function(t){Pr("Not implemented")}},{key:"typesMap",get:function(){Pr("Not implemented")}},{key:"isDrawer",get:function(){return!0}},{key:"supportMultipleDrawings",get:function(){return!1}},{key:"updateDefaultParams",value:function(t,e){var n=this.typesMap.get(t);n&&this._defaultDrawingOptions.updateProperty(n,e),this._currentParent&&(hm._.updateProperty(n,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}},{key:"defaultPropertiesToUpdate",get:function(){var t,e=[],n=this._defaultDrawingOptions,i=w(this.typesMap);try{for(i.s();!(t=i.n()).done;){var r=D(t.value,2),a=r[0],s=r[1];e.push([a,n[s]])}}catch(o){i.e(o)}finally{i.f()}return e}},{key:"onScaleChangingWhenDrawing",value:function(){}},{key:"createDrawerInstance",value:function(t,e,n,i,r){Pr("Not implemented")}},{key:"startDrawing",value:function(t,e,n,i){var r,a,s=this,o=i.target,l=i.offsetX,u=i.offsetY,h=i.pointerId,c=i.pointerType;if(!vm._||vm._===c){var d=t.viewport.rotation,f=o.getBoundingClientRect(),v=f.width,p=f.height,g=cm._=new AbortController,y=t.combinedSignal(g);if(fm._||(fm._=h),null!==(r=vm._)&&void 0!==r||(vm._=c),window.addEventListener("pointerup",(function(t){var e;fm._===t.pointerId?s._endDraw(t):null===(e=pm._)||void 0===e||e["delete"](t.pointerId)}),{signal:y}),window.addEventListener("pointercancel",(function(t){var e;fm._===t.pointerId?s._currentParent.endDrawingSession():null===(e=pm._)||void 0===e||e["delete"](t.pointerId)}),{signal:y}),window.addEventListener("pointerdown",(function(t){vm._===t.pointerType&&((pm._||(pm._=new Set)).add(t.pointerId),hm._.isCancellable()&&(hm._.removeLastElement(),hm._.isEmpty()?s._currentParent.endDrawingSession(!0):s._endDraw(null)))}),{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",pa,{signal:y}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:y}),o.addEventListener("touchmove",(function(t){t.timeStamp===gm._&&ga(t)}),{signal:y}),t.toggleDrawing(),null===(a=e._editorUndoBar)||void 0===a||a.hide(),hm._)t.drawLayer.updateProperties(this._currentDrawId,hm._.startNew(l,u,v,p,d));else{e.updateUIForDefaultProperties(this),hm._=this.createDrawerInstance(l,u,v,p,d),dm._=this.getDefaultDrawingOptions(),this._currentParent=t;var m=t.drawLayer.draw(this._mergeSVGProperties(dm._.toSVGProperties(),hm._.defaultSVGProperties),!0,!1);this._currentDrawId=m.id}}}},{key:"_drawMove",value:function(t){var e;if(gm._=-1,hm._){var n=t.offsetX,i=t.offsetY,r=t.pointerId;fm._===r&&((null===(e=pm._)||void 0===e?void 0:e.size)>=1?this._endDraw(t):(this._currentParent.drawLayer.updateProperties(this._currentDrawId,hm._.add(n,i)),gm._=t.timeStamp,ga(t)))}}},{key:"_cleanup",value:function(t){t&&(this._currentDrawId=-1,this._currentParent=null,hm._=null,dm._=null,vm._=null,gm._=NaN),cm._&&(cm._.abort(),cm._=null,fm._=NaN,pm._=null)}},{key:"_endDraw",value:function(t){var e=this._currentParent;if(e)if(e.toggleDrawing(!0),this._cleanup(!1),(null==t?void 0:t.target)===e.div&&e.drawLayer.updateProperties(this._currentDrawId,hm._.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){var n=hm._,i=this._currentDrawId,r=n.getLastElement();e.addCommands({cmd:function(){e.drawLayer.updateProperties(i,n.setLastElement(r))},undo:function(){e.drawLayer.updateProperties(i,n.removeLastElement())},mustExec:!1,type:rr.DRAW_STEP})}else this.endDrawing(!1)}},{key:"endDrawing",value:function(t){var e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(rr.DRAW_STEP),!hm._.isEmpty()){var n=D(e.pageDimensions,2),i=n[0],r=n[1],a=e.scale,s=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:hm._.getOutlines(i*a,r*a,a,this._INNER_MARGIN),drawingOptions:dm._,mustBeCommitted:!t});return this._cleanup(!0),s}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}},{key:"deserializeDraw",value:function(t,e,n,i,r,a){Pr("Not implemented")}},{key:"deserialize",value:(n=l(T().m((function i(t,n,a){var s,o,l,u,h,c,d;return T().w((function(i){for(;;)switch(i.n){case 0:return s=n.viewport.rawDims,o=s.pageWidth,l=s.pageHeight,u=s.pageX,h=s.pageY,c=this.deserializeDraw(u,h,o,l,this._INNER_MARGIN,t),i.n=1,L(e,"deserialize",this,2)([t,n,a]);case 1:return(d=i.v).createDrawingOptions(t),r(tm,d,nm).call(d,{drawOutlines:c}),r(tm,d,am).call(d),d.onScaleChanging(),d.rotate(),i.a(2,d)}}),i,this)}))),function(t,e,i){return n.apply(this,arguments)})},{key:"canCreateNewEmptyEditor",value:function(){return!1}}]);var n}(Xl);function nm(t){var e=t.drawOutlines,n=t.drawId,i=t.drawingOptions;v(Zy,this,e),this._drawingOptions||(this._drawingOptions=i),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-".concat(this.editorType,"-added-alert")),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,e.defaultProperties)):this._drawId=r(tm,this,im).call(this,e,this.parent),r(tm,this,lm).call(this,e.box)}function im(t,e){return e.drawLayer.draw(Di._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1).id}function rm(){null!==this._drawId&&this.parent&&(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}function am(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.parent;null!==this._drawId&&this.parent===t||(null===this._drawId?(this._drawingOptions.updateAll(),this._drawId=r(tm,this,im).call(this,d(Zy,this),t)):this.parent.drawLayer.updateParent(this._drawId,t.drawLayer))}function sm(t){var e=D(t,4),n=e[0],i=e[1],r=e[2],a=e[3],s=D(this.parentDimensions,2),o=s[0],l=s[1];switch(this.rotation){case 90:return[i,1-n,r*(l/o),a*(o/l)];case 180:return[1-n,1-i,r,a];case 270:return[1-i,n,r*(l/o),a*(o/l)];default:return[n,i,r,a]}}function om(){var t=this.x,e=this.y,n=this.width,i=this.height,r=D(this.parentDimensions,2),a=r[0],s=r[1];switch(this.rotation){case 90:return[1-e,t,n*(a/s),i*(s/a)];case 180:return[1-t,1-e,n,i];case 270:return[e,1-t,n*(a/s),i*(s/a)];default:return[t,e,n,i]}}function lm(t){var e=D(r(tm,this,sm).call(this,t),4);if(this.x=e[0],this.y=e[1],this.width=e[2],this.height=e[3],this.div){this.fixAndSetPosition();var n=D(this.parentDimensions,2),i=n[0],a=n[1];this.setDims(this.width*i,this.height*a)}this._onResized()}function um(){var t=this.x,e=this.y,n=this.width,i=this.height,r=this.rotation,a=this.parentRotation,s=D(this.parentDimensions,2),o=s[0],l=s[1];switch((4*r+a)/90){case 1:return[1-e-i,t,i,n];case 2:return[1-t-n,1-e-i,n,i];case 3:return[e,1-t-n,i,n];case 4:return[t,e-n*(o/l),i*(l/o),n*(o/l)];case 5:return[1-e,t,n*(o/l),i*(l/o)];case 6:return[1-t-i*(l/o),1-e,i*(l/o),n*(o/l)];case 7:return[e-n*(o/l),1-t-i*(l/o),n*(o/l),i*(l/o)];case 8:return[t-n,e-i,n,i];case 9:return[1-e,t-n,i,n];case 10:return[1-t,1-e,n,i];case 11:return[e-i,1-t,i,n];case 12:return[t-i*(l/o),e,i*(l/o),n*(o/l)];case 13:return[1-e-n*(o/l),t-i*(l/o),n*(o/l),i*(l/o)];case 14:return[1-t,1-e-n*(o/l),i*(l/o),n*(o/l)];case 15:return[e,1-t,n*(o/l),i*(l/o)];default:return[t,e,n,i]}}Di=em,b(em,"_currentDrawId",-1),b(em,"_currentParent",null);var hm={_:null},cm={_:null},dm={_:null},fm={_:NaN},vm={_:null},pm={_:null},gm={_:NaN};b(em,"_INNER_MARGIN",3);var ym=new WeakMap,mm=new WeakMap,wm=new WeakMap,bm=new WeakMap,km=new WeakMap,Am=new WeakMap,_m=new WeakMap,xm=new WeakMap,Sm=new WeakMap,Em=new WeakMap,Mm=new WeakMap,Cm=new WeakSet,Tm=function(){return m((function t(e,n,i,a,s,o){c(this,t),g(this,Cm),f(this,ym,new Float64Array(6)),f(this,mm,void 0),f(this,wm,void 0),f(this,bm,void 0),f(this,km,void 0),f(this,Am,void 0),f(this,_m,""),f(this,xm,0),f(this,Sm,new Hm),f(this,Em,void 0),f(this,Mm,void 0),v(Em,this,i),v(Mm,this,a),v(bm,this,s),v(km,this,o);var l=D(r(Cm,this,Rm).call(this,e,n),2);e=l[0],n=l[1];var u=v(mm,this,[NaN,NaN,NaN,NaN,e,n]);v(Am,this,[e,n]),v(wm,this,[{line:u,points:d(Am,this)}]),d(ym,this).set(u,0)}),[{key:"updateProperty",value:function(t,e){"stroke-width"===t&&v(km,this,e)}},{key:"isEmpty",value:function(){return!d(wm,this)||0===d(wm,this).length}},{key:"isCancellable",value:function(){return d(Am,this).length<=10}},{key:"add",value:function(t,e){var n,i=D(r(Cm,this,Rm).call(this,t,e),2);t=i[0],e=i[1];var a=D(d(ym,this).subarray(2,6),4),s=a[0],o=a[1],l=a[2],u=a[3],h=t-l,c=e-u;return Math.hypot(d(Em,this)*h,d(Mm,this)*c)<=2?null:(d(Am,this).push(t,e),isNaN(s)?(d(ym,this).set([l,u,t,e],2),d(mm,this).push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(d(ym,this)[0])&&d(mm,this).splice(6,6),d(ym,this).set([s,o,l,u,t,e],0),(n=d(mm,this)).push.apply(n,F(yg.createBezierPoints(s,o,l,u,t,e))),{path:{d:this.toSVGPath()}}))}},{key:"end",value:function(t,e){var n=this.add(t,e);return n||(2===d(Am,this).length?{path:{d:this.toSVGPath()}}:null)}},{key:"startNew",value:function(t,e,n,i,a){v(Em,this,n),v(Mm,this,i),v(bm,this,a);var s=D(r(Cm,this,Rm).call(this,t,e),2);t=s[0],e=s[1];var o=v(mm,this,[NaN,NaN,NaN,NaN,t,e]);v(Am,this,[t,e]);var l=d(wm,this).at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),d(wm,this).push({line:o,points:d(Am,this)}),d(ym,this).set(o,0),v(xm,this,0),this.toSVGPath(),null}},{key:"getLastElement",value:function(){return d(wm,this).at(-1)}},{key:"setLastElement",value:function(t){return d(wm,this)?(d(wm,this).push(t),v(mm,this,t.line),v(Am,this,t.points),v(xm,this,0),{path:{d:this.toSVGPath()}}):d(Sm,this).setLastElement(t)}},{key:"removeLastElement",value:function(){if(!d(wm,this))return d(Sm,this).removeLastElement();d(wm,this).pop(),v(_m,this,"");for(var t=0,e=d(wm,this).length;t<e;t++){var n=d(wm,this)[t],i=n.line,r=n.points;v(mm,this,i),v(Am,this,r),v(xm,this,0),this.toSVGPath()}return{path:{d:d(_m,this)}}}},{key:"toSVGPath",value:function(){var t=yg.svgRound(d(mm,this)[4]),e=yg.svgRound(d(mm,this)[5]);if(2===d(Am,this).length)return v(_m,this,"".concat(d(_m,this)," M ").concat(t," ").concat(e," Z")),d(_m,this);if(d(Am,this).length<=6){var n=d(_m,this).lastIndexOf("M");v(_m,this,"".concat(d(_m,this).slice(0,n)," M ").concat(t," ").concat(e)),v(xm,this,6)}if(4===d(Am,this).length){var i=yg.svgRound(d(mm,this)[10]),r=yg.svgRound(d(mm,this)[11]);return v(_m,this,"".concat(d(_m,this)," L ").concat(i," ").concat(r)),v(xm,this,12),d(_m,this)}var a=[];0===d(xm,this)&&(a.push("M ".concat(t," ").concat(e)),v(xm,this,6));for(var s=d(xm,this),o=d(mm,this).length;s<o;s+=6){var l=D(d(mm,this).slice(s,s+6).map(yg.svgRound),6),u=l[0],h=l[1],c=l[2],f=l[3],p=l[4],g=l[5];a.push("C".concat(u," ").concat(h," ").concat(c," ").concat(f," ").concat(p," ").concat(g))}return v(_m,this,d(_m,this)+a.join(" ")),v(xm,this,d(mm,this).length),d(_m,this)}},{key:"getOutlines",value:function(t,e,n,i){var r=d(wm,this).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),d(Sm,this).build(d(wm,this),t,e,n,d(bm,this),d(km,this),i),v(ym,this,null),v(mm,this,null),v(wm,this,null),v(_m,this,null),d(Sm,this)}},{key:"defaultSVGProperties",get:function(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}])}();function Rm(t,e){return yg._normalizePoint(t,e,d(Em,this),d(Mm,this),d(bm,this))}var Pm=new WeakMap,Im=new WeakMap,Dm=new WeakMap,Lm=new WeakMap,Om=new WeakMap,Fm=new WeakMap,Nm=new WeakMap,Wm=new WeakMap,Bm=new WeakMap,jm=new WeakSet,Hm=function(t){function e(){var t;c(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return g(t=u(this,e,[].concat(i)),jm),f(t,Pm,void 0),f(t,Im,0),f(t,Dm,void 0),f(t,Lm,void 0),f(t,Om,void 0),f(t,Fm,void 0),f(t,Nm,void 0),f(t,Wm,void 0),f(t,Bm,void 0),t}return _(e,t),m(e,[{key:"build",value:function(t,e,n,i,a,s,o){v(Om,this,e),v(Fm,this,n),v(Nm,this,i),v(Wm,this,a),v(Bm,this,s),v(Dm,this,null!=o?o:0),v(Lm,this,t),r(jm,this,Gm).call(this)}},{key:"thickness",get:function(){return d(Bm,this)}},{key:"setLastElement",value:function(t){return d(Lm,this).push(t),{path:{d:this.toSVGPath()}}}},{key:"removeLastElement",value:function(){return d(Lm,this).pop(),{path:{d:this.toSVGPath()}}}},{key:"toSVGPath",value:function(){var t,e=[],n=w(d(Lm,this));try{for(n.s();!(t=n.n()).done;){var i=t.value.line;if(e.push("M".concat(yg.svgRound(i[4])," ").concat(yg.svgRound(i[5]))),6!==i.length)if(12===i.length&&isNaN(i[6]))e.push("L".concat(yg.svgRound(i[10])," ").concat(yg.svgRound(i[11])));else for(var r=6,a=i.length;r<a;r+=6){var s=D(i.subarray(r,r+6).map(yg.svgRound),6),o=s[0],l=s[1],u=s[2],h=s[3],c=s[4],f=s[5];e.push("C".concat(o," ").concat(l," ").concat(u," ").concat(h," ").concat(c," ").concat(f))}else e.push("Z")}}catch(v){n.e(v)}finally{n.f()}return e.join("")}},{key:"serialize",value:function(t,e){var n,i,a,s,o,l,u,h,c,f=D(t,4),v=f[0],p=f[1],g=f[2],y=f[3],m=[],b=[],k=D(r(jm,this,zm).call(this),4),A=k[0],_=k[1],x=k[2],S=k[3];switch(d(Wm,this)){case 0:c=yg._rescale,n=v,i=p+y,a=g,s=-y,o=v+A*g,l=p+(1-_-S)*y,u=v+(A+x)*g,h=p+(1-_)*y;break;case 90:c=yg._rescaleAndSwap,n=v,i=p,a=g,s=y,o=v+_*g,l=p+A*y,u=v+(_+S)*g,h=p+(A+x)*y;break;case 180:c=yg._rescale,n=v+g,i=p,a=-g,s=y,o=v+(1-A-x)*g,l=p+_*y,u=v+(1-A)*g,h=p+(_+S)*y;break;case 270:c=yg._rescaleAndSwap,n=v+g,i=p+y,a=-g,s=-y,o=v+(1-_-S)*g,l=p+(1-A-x)*y,u=v+(1-_)*g,h=p+(1-A)*y}var E,M=w(d(Lm,this));try{for(M.s();!(E=M.n()).done;){var C=E.value,T=C.line,R=C.points;m.push(c(T,n,i,a,s,e?new Array(T.length):null)),b.push(c(R,n,i,a,s,e?new Array(R.length):null))}}catch(P){M.e(P)}finally{M.f()}return{lines:m,points:b,rect:[o,l,u,h]}}},{key:"box",get:function(){return d(Pm,this)}},{key:"updateProperty",value:function(t,e){return"stroke-width"===t?r(jm,this,Vm).call(this,e):null}},{key:"updateParentDimensions",value:function(t,e){var n=D(t,2),i=n[0],a=n[1],s=D(r(jm,this,Um).call(this),2),o=s[0],l=s[1];v(Om,this,i),v(Fm,this,a),v(Nm,this,e);var u=D(r(jm,this,Um).call(this),2),h=u[0]-o,c=u[1]-l,f=d(Pm,this);return f[0]-=h,f[1]-=c,f[2]+=2*h,f[3]+=2*c,f}},{key:"updateRotation",value:function(t){return v(Im,this,t),{path:{transform:this.rotationTransform}}}},{key:"viewBox",get:function(){return d(Pm,this).map(yg.svgRound).join(" ")}},{key:"defaultProperties",get:function(){var t=D(d(Pm,this),2),e=t[0],n=t[1];return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(yg.svgRound(e)," ").concat(yg.svgRound(n))}}}},{key:"rotationTransform",get:function(){var t=D(d(Pm,this),4),e=t[2],n=t[3],i=0,r=0,a=0,s=0,o=0,l=0;switch(d(Im,this)){case 90:r=n/e,a=-e/n,o=e;break;case 180:i=-1,s=-1,o=e,l=n;break;case 270:r=-n/e,a=e/n,l=n;break;default:return""}return"matrix(".concat(i," ").concat(r," ").concat(a," ").concat(s," ").concat(yg.svgRound(o)," ").concat(yg.svgRound(l),")")}},{key:"getPathResizingSVGProperties",value:function(t){var e=D(t,4),n=e[0],i=e[1],a=e[2],s=e[3],o=D(r(jm,this,Um).call(this),2),l=o[0],u=o[1],h=D(d(Pm,this),4),c=h[0],f=h[1],v=h[2],p=h[3];if(Math.abs(v-l)<=yg.PRECISION||Math.abs(p-u)<=yg.PRECISION){var g=n+a/2-(c+v/2),y=i+s/2-(f+p/2);return{path:{"transform-origin":"".concat(yg.svgRound(n)," ").concat(yg.svgRound(i)),transform:"".concat(this.rotationTransform," translate(").concat(g," ").concat(y,")")}}}var m=(a-2*l)/(v-2*l),w=(s-2*u)/(p-2*u),b=v/a,k=p/s;return{path:{"transform-origin":"".concat(yg.svgRound(c)," ").concat(yg.svgRound(f)),transform:"".concat(this.rotationTransform," scale(").concat(b," ").concat(k,") ")+"translate(".concat(yg.svgRound(l)," ").concat(yg.svgRound(u),") scale(").concat(m," ").concat(w,") ")+"translate(".concat(yg.svgRound(-l)," ").concat(yg.svgRound(-u),")")}}}},{key:"getPathResizedSVGProperties",value:function(t){var e=D(t,4),n=e[0],i=e[1],a=e[2],s=e[3],o=D(r(jm,this,Um).call(this),2),l=o[0],u=o[1],h=d(Pm,this),c=D(h,4),f=c[0],v=c[1],p=c[2],g=c[3];if(h[0]=n,h[1]=i,h[2]=a,h[3]=s,Math.abs(p-l)<=yg.PRECISION||Math.abs(g-u)<=yg.PRECISION){var y,m=n+a/2-(f+p/2),b=i+s/2-(v+g/2),k=w(d(Lm,this));try{for(k.s();!(y=k.n()).done;){var A=y.value,_=A.line,x=A.points;yg._translate(_,m,b,_),yg._translate(x,m,b,x)}}catch(O){k.e(O)}finally{k.f()}return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(yg.svgRound(n)," ").concat(yg.svgRound(i)),transform:this.rotationTransform||null,d:this.toSVGPath()}}}var S=(a-2*l)/(p-2*l),E=(s-2*u)/(g-2*u),M=-S*(f+l)+n+l,C=-E*(v+u)+i+u;if(1!==S||1!==E||0!==M||0!==C){var T,R=w(d(Lm,this));try{for(R.s();!(T=R.n()).done;){var P=T.value,I=P.line,L=P.points;yg._rescale(I,M,C,S,E,I),yg._rescale(L,M,C,S,E,L)}}catch(O){R.e(O)}finally{R.f()}}return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(yg.svgRound(n)," ").concat(yg.svgRound(i)),transform:this.rotationTransform||null,d:this.toSVGPath()}}}},{key:"getPathTranslatedSVGProperties",value:function(t,e){var n=D(t,2),i=n[0],r=n[1],a=D(e,2),s=a[0],o=a[1],l=d(Pm,this),u=i-l[0],h=r-l[1];if(d(Om,this)===s&&d(Fm,this)===o){var c,f=w(d(Lm,this));try{for(f.s();!(c=f.n()).done;){var p=c.value,g=p.line,y=p.points;yg._translate(g,u,h,g),yg._translate(y,u,h,y)}}catch(E){f.e(E)}finally{f.f()}}else{var m=d(Om,this)/s,b=d(Fm,this)/o;v(Om,this,s),v(Fm,this,o);var k,A=w(d(Lm,this));try{for(A.s();!(k=A.n()).done;){var _=k.value,x=_.line,S=_.points;yg._rescale(x,u,h,m,b,x),yg._rescale(S,u,h,m,b,S)}}catch(E){A.e(E)}finally{A.f()}l[2]*=m,l[3]*=b}return l[0]=i,l[1]=r,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":"".concat(yg.svgRound(i)," ").concat(yg.svgRound(r))}}}},{key:"defaultSVGProperties",get:function(){var t=d(Pm,this);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":"".concat(yg.svgRound(t[0])," ").concat(yg.svgRound(t[1])),transform:this.rotationTransform||null},bbox:t}}}],[{key:"deserialize",value:function(t,e,n,i,r,a){var s,o,l,u,h,c=a.paths,d=c.lines,f=c.points,v=a.rotation,p=a.thickness,g=[];switch(v){case 0:h=yg._rescale,s=-t/n,o=e/i+1,l=1/n,u=-1/i;break;case 90:h=yg._rescaleAndSwap,s=-e/i,o=-t/n,l=1/i,u=1/n;break;case 180:h=yg._rescale,s=t/n+1,o=-e/i,l=-1/n,u=1/i;break;case 270:h=yg._rescaleAndSwap,s=e/i+1,o=t/n+1,l=-1/i,u=-1/n}if(!d){d=[];var y,m=w(f);try{for(m.s();!(y=m.n()).done;){var b=y.value,k=b.length;if(2!==k)if(4!==k){var A=new Float32Array(3*(k-2));d.push(A);var _=D(b.subarray(0,4),4),x=_[0],S=_[1],E=_[2],M=_[3];A.set([NaN,NaN,NaN,NaN,x,S],0);for(var C=4;C<k;C+=2){var T=b[C],R=b[C+1];A.set(yg.createBezierPoints(x,S,E,M,T,R),3*(C-2));var P=[E,M,T,R];x=P[0],S=P[1],E=P[2],M=P[3]}}else d.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1],NaN,NaN,NaN,NaN,b[2],b[3]]));else d.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1]]))}}catch(F){m.e(F)}finally{m.f()}}for(var I=0,L=d.length;I<L;I++)g.push({line:h(d[I].map((function(t){return null!=t?t:NaN})),s,o,l,u),points:h(f[I].map((function(t){return null!=t?t:NaN})),s,o,l,u)});var O=new this.prototype.constructor;return O.build(g,n,i,1,v,p,r),O}}])}(yg);function Um(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:d(Bm,this),e=d(Dm,this)+t/2*d(Nm,this);return d(Wm,this)%180==0?[e/d(Om,this),e/d(Fm,this)]:[e/d(Fm,this),e/d(Om,this)]}function zm(){var t=D(d(Pm,this),4),e=t[0],n=t[1],i=t[2],a=t[3],s=D(r(jm,this,Um).call(this,0),2),o=s[0],l=s[1];return[e+o,n+l,i-2*o,a-2*l]}function Gm(){var t,e=v(Pm,this,new Float32Array([Infinity,Infinity,-Infinity,-Infinity])),n=w(d(Lm,this));try{for(n.s();!(t=n.n()).done;){var i=t.value.line;if(i.length<=12)for(var a=4,s=i.length;a<s;a+=6)Xr.pointBoundingBox(i[a],i[a+1],e);else for(var o=i[4],l=i[5],u=6,h=i.length;u<h;u+=6){var c=D(i.subarray(u,u+6),6),f=c[0],p=c[1],g=c[2],y=c[3],m=c[4],b=c[5];Xr.bezierBoundingBox(o,l,f,p,g,y,m,b,e),o=m,l=b}}}catch(x){n.e(x)}finally{n.f()}var k=D(r(jm,this,Um).call(this),2),A=k[0],_=k[1];e[0]=ea(e[0]-A,0,1),e[1]=ea(e[1]-_,0,1),e[2]=ea(e[2]+A,0,1),e[3]=ea(e[3]+_,0,1),e[2]-=e[0],e[3]-=e[1]}function Vm(t){var e=D(r(jm,this,Um).call(this),2),n=e[0],i=e[1];v(Bm,this,t);var a=D(r(jm,this,Um).call(this),2),s=a[0]-n,o=a[1]-i,l=d(Pm,this);return l[0]-=s,l[1]-=o,l[2]+=2*s,l[3]+=2*o,l}var qm=function(t){function e(t){var n;return c(this,e),(n=u(this,e))._viewParameters=t,L(e,"updateProperties",n,3)([{fill:"none",stroke:Xl._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10}]),n}return _(e,t),m(e,[{key:"updateSVGProperty",value:function(t,n){"stroke-width"===t&&(null!=n||(n=this["stroke-width"]),n*=this._viewParameters.realScale),L(e,"updateSVGProperty",this,3)([t,n])}},{key:"clone",value:function(){var t=new e(this._viewParameters);return t.updateAll(this),t}}])}(Jy),Xm=new WeakSet,Ym=function(t){function e(t){var n;return c(this,e),g(n=u(this,e,[C(C({},t),{},{name:"inkEditor"})]),Xm),n._willKeepAspectRatio=!0,n.defaultL10nId="pdfjs-editor-ink-editor",n}return _(e,t),m(e,[{key:"toolbarButtons",get:function(){return this._colorPicker||(this._colorPicker=new cv(this)),[["colorPicker",this._colorPicker]]}},{key:"colorType",get:function(){return rr.INK_COLOR}},{key:"colorValue",get:function(){return this._drawingOptions.stroke}},{key:"onScaleChanging",value:function(){if(this.parent){L(e,"onScaleChanging",this,3)([]);var t=this._drawId,n=this._drawingOptions,i=this.parent;n.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,n.toSVGProperties())}}},{key:"createDrawingOptions",value:function(t){var n=t.color,i=t.thickness,r=t.opacity;this._drawingOptions=e.getDefaultDrawingOptions({stroke:Xr.makeHexColor.apply(Xr,F(n)),"stroke-width":i,"stroke-opacity":r})}},{key:"serialize",value:function(){var t=arguments.length>0&&arguments[0]!==undefined&&arguments[0];if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();var e=this.serializeDraw(t),n=e.lines,i=e.points,a=e.rect,s=this._drawingOptions,o=s.stroke,l=s["stroke-opacity"],u=s["stroke-width"],h={annotationType:ir.INK,color:Xl._colorManager.convert(o),opacity:l,thickness:u,paths:{lines:n,points:i},pageIndex:this.pageIndex,rect:a,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(h),t?(h.isCopy=!0,h):this.annotationElementId&&!r(Xm,this,Km).call(this,h)?null:(h.id=this.annotationElementId,h)}},{key:"renderAnnotationElement",value:function(t){var e=this.serializeDraw(!1),n=e.points,i={rect:e.rect,thickness:this._drawingOptions["stroke-width"],points:n};return this.hasEditedComment&&(i.popup=this.comment),t.updateEdited(i),null}}],[{key:"initialize",value:function(t,e){Xl.initialize(t,e),this._defaultDrawingOptions=new qm(e.viewParameters)}},{key:"getDefaultDrawingOptions",value:function(t){var e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}},{key:"supportMultipleDrawings",get:function(){return!0}},{key:"typesMap",get:function(){return Or(this,"typesMap",new Map([[rr.INK_THICKNESS,"stroke-width"],[rr.INK_COLOR,"stroke"],[rr.INK_OPACITY,"stroke-opacity"]]))}},{key:"createDrawerInstance",value:function(t,e,n,i,r){return new Tm(t,e,n,i,r,this._defaultDrawingOptions["stroke-width"])}},{key:"deserializeDraw",value:function(t,e,n,i,r,a){return Hm.deserialize(t,e,n,i,r,a)}},{key:"deserialize",value:(n=l(T().m((function i(t,n,r){var a,s,o,l,u,h,c,d,f,v,p,g,y,m;return T().w((function(i){for(;;)switch(i.n){case 0:return a=null,t instanceof Lp&&(o=(s=t).data,l=o.inkLists,u=o.rect,h=o.rotation,c=o.id,d=o.color,f=o.opacity,v=o.borderStyle.rawWidth,p=o.popupRef,g=o.contentsObj,y=s.parent.page.pageNumber,a=t={annotationType:ir.INK,color:Array.from(d),thickness:v,opacity:f,paths:{points:l},boxes:null,pageIndex:y-1,rect:u.slice(0),rotation:h,annotationElementId:c,id:c,deleted:!1,popupRef:p,comment:(null==g?void 0:g.str)||null}),i.n=1,L(e,"deserialize",this,2)([t,n,r]);case 1:return(m=i.v)._initialData=a,t.comment&&m.setCommentData(t.comment),i.a(2,m)}}),i,this)}))),function(t,e,i){return n.apply(this,arguments)})},{key:"onScaleChangingWhenDrawing",value:function(){var t=this._currentParent;t&&(L(e,"onScaleChangingWhenDrawing",this,2)([]),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}}]);var n}(em);function Km(t){var e=this._initialData,n=e.color,i=e.thickness,r=e.opacity,a=e.pageIndex;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((function(t,e){return t!==n[e]}))||t.thickness!==i||t.opacity!==r||t.pageIndex!==a}b(Ym,"_type","ink"),b(Ym,"_editorType",ir.INK),b(Ym,"_defaultDrawingOptions",null);var Qm=function(t){function e(){return c(this,e),u(this,e,arguments)}return _(e,t),m(e,[{key:"toSVGPath",value:function(){var t=L(e,"toSVGPath",this,3)([]);return t.endsWith("Z")||(t+="Z"),t}}])}(Hm),Jm=function(){function t(){c(this,t)}return m(t,null,[{key:"extractContoursFromText",value:function(e,n,i,a,s,o){var l=n.fontFamily,u=n.fontStyle,h=n.fontWeight,c=new OffscreenCanvas(1,1),d=c.getContext("2d",{alpha:!1}),f=d.font="".concat(u," ").concat(h," ").concat(200,"px ").concat(l),v=d.measureText(e),p=v.actualBoundingBoxLeft,g=v.actualBoundingBoxRight,y=v.actualBoundingBoxAscent,m=v.actualBoundingBoxDescent,w=v.fontBoundingBoxAscent,b=v.fontBoundingBoxDescent,k=v.width,A=1.5,_=Math.ceil(Math.max(Math.abs(p)+Math.abs(g)||0,k)*A),x=Math.ceil(Math.max(Math.abs(y)+Math.abs(m)||200,Math.abs(w)+Math.abs(b)||200)*A);(d=(c=new OffscreenCanvas(_,x)).getContext("2d",{alpha:!0,willReadFrequently:!0})).font=f,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,_,x),d.fillStyle="black",d.fillText(e,.5*_/2,1.5*x/2);var S=r(t,this,sw).call(this,d.getImageData(0,0,_,x).data),E=r(t,this,aw).call(this,S),M=r(t,this,ow).call(this,E),C=r(t,this,ew).call(this,S,_,x,M);return this.processDrawnLines({lines:{curves:C,width:_,height:x},pageWidth:i,pageHeight:a,rotation:s,innerMargin:o,mustSmooth:!0,areContours:!0})}},{key:"process",value:function(e,n,i,a,s){var o=D(r(t,this,lw).call(this,e),3),l=o[0],u=o[1],h=o[2],c=D(r(t,this,rw).call(this,l,u,h,Math.hypot(u,h)*r(t,this,uw)._.sigmaSFactor,r(t,this,uw)._.sigmaR,r(t,this,uw)._.kernelSize),2),d=c[0],f=c[1],v=r(t,this,ow).call(this,f),p=r(t,this,ew).call(this,d,u,h,v);return this.processDrawnLines({lines:{curves:p,width:u,height:h},pageWidth:n,pageHeight:i,rotation:a,innerMargin:s,mustSmooth:!0,areContours:!0})}},{key:"processDrawnLines",value:function(e){var n,i=e.lines,a=e.pageWidth,s=e.pageHeight,o=e.rotation,l=e.innerMargin,u=e.mustSmooth,h=e.areContours;if(o%180!=0){var c=[s,a];a=c[0],s=c[1]}var d,f=i.curves,v=i.width,p=i.height,g=null!==(n=i.thickness)&&void 0!==n?n:0,y=[],m=Math.min(a/v,s/p),b=m/a,k=m/s,A=[],_=w(f);try{for(_.s();!(d=_.n()).done;){var x=d.value.points,S=u?r(t,this,iw).call(this,x):x;if(S){A.push(S);var E=S.length,M=new Float32Array(E),C=new Float32Array(3*(2===E?2:E-2));if(y.push({line:C,points:M}),2!==E){var T=D(S,4),R=T[0],P=T[1],I=T[2],L=T[3];R*=b,P*=k,I*=b,L*=k,M.set([R,P,I,L],0),C.set([NaN,NaN,NaN,NaN,R,P],0);for(var O=4;O<E;O+=2){var F=M[O]=S[O]*b,N=M[O+1]=S[O+1]*k;C.set(yg.createBezierPoints(R,P,I,L,F,N),3*(O-2));var W=[I,L,F,N];R=W[0],P=W[1],I=W[2],L=W[3]}}else M[0]=S[0]*b,M[1]=S[1]*k,C.set([NaN,NaN,NaN,NaN,M[0],M[1]],0)}}}catch(j){_.e(j)}finally{_.f()}if(0===y.length)return null;var B=h?new Qm:new Hm;return B.build(y,a,s,1,o,h?0:g,l),{outline:B,newCurves:A,areContours:h,thickness:g,width:v,height:p}}},{key:"compressSignature",value:(n=l(T().m((function i(t){var e,n,r,a,s,o,l,u,h,c,d,f,v,p,g,y,m,b,k,A,_,x,S,E,M,C,R,P,I,D,L,O,F;return T().w((function(i){for(;;)switch(i.n){case 0:e=t.outlines,n=t.areContours,r=t.thickness,a=t.width,s=t.height,o=Infinity,l=-Infinity,u=0,h=w(e);try{for(h.s();!(c=h.n()).done;)for(d=c.value,u+=d.length,f=2,v=d.length;f<v;f++)p=d[f]-d[f-2],o=Math.min(o,p),l=Math.max(l,p)}catch(T){h.e(T)}finally{h.f()}g=o>=-128&&l<=127?Int8Array:o>=-32768&&l<=32767?Int16Array:Int32Array,y=e.length,m=8+3*y,b=new Uint32Array(m),k=0,b[k++]=m*Uint32Array.BYTES_PER_ELEMENT+(u-2*y)*g.BYTES_PER_ELEMENT,b[k++]=0,b[k++]=a,b[k++]=s,b[k++]=n?0:1,b[k++]=Math.max(0,Math.floor(null!=r?r:0)),b[k++]=y,b[k++]=g.BYTES_PER_ELEMENT,A=w(e);try{for(A.s();!(_=A.n()).done;)x=_.value,b[k++]=x.length-2,b[k++]=x[0],b[k++]=x[1]}catch(T){A.e(T)}finally{A.f()}return S=new CompressionStream("deflate-raw"),E=S.writable.getWriter(),i.n=1,E.ready;case 1:E.write(b),M=g.prototype.constructor,C=w(e);try{for(C.s();!(R=C.n()).done;){for(P=R.value,I=new M(P.length-2),D=2,L=P.length;D<L;D++)I[D-2]=P[D]-P[D-2];E.write(I)}}catch(T){C.e(T)}finally{C.f()}return E.close(),i.n=2,new Response(S.readable).arrayBuffer();case 2:return O=i.v,F=new Uint8Array(O),i.a(2,na(F))}}),i)}))),function(t){return n.apply(this,arguments)})},{key:"decompressSignature",value:(e=l(T().m((function s(t){var e,n,i,r,o,u,h,c,d,f,v,p,g,y,m,w,b,k,A,_,x,S,E,M,C,R,P,I,D,L,O,F;return T().w((function(s){for(;;)switch(s.p=s.n){case 0:return s.p=0,N=t,e=Uint8Array.fromBase64?Uint8Array.fromBase64(N):Gr(atob(N)),n=new DecompressionStream("deflate-raw"),i=n.readable,r=n.writable,o=r.getWriter(),s.n=1,o.ready;case 1:o.write(e).then(l(T().m((function W(){return T().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,o.ready;case 1:return t.n=2,o.close();case 2:return t.a(2)}}),W)}))))["catch"]((function(){})),u=null,h=0,c=!1,d=!1,s.p=2,v=a(i);case 3:return s.n=4,v.next();case 4:if(!(c=!(p=s.v).done)){s.n=6;break}g=p.value,u||(u=new Uint8Array(new Uint32Array(g.buffer,0,4)[0])),u.set(g,h),h+=g.length;case 5:c=!1,s.n=3;break;case 6:s.n=8;break;case 7:s.p=7,L=s.v,d=!0,f=L;case 8:if(s.p=8,s.p=9,!c||null==v["return"]){s.n=10;break}return s.n=10,v["return"]();case 10:if(s.p=10,!d){s.n=11;break}throw f;case 11:return s.f(10);case 12:return s.f(8);case 13:if(y=new Uint32Array(u.buffer,0,u.length>>2),0===(m=y[1])){s.n=14;break}throw new Error("Invalid version: ".concat(m));case 14:w=y[2],b=y[3],k=0===y[4],A=y[5],_=y[6],x=y[7],S=[],E=(8+3*_)*Uint32Array.BYTES_PER_ELEMENT,O=x,s.n=O===Int8Array.BYTES_PER_ELEMENT?15:O===Int16Array.BYTES_PER_ELEMENT?16:O===Int32Array.BYTES_PER_ELEMENT?17:18;break;case 15:return M=new Int8Array(u.buffer,E),s.a(3,18);case 16:return M=new Int16Array(u.buffer,E),s.a(3,18);case 17:return M=new Int32Array(u.buffer,E),s.a(3,18);case 18:for(h=0,C=0;C<_;C++){for(R=y[3*C+8],P=new Float32Array(R+2),S.push(P),I=0;I<2;I++)P[I]=y[3*C+8+I+1];for(D=0;D<R;D++)P[D+2]=P[D]+M[h++]}return s.a(2,{areContours:k,thickness:A,outlines:S,width:w,height:b});case 19:return s.p=19,F=s.v,Rr("decompressSignature: ".concat(F)),s.a(2,null)}var N}),s,null,[[9,,10,12],[2,7,8,13],[0,19]])}))),function(t){return e.apply(this,arguments)})}]);var e,n}();function Zm(t,e,n,i){return i-=e,0===(n-=t)?i>0?0:4:1===n?i+6:2-i}function $m(t,e,n,i,a,s,o){for(var l=r(Li,this,Zm).call(this,n,i,a,s),u=0;u<8;u++){var h=(-u+l-o+16)%8;if(0!==t[(n+r(Li,this,hw)._[2*h])*e+(i+r(Li,this,hw)._[2*h+1])])return h}return-1}function tw(t,e,n,i,a,s,o){for(var l=r(Li,this,Zm).call(this,n,i,a,s),u=0;u<8;u++){var h=(u+l+o+16)%8;if(0!==t[(n+r(Li,this,hw)._[2*h])*e+(i+r(Li,this,hw)._[2*h+1])])return h}return-1}function ew(t,e,n,i){for(var a=t.length,s=new Int32Array(a),o=0;o<a;o++)s[o]=t[o]<=i?1:0;for(var l=1;l<n-1;l++)s[l*e]=s[l*e+e-1]=0;for(var u=0;u<e;u++)s[u]=s[e*n-1-u]=0;for(var h,c=1,d=[],f=1;f<n-1;f++){h=1;for(var v=1;v<e-1;v++){var p=f*e+v,g=s[p];if(0!==g){var y=f,m=v;if(1===g&&0===s[p-1])c+=1,m-=1;else{if(!(g>=1&&0===s[p+1])){1!==g&&(h=Math.abs(g));continue}c+=1,m+=1,g>1&&(h=g)}var b=[v,f],k=m===v+1,A={isHole:k,points:b,id:c,parent:0};d.push(A);var _,x=void 0,S=w(d);try{for(S.s();!(_=S.n()).done;){var E=_.value;if(E.id===h){x=E;break}}}catch(W){S.e(W)}finally{S.f()}x?x.isHole?A.parent=k?x.parent:h:A.parent=k?h:x.parent:A.parent=k?h:0;var M=r(Li,this,$m).call(this,s,e,f,v,y,m,0);if(-1!==M){var C=r(Li,this,hw)._[2*M],T=r(Li,this,hw)._[2*M+1],R=f+C,P=v+T;y=R,m=P;for(var I=f,D=v;;){var L=r(Li,this,tw).call(this,s,e,I,D,y,m,1),O=I+(C=r(Li,this,hw)._[2*L]),F=D+(T=r(Li,this,hw)._[2*L+1]);b.push(F,O);var N=I*e+D;if(0===s[N+1]?s[N]=-c:1===s[N]&&(s[N]=c),O===f&&F===v&&I===R&&D===P){1!==s[p]&&(h=Math.abs(s[p]));break}y=I,m=D,I=O,D=F}}else s[p]=-c,1!==s[p]&&(h=Math.abs(s[p]))}}}return d}function nw(t,e,n,i){if(n-e<=4)for(var a=e;a<n-2;a+=2)i.push(t[a],t[a+1]);else{for(var s=t[e],o=t[e+1],l=t[n-4]-s,u=t[n-3]-o,h=Math.hypot(l,u),c=l/h,d=u/h,f=c*o-d*s,v=u/l,p=1/h,g=Math.atan(v),y=Math.cos(g),m=Math.sin(g),w=p*(Math.abs(y)+Math.abs(m)),b=p*(1-w+Math.pow(w,2)),k=Math.max(Math.atan(Math.abs(m+y)*b),Math.atan(Math.abs(m-y)*b)),A=0,_=e,x=e+2;x<n-2;x+=2){var S=Math.abs(f-c*t[x+1]+d*t[x]);S>A&&(_=x,A=S)}A>Math.pow(h*k,2)?(r(Li,this,nw).call(this,t,e,_+2,i),r(Li,this,nw).call(this,t,_,n,i)):i.push(s,o)}}function iw(t){var e=[],n=t.length;return r(Li,this,nw).call(this,t,0,n,e),e.push(t[n-2],t[n-1]),e.length<=4?null:e}function rw(t,e,n,i,r,a){for(var s=new Float32Array(Math.pow(a,2)),o=-2*Math.pow(i,2),l=a>>1,u=0;u<a;u++)for(var h=Math.pow(u-l,2),c=0;c<a;c++)s[u*a+c]=Math.exp((h+Math.pow(c-l,2))/o);for(var d=new Float32Array(256),f=-2*Math.pow(r,2),v=0;v<256;v++)d[v]=Math.exp(Math.pow(v,2)/f);for(var p=t.length,g=new Uint8Array(p),y=new Uint32Array(256),m=0;m<n;m++)for(var w=0;w<e;w++){for(var b=m*e+w,k=t[b],A=0,_=0,x=0;x<a;x++){var S=m+x-l;if(!(S<0||S>=n))for(var E=0;E<a;E++){var M=w+E-l;if(!(M<0||M>=e)){var C=t[S*e+M],T=s[x*a+E]*d[Math.abs(C-k)];A+=C*T,_+=T}}}y[g[b]=Math.round(A/_)]++}return[g,y]}function aw(t){var e,n=new Uint32Array(256),i=w(t);try{for(i.s();!(e=i.n()).done;){n[e.value]++}}catch(r){i.e(r)}finally{i.f()}return n}function sw(t){for(var e=t.length,n=new Uint8ClampedArray(e>>2),i=-Infinity,r=Infinity,a=0,s=n.length;a<s;a++){var o=n[a]=t[a<<2];i=Math.max(i,o),r=Math.min(r,o)}for(var l=255/(i-r),u=0,h=n.length;u<h;u++)n[u]=(n[u]-r)*l;return n}function ow(t){var e,n=-Infinity,i=-Infinity,r=t.findIndex((function(t){return 0!==t})),a=r,s=r;for(e=r;e<256;e++){var o=t[e];o>n&&(e-a>i&&(i=e-a,s=e-1),n=o,a=e)}for(e=s-1;e>=0&&!(t[e]>t[e+1]);e--);return e}function lw(t){var e=t,n=t,i=n.width,a=n.height,s=r(Li,this,uw)._.maxDim,o=i,l=a;if(i>s||a>s){var u=i,h=a,c=Math.log2(Math.max(i,a)/s),d=Math.floor(c);c=c===d?d-1:d;for(var f=0;f<c;f++){o=Math.ceil(u/2),l=Math.ceil(h/2);var v=new OffscreenCanvas(o,l);v.getContext("2d").drawImage(t,0,0,u,h,0,0,o,l),u=o,h=l,t!==e&&t.close(),t=v.transferToImageBitmap()}var p=Math.min(s/o,s/l);o=Math.round(o*p),l=Math.round(l*p)}var g=new OffscreenCanvas(o,l).getContext("2d",{willReadFrequently:!0});g.fillStyle="white",g.fillRect(0,0,o,l),g.filter="grayscale(1)",g.drawImage(t,0,0,t.width,t.height,0,0,o,l);var y=g.getImageData(0,0,o,l).data;return[r(Li,this,sw).call(this,y),o,l]}Li=Jm;var uw={_:{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}},hw={_:new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1])},cw=function(t){function e(){var t;return c(this,e),L(e,"updateProperties",t=u(this,e),3)([{fill:Xl._defaultLineColor,"stroke-width":0}]),t}return _(e,t),m(e,[{key:"clone",value:function(){var t=new e;return t.updateAll(this),t}}])}(Jy),dw=function(t){function e(t){var n;return c(this,e),L(e,"updateProperties",n=u(this,e,[t]),3)([{stroke:Xl._defaultLineColor,"stroke-width":1}]),n}return _(e,t),m(e,[{key:"clone",value:function(){var t=new e(this._viewParameters);return t.updateAll(this),t}}])}(qm),fw=new WeakMap,vw=new WeakMap,pw=new WeakMap,gw=new WeakMap,yw=function(t){function e(t){var n;return c(this,e),f(n=u(this,e,[C(C({},t),{},{mustBeCommitted:!0,name:"signatureEditor"})]),fw,!1),f(n,vw,null),f(n,pw,null),f(n,gw,null),n._willKeepAspectRatio=!0,v(pw,n,t.signatureData||null),v(vw,n,null),n.defaultL10nId="pdfjs-editor-signature-editor1",n}return _(e,t),m(e,[{key:"telemetryFinalData",get:function(){return{type:"signature",hasDescription:!!d(vw,this)}}},{key:"isResizable",get:function(){return!0}},{key:"onScaleChanging",value:function(){null!==this._drawId&&L(e,"onScaleChanging",this,3)([])}},{key:"render",value:function(){if(this.div)return this.div;var t,n,i=this._isCopy;if(i&&(this._isCopy=!1,t=this.x,n=this.y),L(e,"render",this,3)([]),null===this._drawId)if(d(pw,this)){var r=d(pw,this),a=r.lines,s=r.mustSmooth,o=r.areContours,l=r.description,u=r.uuid,h=r.heightInPage,c=this.parent.viewport,f=c.rawDims,v=f.pageWidth,p=f.pageHeight,g=c.rotation,y=Jm.processDrawnLines({lines:a,pageWidth:v,pageHeight:p,rotation:g,innerMargin:e._INNER_MARGIN,mustSmooth:s,areContours:o});this.addSignature(y,h,l,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:d(vw,this)||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,n)),this.div}},{key:"setUuid",value:function(t){v(gw,this,t),this.addEditToolbar()}},{key:"getUuid",value:function(){return d(gw,this)}},{key:"description",get:function(){return d(vw,this)},set:function(t){v(vw,this,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),L(e,"addEditToolbar",this,3)([]).then((function(e){null==e||e.updateEditSignatureButton(t)})))}},{key:"getSignaturePreview",value:function(){var t=d(pw,this),e=t.newCurves,n=t.areContours,i=t.thickness,r=t.width,a=t.height,s=Math.max(r,a);return{areContours:n,outline:Jm.processDrawnLines({lines:{curves:e.map((function(t){return{points:t}})),thickness:i,width:r,height:a},pageWidth:s,pageHeight:s,rotation:0,innerMargin:0,mustSmooth:!1,areContours:n}).outline}}},{key:"toolbarButtons",get:function(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:L(e,"toolbarButtons",this,1)}},{key:"addSignature",value:function(t,n,i,r){var a,s=this.x,o=this.y,l=v(pw,this,t).outline;v(fw,this,l instanceof Qm),this.description=i,d(fw,this)?a=e.getDefaultDrawingOptions():(a=e._defaultDrawnSignatureOptions.clone()).updateProperties({"stroke-width":l.thickness}),this._addOutlines({drawOutlines:l,drawingOptions:a});var u=D(this.parentDimensions,2),h=u[0],c=u[1],f=n/D(this.pageDimensions,2)[1];f=f>=1?.5:f,this.width*=f/this.height,this.width>=1&&(f*=.9/this.width,this.width=.9),this.height=f,this.setDims(h*this.width,c*this.height),this.x=s,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!i}}),this.div.hidden=!1}},{key:"getFromImage",value:function(t){var n=this.parent.viewport,i=n.rawDims,r=i.pageWidth,a=i.pageHeight,s=n.rotation;return Jm.process(t,r,a,s,e._INNER_MARGIN)}},{key:"getFromText",value:function(t,n){var i=this.parent.viewport,r=i.rawDims,a=r.pageWidth,s=r.pageHeight,o=i.rotation;return Jm.extractContoursFromText(t,n,a,s,o,e._INNER_MARGIN)}},{key:"getDrawnSignature",value:function(t){var n=this.parent.viewport,i=n.rawDims,r=i.pageWidth,a=i.pageHeight,s=n.rotation;return Jm.processDrawnLines({lines:t,pageWidth:r,pageHeight:a,rotation:s,innerMargin:e._INNER_MARGIN,mustSmooth:!1,areContours:!1})}},{key:"createDrawingOptions",value:function(t){var n=t.areContours,i=t.thickness;n?this._drawingOptions=e.getDefaultDrawingOptions():(this._drawingOptions=e._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}},{key:"serialize",value:function(){var t=arguments.length>0&&arguments[0]!==undefined&&arguments[0];if(this.isEmpty())return null;var e=this.serializeDraw(t),n=e.lines,i=e.points,r=e.rect,a=this._drawingOptions["stroke-width"],s={annotationType:ir.SIGNATURE,isSignature:!0,areContours:d(fw,this),color:[0,0,0],thickness:d(fw,this)?0:a,pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(s),t?(s.paths={lines:n,points:i},s.uuid=d(gw,this),s.isCopy=!0):s.lines=n,d(vw,this)&&(s.accessibilityData={type:"Figure",alt:d(vw,this)}),s}}],[{key:"initialize",value:function(t,e){Xl.initialize(t,e),this._defaultDrawingOptions=new cw,this._defaultDrawnSignatureOptions=new dw(e.viewParameters)}},{key:"getDefaultDrawingOptions",value:function(t){var e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}},{key:"supportMultipleDrawings",get:function(){return!1}},{key:"typesMap",get:function(){return Or(this,"typesMap",new Map)}},{key:"isDrawer",get:function(){return!1}},{key:"computeTelemetryFinalData",value:function(t){var e,n,i=t.get("hasDescription");return{hasAltText:null!==(e=i.get(!0))&&void 0!==e?e:0,hasNoAltText:null!==(n=i.get(!1))&&void 0!==n?n:0}}},{key:"deserializeDraw",value:function(t,e,n,i,r,a){return a.areContours?Qm.deserialize(t,e,n,i,r,a):Hm.deserialize(t,e,n,i,r,a)}},{key:"deserialize",value:(n=l(T().m((function i(t,n,r){var a,s;return T().w((function(i){for(;;)switch(i.n){case 0:return i.n=1,L(e,"deserialize",this,2)([t,n,r]);case 1:return s=i.v,v(fw,s,t.areContours),s.description=(null===(a=t.accessibilityData)||void 0===a?void 0:a.alt)||"",v(gw,s,t.uuid),i.a(2,s)}}),i,this)}))),function(t,e,i){return n.apply(this,arguments)})}]);var n}(em);b(yw,"_type","signature"),b(yw,"_editorType",ir.SIGNATURE),b(yw,"_defaultDrawingOptions",null);var mw=new WeakMap,ww=new WeakMap,bw=new WeakMap,kw=new WeakMap,Aw=new WeakMap,_w=new WeakMap,xw=new WeakMap,Sw=new WeakMap,Ew=new WeakMap,Mw=new WeakMap,Cw=new WeakMap,Tw=new WeakSet,Rw=function(t){function e(t){var n;return c(this,e),g(n=u(this,e,[C(C({},t),{},{name:"stampEditor"})]),Tw),f(n,mw,null),f(n,ww,null),f(n,bw,null),f(n,kw,null),f(n,Aw,null),f(n,_w,""),f(n,xw,null),f(n,Sw,!1),f(n,Ew,null),f(n,Mw,!1),f(n,Cw,!1),v(kw,n,t.bitmapUrl),v(Aw,n,t.bitmapFile),n.defaultL10nId="pdfjs-editor-stamp-editor",n}return _(e,t),m(e,[{key:"altTextFinish",value:function(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),L(e,"altTextFinish",this,3)([])}},{key:"telemetryFinalData",get:function(){var t;return{type:"stamp",hasAltText:!(null===(t=this.altTextData)||void 0===t||!t.altText)}}},{key:"mlGuessAltText",value:(i=l(T().m((function a(){var t,e,n,i,r,s,o,l,u,h=arguments;return T().w((function(a){for(;;)switch(a.n){case 0:if(t=h.length>0&&h[0]!==undefined?h[0]:null,e=!(h.length>1&&h[1]!==undefined)||h[1],!this.hasAltTextData()){a.n=1;break}return a.a(2,null);case 1:if(n=this._uiManager.mlManager){a.n=2;break}throw new Error("No ML.");case 2:return a.n=3,n.isEnabledFor("altText");case 3:if(a.v){a.n=4;break}throw new Error("ML isn't enabled for alt text.");case 4:return i=t||this.copyCanvas(null,null,!0).imageData,r=i.data,s=i.width,o=i.height,a.n=5,n.guess({name:"altText",request:{data:r,width:s,height:o,channels:r.length/(s*o)}});case 5:if(l=a.v){a.n=6;break}throw new Error("No response from the AI service.");case 6:if(!l.error){a.n=7;break}throw new Error("Error from the AI service.");case 7:if(!l.cancel){a.n=8;break}return a.a(2,null);case 8:if(l.output){a.n=9;break}throw new Error("No valid response from the AI service.");case 9:return u=l.output,a.n=10,this.setGuessedAltText(u);case 10:return e&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),a.a(2,u)}}),a,this)}))),function(){return i.apply(this,arguments)})},{key:"remove",value:function(){var t;d(ww,this)&&(v(mw,this,null),this._uiManager.imageManager.deleteId(d(ww,this)),null===(t=d(xw,this))||void 0===t||t.remove(),v(xw,this,null),d(Ew,this)&&(clearTimeout(d(Ew,this)),v(Ew,this,null)));L(e,"remove",this,3)([])}},{key:"rebuild",value:function(){this.parent?(L(e,"rebuild",this,3)([]),null!==this.div&&(d(ww,this)&&null===d(xw,this)&&r(Tw,this,Dw).call(this),this.isAttachedToDOM||this.parent.add(this))):d(ww,this)&&r(Tw,this,Dw).call(this)}},{key:"onceAdded",value:function(t){this._isDraggable=!0,t&&this.div.focus()}},{key:"isEmpty",value:function(){return!(d(bw,this)||d(mw,this)||d(kw,this)||d(Aw,this)||d(ww,this)||d(Sw,this))}},{key:"toolbarButtons",get:function(){return[["altText",this.createAltText()]]}},{key:"isResizable",get:function(){return!0}},{key:"render",value:function(){return this.div||(this._isCopy&&(t=this.x,n=this.y),L(e,"render",this,3)([]),this.div.hidden=!0,this.createAltText(),d(Sw,this)||(d(mw,this)?r(Tw,this,Lw).call(this):r(Tw,this,Dw).call(this)),this._isCopy&&this._moveAfterPaste(t,n),this._uiManager.addShouldRescale(this)),this.div;var t,n}},{key:"setCanvas",value:function(t,e){var n=this._uiManager.imageManager.getFromCanvas(t,e),i=n.id,a=n.bitmap;e.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(v(ww,this,i),a&&v(mw,this,a),v(Sw,this,!1),r(Tw,this,Lw).call(this))}},{key:"_onResized",value:function(){this.onScaleChanging()}},{key:"onScaleChanging",value:function(){var t=this;if(this.parent){null!==d(Ew,this)&&clearTimeout(d(Ew,this));v(Ew,this,setTimeout((function(){v(Ew,t,null),r(Tw,t,Fw).call(t)}),200))}}},{key:"copyCanvas",value:function(t,e){var n=arguments.length>2&&arguments[2]!==undefined&&arguments[2];t||(t=224);var i=d(mw,this),a=i.width,s=i.height,o=new xa,l=d(mw,this),u=a,h=s,c=null;if(e){var f,v;if(a>e||s>e){var p=Math.min(e/a,e/s);u=Math.floor(a*p),h=Math.floor(s*p)}var g=(c=document.createElement("canvas")).width=Math.ceil(u*o.sx),y=c.height=Math.ceil(h*o.sy);d(Mw,this)||(l=r(Tw,this,Ow).call(this,g,y));var m=c.getContext("2d");m.filter=this._uiManager.hcmFilter;var w="white",b="#cfcfd8";"none"!==this._uiManager.hcmFilter?b="black":null!==(f=(v=window).matchMedia)&&void 0!==f&&f.call(v,"(prefers-color-scheme: dark)").matches&&(w="#8f8f9d",b="#42414d");var k=15*o.sx,A=15*o.sy,_=new OffscreenCanvas(2*k,2*A),x=_.getContext("2d");x.fillStyle=w,x.fillRect(0,0,2*k,2*A),x.fillStyle=b,x.fillRect(0,0,k,A),x.fillRect(k,A,k,A),m.fillStyle=m.createPattern(_,"repeat"),m.fillRect(0,0,g,y),m.drawImage(l,0,0,l.width,l.height,0,0,g,y)}var S=null;if(n){var E,M;if(o.symmetric&&l.width<t&&l.height<t)E=l.width,M=l.height;else if(l=d(mw,this),a>t||s>t){var C=Math.min(t/a,t/s);E=Math.floor(a*C),M=Math.floor(s*C),d(Mw,this)||(l=r(Tw,this,Ow).call(this,E,M))}var T=new OffscreenCanvas(E,M).getContext("2d",{willReadFrequently:!0});T.drawImage(l,0,0,l.width,l.height,0,0,E,M),S={width:E,height:M,data:T.getImageData(0,0,E,M).data}}return{canvas:c,width:u,height:h,imageData:S}}},{key:"serialize",value:function(){var t=arguments.length>0&&arguments[0]!==undefined&&arguments[0],e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();var n={annotationType:ir.STAMP,bitmapId:d(ww,this),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:d(Mw,this),structTreeParentId:this._structTreeParentId};if(this.addComment(n),t)return n.bitmapUrl=r(Tw,this,Nw).call(this,!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;var i=this.serializeAltText(!1),a=i.decorative,s=i.altText;if(!a&&s&&(n.accessibilityData={type:"Figure",alt:s}),this.annotationElementId){var o,l=r(Tw,this,Ww).call(this,n);if(l.isSame)return null;if(l.isSameAltText)delete n.accessibilityData;else n.accessibilityData.structParent=null!==(o=this._initialData.structParent)&&void 0!==o?o:-1}if(n.id=this.annotationElementId,null===e)return n;e.stamps||(e.stamps=new Map);var u=d(Mw,this)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(e.stamps.has(d(ww,this))){if(d(Mw,this)){var h=e.stamps.get(d(ww,this));u>h.area&&(h.area=u,h.serialized.bitmap.close(),h.serialized.bitmap=r(Tw,this,Nw).call(this,!1))}}else e.stamps.set(d(ww,this),{area:u,serialized:n}),n.bitmap=r(Tw,this,Nw).call(this,!1);return n}},{key:"renderAnnotationElement",value:function(t){var e={rect:this.getRect(0,0)};return this.hasEditedComment&&(e.popup=this.comment),t.updateEdited(e),null}}],[{key:"initialize",value:function(t,e){Xl.initialize(t,e)}},{key:"isHandlingMimeForPasting",value:function(t){return Sa.includes(t)}},{key:"paste",value:function(t,e){e.pasteEditor({mode:ir.STAMP},{bitmapFile:t.getAsFile()})}},{key:"computeTelemetryFinalData",value:function(t){var e,n,i=t.get("hasAltText");return{hasAltText:null!==(e=i.get(!0))&&void 0!==e?e:0,hasNoAltText:null!==(n=i.get(!1))&&void 0!==n?n:0}}},{key:"deserialize",value:(n=l(T().m((function s(t,n,i){var r,a,o,l,u,h,c,d,f,p,g,y,m,w,b,k,A,_,x,S,E,M,C,R,P,I,O,F,N,W,B,j,H;return T().w((function(s){for(;;)switch(s.n){case 0:if(r=null,a=!1,!(t instanceof jp)){s.n=6;break}return u=(l=t).data,h=u.rect,c=u.rotation,d=u.id,f=u.structParent,p=u.popupRef,g=u.contentsObj,y=l.container,m=l.parent.page.pageNumber,(w=l.canvas)?(delete t.canvas,A=i.imageManager.getFromCanvas(y.id,w),b=A.id,k=A.bitmap,w.remove()):(a=!0,t._hasNoCanvas=!0),s.n=1,n._structTree.getAriaAttributes("".concat(ta).concat(d));case 1:if(j=o=s.v,B=null===j){s.n=2;break}B=void 0===o;case 2:if(!B){s.n=3;break}H=void 0,s.n=4;break;case 3:H=o.get("aria-label");case 4:if(W=H){s.n=5;break}W="";case 5:_=W,r=t={annotationType:ir.STAMP,bitmapId:b,bitmap:k,pageIndex:m-1,rect:h.slice(0),rotation:c,annotationElementId:d,id:d,deleted:!1,accessibilityData:{decorative:!1,altText:_},isSvg:!1,structParent:f,popupRef:p,comment:(null==g?void 0:g.str)||null};case 6:return s.n=7,L(e,"deserialize",this,2)([t,n,i]);case 7:return x=s.v,E=(S=t).rect,M=S.bitmap,C=S.bitmapUrl,R=S.bitmapId,P=S.isSvg,I=S.accessibilityData,a?(i.addMissingCanvas(t.id,x),v(Sw,x,!0)):R&&i.imageManager.isValidId(R)?(v(ww,x,R),M&&v(mw,x,M)):v(kw,x,C),v(Mw,x,P),O=D(x.pageDimensions,2),F=O[0],N=O[1],x.width=(E[2]-E[0])/F,x.height=(E[3]-E[1])/N,I&&(x.altTextData=I),x._initialData=r,t.comment&&x.setCommentData(t.comment),v(Cw,x,!!r),s.a(2,x)}}),s,this)}))),function(t,e,i){return n.apply(this,arguments)})}]);var n,i}(Xl);function Pw(t){var e=arguments.length>1&&arguments[1]!==undefined&&arguments[1];t?(v(mw,this,t.bitmap),e||(v(ww,this,t.id),v(Mw,this,t.isSvg)),t.file&&v(_w,this,t.file.name),r(Tw,this,Lw).call(this)):this.remove()}function Iw(){var t=this;if(v(bw,this,null),this._uiManager.enableWaiting(!1),d(xw,this))if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&d(mw,this))this.addEditToolbar().then((function(){t._editToolbar.hide(),t._uiManager.editAltText(t,!0)}));else{if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&d(mw,this)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch(e){}}this.div.focus()}}function Dw(){var t=this;if(d(ww,this))return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId(d(ww,this)).then((function(e){return r(Tw,t,Pw).call(t,e,!0)}))["finally"]((function(){return r(Tw,t,Iw).call(t)}));if(d(kw,this)){var e=d(kw,this);return v(kw,this,null),this._uiManager.enableWaiting(!0),void v(bw,this,this._uiManager.imageManager.getFromUrl(e).then((function(e){return r(Tw,t,Pw).call(t,e)}))["finally"]((function(){return r(Tw,t,Iw).call(t)})))}if(d(Aw,this)){var n=d(Aw,this);return v(Aw,this,null),this._uiManager.enableWaiting(!0),void v(bw,this,this._uiManager.imageManager.getFromFile(n).then((function(e){return r(Tw,t,Pw).call(t,e)}))["finally"]((function(){return r(Tw,t,Iw).call(t)})))}var i=document.createElement("input");i.type="file",i.accept=Sa.join(",");var a=this._uiManager._signal;v(bw,this,new Promise((function(e){i.addEventListener("change",l(T().m((function n(){var a;return T().w((function(n){for(;;)switch(n.n){case 0:if(i.files&&0!==i.files.length){n.n=1;break}t.remove(),n.n=3;break;case 1:return t._uiManager.enableWaiting(!0),n.n=2,t._uiManager.imageManager.getFromFile(i.files[0]);case 2:a=n.v,t._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:t._uiManager.useNewAltTextFlow}}),r(Tw,t,Pw).call(t,a);case 3:e();case 4:return n.a(2)}}),n)}))),{signal:a}),i.addEventListener("cancel",(function(){t.remove(),e()}),{signal:a})}))["finally"]((function(){return r(Tw,t,Iw).call(t)}))),i.click()}function Lw(){var t,e=this.div,n=d(mw,this),i=n.width,a=n.height,s=D(this.pageDimensions,2),o=s[0],l=s[1],u=.75;if(this.width)i=this.width*o,a=this.height*l;else if(i>u*o||a>u*l){var h=Math.min(u*o/i,u*l/a);i*=h,a*=h}var c=D(this.parentDimensions,2),f=c[0],p=c[1];this.setDims(i*f/o,a*p/l),this._uiManager.enableWaiting(!1);var g=v(xw,this,document.createElement("canvas"));g.setAttribute("role","img"),this.addContainer(g),this.width=i/o,this.height=a/l,null!==(t=this._initialOptions)&&void 0!==t&&t.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&!this.annotationElementId||(e.hidden=!1),r(Tw,this,Fw).call(this),d(Cw,this)||(this.parent.addUndoableEditor(this),v(Cw,this,!0)),this._reportTelemetry({action:"inserted_image"}),d(_w,this)&&this.div.setAttribute("aria-description",d(_w,this)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}function Ow(t,e){for(var n=d(mw,this),i=n.width,r=n.height,a=d(mw,this);i>2*t||r>2*e;){var s=i,o=r;i>2*t&&(i=i>=16384?Math.floor(i/2)-1:Math.ceil(i/2)),r>2*e&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2));var l=new OffscreenCanvas(i,r);l.getContext("2d").drawImage(a,0,0,s,o,0,0,i,r),a=l.transferToImageBitmap()}return a}function Fw(){var t=D(this.parentDimensions,2),e=t[0],n=t[1],i=this.width,a=this.height,s=new xa,o=Math.ceil(i*e*s.sx),l=Math.ceil(a*n*s.sy),u=d(xw,this);if(u&&(u.width!==o||u.height!==l)){u.width=o,u.height=l;var h=d(Mw,this)?d(mw,this):r(Tw,this,Ow).call(this,o,l),c=u.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(h,0,0,h.width,h.height,0,0,o,l)}}function Nw(t){if(t){if(d(Mw,this)){var e=this._uiManager.imageManager.getSvgUrl(d(ww,this));if(e)return e}var n=document.createElement("canvas"),i=d(mw,this);return n.width=i.width,n.height=i.height,n.getContext("2d").drawImage(d(mw,this),0,0),n.toDataURL()}if(d(Mw,this)){var r=D(this.pageDimensions,2),a=r[0],s=r[1],o=Math.round(this.width*a*ra.PDF_TO_CSS_UNITS),l=Math.round(this.height*s*ra.PDF_TO_CSS_UNITS),u=new OffscreenCanvas(o,l);return u.getContext("2d").drawImage(d(mw,this),0,0,d(mw,this).width,d(mw,this).height,0,0,o,l),u.transferToImageBitmap()}return structuredClone(d(mw,this))}function Ww(t){var e,n=this._initialData,i=n.pageIndex,r=n.accessibilityData.altText,a=t.pageIndex===i,s=((null===(e=t.accessibilityData)||void 0===e?void 0:e.alt)||"")===r;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&a&&s,isSameAltText:s}}b(Rw,"_type","stamp"),b(Rw,"_editorType",ir.STAMP);var Bw=new WeakMap,jw=new WeakMap,Hw=new WeakMap,Uw=new WeakMap,zw=new WeakMap,Gw=new WeakMap,Vw=new WeakMap,qw=new WeakMap,Xw=new WeakMap,Yw=new WeakMap,Kw=new WeakMap,Qw=new WeakMap,Jw=new WeakMap,Zw=new WeakMap,$w=new WeakMap,tb=new WeakMap,eb=new WeakSet,nb=function(){return m((function i(t){var e=t.uiManager,n=t.pageIndex,r=t.div,a=t.structTreeLayer,s=t.accessibilityManager,o=t.annotationLayer,l=t.drawLayer,u=t.textLayer,h=t.viewport,p=t.l10n;c(this,i),g(this,eb),f(this,Bw,void 0),f(this,jw,!1),f(this,Hw,null),f(this,Uw,null),f(this,zw,null),f(this,Gw,new Map),f(this,Vw,!1),f(this,qw,!1),f(this,Xw,!1),f(this,Yw,null),f(this,Kw,null),f(this,Qw,null),f(this,Jw,null),f(this,Zw,null),f(this,$w,-1),f(this,tb,void 0);var y=F(lb._.values());if(!i._initialized){i._initialized=!0;var m,b=w(y);try{for(b.s();!(m=b.n()).done;){m.value.initialize(p,e)}}catch(k){b.e(k)}finally{b.f()}}e.registerEditorTypes(y),v(tb,this,e),this.pageIndex=n,this.div=r,v(Bw,this,s),v(Hw,this,o),this.viewport=h,v(Qw,this,u),this.drawLayer=l,this._structTree=a,d(tb,this).addLayer(this)}),[{key:"isEmpty",get:function(){return 0===d(Gw,this).size}},{key:"isInvisible",get:function(){return this.isEmpty&&d(tb,this).getMode()===ir.NONE}},{key:"updateToolbar",value:function(t){d(tb,this).updateToolbar(t)}},{key:"updateMode",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:d(tb,this).getMode();switch(r(eb,this,ob).call(this),t){case ir.NONE:return this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),void this.disableClick();case ir.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ir.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);var e,n=this.div.classList,i=w(lb._.values());try{for(i.s();!(e=i.n()).done;){var a=e.value;n.toggle("".concat(a._type,"Editing"),t===a._editorType)}}catch(s){i.e(s)}finally{i.f()}this.div.hidden=!1}},{key:"hasTextLayer",value:function(t){var e;return t===(null===(e=d(Qw,this))||void 0===e?void 0:e.div)}},{key:"setEditingState",value:function(t){d(tb,this).setEditingState(t)}},{key:"addCommands",value:function(t){d(tb,this).addCommands(t)}},{key:"cleanUndoStack",value:function(t){d(tb,this).cleanUndoStack(t)}},{key:"toggleDrawing",value:function(){var t=arguments.length>0&&arguments[0]!==undefined&&arguments[0];this.div.classList.toggle("drawing",!t)}},{key:"togglePointerEvents",value:function(){var t=arguments.length>0&&arguments[0]!==undefined&&arguments[0];this.div.classList.toggle("disabled",!t)}},{key:"toggleAnnotationLayerPointerEvents",value:function(){var t,e=arguments.length>0&&arguments[0]!==undefined&&arguments[0];null===(t=d(Hw,this))||void 0===t||t.div.classList.toggle("disabled",!e)}},{key:"enable",value:(n=l(T().m((function a(){var t,e,n,i,r,s,o,l,u,h,c;return T().w((function(a){for(;;)switch(a.p=a.n){case 0:v(Xw,this,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),null===(t=d(Zw,this))||void 0===t||t.abort(),v(Zw,this,null),e=new Set,n=w(d(Gw,this).values());try{for(n.s();!(i=n.n()).done;)(r=i.value).enableEditing(),r.show(!0),r.annotationElementId&&(d(tb,this).removeChangedExistingAnnotation(r),e.add(r.annotationElementId))}catch(f){n.e(f)}finally{n.f()}if(d(Hw,this)){a.n=1;break}return v(Xw,this,!1),a.a(2);case 1:s=d(Hw,this).getEditableAnnotations(),o=w(s),a.p=2,o.s();case 3:if((l=o.n()).done){a.n=9;break}if((u=l.value).hide(),!d(tb,this).isDeletedAnnotationElement(u.data.id)){a.n=4;break}return a.a(3,8);case 4:if(!e.has(u.data.id)){a.n=5;break}return a.a(3,8);case 5:return a.n=6,this.deserialize(u);case 6:if(h=a.v){a.n=7;break}return a.a(3,8);case 7:this.addOrRebuild(h),h.enableEditing();case 8:a.n=3;break;case 9:a.n=11;break;case 10:a.p=10,c=a.v,o.e(c);case 11:return a.p=11,o.f(),a.f(11);case 12:v(Xw,this,!1);case 13:return a.a(2)}}),a,this,[[2,10,11,12]])}))),function(){return n.apply(this,arguments)})},{key:"disable",value:function(){var t=this;if(v(qw,this,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),d(Qw,this)&&!d(Zw,this)){v(Zw,this,new AbortController);var e=d(tb,this).combinedSignal(d(Zw,this));d(Qw,this).div.addEventListener("pointerdown",(function(e){var n=e.clientX,i=e.clientY,r=e.timeStamp;if(r-d($w,t)>500)v($w,t,r);else{v($w,t,-1);var a=t.div.classList;a.toggle("getElements",!0);var s=document.elementsFromPoint(n,i);if(a.toggle("getElements",!1),t.div.contains(s[0])){var o,l,u=new RegExp("^".concat(nr,"[0-9]+$")),h=w(s);try{for(h.s();!(l=h.n()).done;){var c=l.value;if(u.test(c.id)){o=c.id;break}}}catch(p){h.e(p)}finally{h.f()}if(o){var f=d(Gw,t).get(o);null===(null==f?void 0:f.annotationElementId)&&(e.stopPropagation(),e.preventDefault(),f.dblclick())}}}}),{signal:e,capture:!0})}var n,i=new Map,a=new Map,s=w(d(Gw,this).values());try{for(s.s();!(n=s.n()).done;){var o,l=n.value;l.disableEditing(),l.annotationElementId&&(null===l.serialize()?(a.set(l.annotationElementId,l),null===(o=this.getEditableAnnotation(l.annotationElementId))||void 0===o||o.show(),l.remove()):i.set(l.annotationElementId,l))}}catch(k){s.e(k)}finally{s.f()}if(d(Hw,this)){var u,h=w(d(Hw,this).getEditableAnnotations());try{for(h.s();!(u=h.n()).done;){var c=u.value,f=c.data.id;if(d(tb,this).isDeletedAnnotationElement(f))c.updateEdited({deleted:!0});else{var p=a.get(f);p?(p.resetAnnotationElement(c),p.show(!1),c.show()):((p=i.get(f))&&(d(tb,this).addChangedExistingAnnotation(p),p.renderAnnotationElement(c)&&p.show(!1)),c.show())}}}catch(k){h.e(k)}finally{h.f()}}r(eb,this,ob).call(this),this.isEmpty&&(this.div.hidden=!0);var g,y=this.div.classList,m=w(lb._.values());try{for(m.s();!(g=m.n()).done;){var b=g.value;y.remove("".concat(b._type,"Editing"))}}catch(k){m.e(k)}finally{m.f()}this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),v(qw,this,!1)}},{key:"getEditableAnnotation",value:function(t){var e;return(null===(e=d(Hw,this))||void 0===e?void 0:e.getEditableAnnotation(t))||null}},{key:"setActiveEditor",value:function(t){d(tb,this).getActive()!==t&&d(tb,this).setActiveEditor(t)}},{key:"enableTextSelection",value:function(){var t;if(this.div.tabIndex=-1,null!==(t=d(Qw,this))&&void 0!==t&&t.div&&!d(Jw,this)){v(Jw,this,new AbortController);var e=d(tb,this).combinedSignal(d(Jw,this));d(Qw,this).div.addEventListener("pointerdown",r(eb,this,ib).bind(this),{signal:e}),d(Qw,this).div.classList.add("highlighting")}}},{key:"disableTextSelection",value:function(){var t;this.div.tabIndex=0,null!==(t=d(Qw,this))&&void 0!==t&&t.div&&d(Jw,this)&&(d(Jw,this).abort(),v(Jw,this,null),d(Qw,this).div.classList.remove("highlighting"))}},{key:"enableClick",value:function(){if(!d(Uw,this)){v(Uw,this,new AbortController);var t=d(tb,this).combinedSignal(d(Uw,this));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});var e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}}},{key:"disableClick",value:function(){var t;null===(t=d(Uw,this))||void 0===t||t.abort(),v(Uw,this,null)}},{key:"attach",value:function(t){d(Gw,this).set(t.id,t);var e=t.annotationElementId;e&&d(tb,this).isDeletedAnnotationElement(e)&&d(tb,this).removeDeletedAnnotationElement(t)}},{key:"detach",value:function(t){var e;d(Gw,this)["delete"](t.id),null===(e=d(Bw,this))||void 0===e||e.removePointerInTextLayer(t.contentDiv),!d(qw,this)&&t.annotationElementId&&d(tb,this).addDeletedAnnotationElement(t)}},{key:"remove",value:function(t){this.detach(t),d(tb,this).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}},{key:"changeParent",value:function(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(d(tb,this).addDeletedAnnotationElement(t.annotationElementId),Xl.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),null===(e=t.parent)||void 0===e||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}},{key:"add",value:function(t){if(t.parent!==this||!t.isAttachedToDOM){if(this.changeParent(t),d(tb,this).addEditor(t),this.attach(t),!t.isAttachedToDOM){var e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!d(Xw,this)),d(tb,this).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}},{key:"moveEditorInDOM",value:function(t){var e,n=this;if(t.isAttachedToDOM){var i=document.activeElement;t.div.contains(i)&&!d(zw,this)&&(t._focusEventsAllowed=!1,v(zw,this,setTimeout((function(){v(zw,n,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",(function(){t._focusEventsAllowed=!0}),{once:!0,signal:d(tb,n)._signal}),i.focus())}),0))),t._structTreeParentId=null===(e=d(Bw,this))||void 0===e?void 0:e.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}}},{key:"addOrRebuild",value:function(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}},{key:"addUndoableEditor",value:function(t){this.addCommands({cmd:function(){return t._uiManager.rebuild(t)},undo:function(){t.remove()},mustExec:!1})}},{key:"getNextId",value:function(){return d(tb,this).getId()}},{key:"combinedSignal",value:function(t){return d(tb,this).combinedSignal(t)}},{key:"canCreateNewEmptyEditor",value:function(){var t;return null===(t=p(eb,this,rb))||void 0===t?void 0:t.canCreateNewEmptyEditor()}},{key:"pasteEditor",value:(e=l(T().m((function s(t,e){var n,i,a,o,l;return T().w((function(s){for(;;)switch(s.n){case 0:return this.updateToolbar(t),s.n=1,d(tb,this).updateMode(t.mode);case 1:n=r(eb,this,sb).call(this),i=n.offsetX,a=n.offsetY,o=this.getNextId(),(l=r(eb,this,ab).call(this,C({parent:this,id:o,x:i,y:a,uiManager:d(tb,this),isCentered:!0},e)))&&this.add(l);case 2:return s.a(2)}}),s,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"deserialize",value:(t=l(T().m((function o(t){var e,n,i;return T().w((function(r){for(;;)switch(r.n){case 0:return r.n=1,null===(e=lb._.get(null!==(n=t.annotationType)&&void 0!==n?n:t.annotationEditorType))||void 0===e?void 0:e.deserialize(t,this,d(tb,this));case 1:if(i=r.v){r.n=2;break}i=null;case 2:return r.a(2,i)}}),o,this)}))),function(e){return t.apply(this,arguments)})},{key:"createAndAddNewEditor",value:function(t,e){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},i=this.getNextId(),a=r(eb,this,ab).call(this,C({parent:this,id:i,x:t.offsetX,y:t.offsetY,uiManager:d(tb,this),isCentered:e},n));return a&&this.add(a),a}},{key:"addNewEditor",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.createAndAddNewEditor(r(eb,this,sb).call(this),!0,t)}},{key:"setSelected",value:function(t){d(tb,this).setSelected(t)}},{key:"toggleSelected",value:function(t){d(tb,this).toggleSelected(t)}},{key:"unselect",value:function(t){d(tb,this).unselect(t)}},{key:"pointerup",value:function(t){var e,n=Vr.platform.isMac;if(!(0!==t.button||t.ctrlKey&&n)&&t.target===this.div&&d(Vw,this)&&(v(Vw,this,!1),null===(e=p(eb,this,rb))||void 0===e||!e.isDrawer||!p(eb,this,rb).supportMultipleDrawings))if(d(jw,this)){var i=d(tb,this).getMode();i!==ir.STAMP&&i!==ir.SIGNATURE?this.createAndAddNewEditor(t,!1):d(tb,this).unselectAll()}else v(jw,this,!0)}},{key:"pointerdown",value:function(t){var e;if(d(tb,this).getMode()===ir.HIGHLIGHT&&this.enableTextSelection(),d(Vw,this))v(Vw,this,!1);else{var n=Vr.platform.isMac;if(!(0!==t.button||t.ctrlKey&&n)&&t.target===this.div)if(v(Vw,this,!0),null!==(e=p(eb,this,rb))&&void 0!==e&&e.isDrawer)this.startDrawingSession(t);else{var i=d(tb,this).getActive();v(jw,this,!i||i.isEmpty())}}}},{key:"startDrawingSession",value:function(t){var e=this;if(this.div.focus({preventScroll:!0}),d(Yw,this))p(eb,this,rb).startDrawing(this,d(tb,this),!1,t);else{d(tb,this).setCurrentDrawingSession(this),v(Yw,this,new AbortController);var n=d(tb,this).combinedSignal(d(Yw,this));this.div.addEventListener("blur",(function(t){var n=t.relatedTarget;n&&!e.div.contains(n)&&(v(Kw,e,null),e.commitOrRemove())}),{signal:n}),p(eb,this,rb).startDrawing(this,d(tb,this),!1,t)}}},{key:"pause",value:function(t){var e=this;if(t){var n=document.activeElement;this.div.contains(n)&&v(Kw,this,n)}else d(Kw,this)&&setTimeout((function(){var t;null===(t=d(Kw,e))||void 0===t||t.focus(),v(Kw,e,null)}),0)}},{key:"endDrawingSession",value:function(){var t=arguments.length>0&&arguments[0]!==undefined&&arguments[0];return d(Yw,this)?(d(tb,this).setCurrentDrawingSession(null),d(Yw,this).abort(),v(Yw,this,null),v(Kw,this,null),p(eb,this,rb).endDrawing(t)):null}},{key:"findNewParent",value:function(t,e,n){var i=d(tb,this).findParent(e,n);return null!==i&&i!==this&&(i.changeParent(t),!0)}},{key:"commitOrRemove",value:function(){return!!d(Yw,this)&&(this.endDrawingSession(),!0)}},{key:"onScaleChanging",value:function(){d(Yw,this)&&p(eb,this,rb).onScaleChangingWhenDrawing(this)}},{key:"destroy",value:function(){var t;this.commitOrRemove(),(null===(t=d(tb,this).getActive())||void 0===t?void 0:t.parent)===this&&(d(tb,this).commitOrRemove(),d(tb,this).setActiveEditor(null)),d(zw,this)&&(clearTimeout(d(zw,this)),v(zw,this,null));var e,n=w(d(Gw,this).values());try{for(n.s();!(e=n.n()).done;){var i,r=e.value;null===(i=d(Bw,this))||void 0===i||i.removePointerInTextLayer(r.contentDiv),r.setParent(null),r.isAttachedToDOM=!1,r.div.remove()}}catch(a){n.e(a)}finally{n.f()}this.div=null,d(Gw,this).clear(),d(tb,this).removeLayer(this)}},{key:"render",value:function(t){var e=t.viewport;this.viewport=e,_a(this.div,e);var n,i=w(d(tb,this).getEditors(this.pageIndex));try{for(i.s();!(n=i.n()).done;){var r=n.value;this.add(r),r.rebuild()}}catch(a){i.e(a)}finally{i.f()}this.updateMode()}},{key:"update",value:function(t){var e=t.viewport;d(tb,this).commitOrRemove(),r(eb,this,ob).call(this);var n=this.viewport.rotation,i=e.rotation;if(this.viewport=e,_a(this.div,{rotation:i}),n!==i){var a,s=w(d(Gw,this).values());try{for(s.s();!(a=s.n()).done;){a.value.rotate(i)}}catch(o){s.e(o)}finally{s.f()}}}},{key:"pageDimensions",get:function(){var t=this.viewport.rawDims;return[t.pageWidth,t.pageHeight]}},{key:"scale",get:function(){return d(tb,this).viewParameters.realScale}}]);var t,e,n}();function ib(t){var e=this;d(tb,this).unselectAll();var n=t.target;if(n===d(Qw,this).div||("img"===n.getAttribute("role")||n.classList.contains("endOfContent"))&&d(Qw,this).div.contains(n)){var i=Vr.platform.isMac;if(0!==t.button||t.ctrlKey&&i)return;d(tb,this).showAllEditors("highlight",!0,!0),d(Qw,this).div.classList.add("free"),this.toggleDrawing(),Dy.startHighlighting(this,"ltr"===d(tb,this).direction,{target:d(Qw,this).div,x:t.x,y:t.y}),d(Qw,this).div.addEventListener("pointerup",(function(){d(Qw,e).div.classList.remove("free"),e.toggleDrawing(!0)}),{once:!0,signal:d(tb,this)._signal}),t.preventDefault()}}function rb(t){return lb._.get(d(tb,t).getMode())}function ab(t){var e=p(eb,this,rb);return e?new e.prototype.constructor(t):null}function sb(){var t=this.div.getBoundingClientRect(),e=t.x,n=t.y,i=t.width,r=t.height,a=Math.max(0,e),s=Math.max(0,n),o=(a+Math.min(window.innerWidth,e+i))/2-e,l=(s+Math.min(window.innerHeight,n+r))/2-n,u=D(this.viewport.rotation%180==0?[o,l]:[l,o],2);return{offsetX:u[0],offsetY:u[1]}}function ob(){var t,e=w(d(Gw,this).values());try{for(e.s();!(t=e.n()).done;){var n=t.value;n.isEmpty()&&n.remove()}}catch(i){e.e(i)}finally{e.f()}}b(nb,"_initialized",!1);var lb={_:new Map([og,Ym,Rw,Dy,yw].map((function(t){return[t._editorType,t]})))},ub=new WeakMap,hb=new WeakMap,cb=new WeakMap,db=new WeakSet,fb=function(){function t(e){var n=e.pageIndex;c(this,t),g(this,db),f(this,ub,null),f(this,hb,new Map),f(this,cb,new Map),this.pageIndex=n}return m(t,[{key:"setParent",value:function(t){if(d(ub,this)){if(d(ub,this)!==t){if(d(hb,this).size>0){var e,n=w(d(hb,this).values());try{for(n.s();!(e=n.n()).done;){var i=e.value;i.remove(),t.append(i)}}catch(r){n.e(r)}finally{n.f()}}v(ub,this,t)}}else v(ub,this,t)}},{key:"draw",value:function(e){var n,i,a=arguments.length>1&&arguments[1]!==undefined&&arguments[1],s=arguments.length>2&&arguments[2]!==undefined&&arguments[2],o=(mb._=(n=mb._,i=n++,n),i),l=r(db,this,pb).call(this),u=t._svgFactory.createElement("defs");l.append(u);var h=t._svgFactory.createElement("path");u.append(h);var c="path_p".concat(this.pageIndex,"_").concat(o);h.setAttribute("id",c),h.setAttribute("vector-effect","non-scaling-stroke"),a&&d(cb,this).set(o,h);var f=s?r(db,this,gb).call(this,u,c):null,v=t._svgFactory.createElement("use");return l.append(v),v.setAttribute("href","#".concat(c)),this.updateProperties(l,e),d(hb,this).set(o,l),{id:o,clipPathId:"url(#".concat(f,")")}}},{key:"drawOutline",value:function(e,n){var i,a,s=(mb._=(i=mb._,a=i++,i),a),o=r(db,this,pb).call(this),l=t._svgFactory.createElement("defs");o.append(l);var u=t._svgFactory.createElement("path");l.append(u);var h,c="path_p".concat(this.pageIndex,"_").concat(s);if(u.setAttribute("id",c),u.setAttribute("vector-effect","non-scaling-stroke"),n){var f=t._svgFactory.createElement("mask");l.append(f),h="mask_p".concat(this.pageIndex,"_").concat(s),f.setAttribute("id",h),f.setAttribute("maskUnits","objectBoundingBox");var v=t._svgFactory.createElement("rect");f.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");var p=t._svgFactory.createElement("use");f.append(p),p.setAttribute("href","#".concat(c)),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}var g=t._svgFactory.createElement("use");o.append(g),g.setAttribute("href","#".concat(c)),h&&g.setAttribute("mask","url(#".concat(h,")"));var y=g.cloneNode();return o.append(y),g.classList.add("mainOutline"),y.classList.add("secondaryOutline"),this.updateProperties(o,e),d(hb,this).set(s,o),s}},{key:"finalizeDraw",value:function(t,e){d(cb,this)["delete"](t),this.updateProperties(t,e)}},{key:"updateProperties",value:function(e,n){if(n){var i=n.root,a=n.bbox,s=n.rootClass,o=n.path,l="number"==typeof e?d(hb,this).get(e):e;if(l){if(i&&r(db,this,yb).call(this,l,i),a&&vb.call(t,l,a),s)for(var u=l.classList,h=0,c=Object.entries(s);h<c.length;h++){var f=D(c[h],2),v=f[0],p=f[1];u.toggle(v,p)}if(o){var g=l.firstChild.firstChild;r(db,this,yb).call(this,g,o)}}}}},{key:"updateParent",value:function(t,e){if(e!==this){var n=d(hb,this).get(t);n&&(d(ub,e).append(n),d(hb,this)["delete"](t),d(hb,e).set(t,n))}}},{key:"remove",value:function(t){d(cb,this)["delete"](t),null!==d(ub,this)&&(d(hb,this).get(t).remove(),d(hb,this)["delete"](t))}},{key:"destroy",value:function(){v(ub,this,null);var t,e=w(d(hb,this).values());try{for(e.s();!(t=e.n()).done;){t.value.remove()}}catch(n){e.e(n)}finally{e.f()}d(hb,this).clear(),d(cb,this).clear()}}],[{key:"_svgFactory",get:function(){return Or(this,"_svgFactory",new yv)}}])}();function vb(t,e){var n=D(e,4),i=n[0],r=n[1],a=n[2],s=n[3],o=t.style;o.top="".concat(100*r,"%"),o.left="".concat(100*i,"%"),o.width="".concat(100*a,"%"),o.height="".concat(100*s,"%")}function pb(){var t=Oi._svgFactory.create(1,1,!0);return d(ub,this).append(t),t.setAttribute("aria-hidden",!0),t}function gb(t,e){var n=Oi._svgFactory.createElement("clipPath");t.append(n);var i="clip_".concat(e);n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");var r=Oi._svgFactory.createElement("use");return n.append(r),r.setAttribute("href","#".concat(e)),r.classList.add("clip"),i}function yb(t,e){for(var n=0,i=Object.entries(e);n<i.length;n++){var r=D(i[n],2),a=r[0],s=r[1];null===s?t.removeAttribute(a):t.setAttribute(a,s)}}Oi=fb;var mb={_:0};globalThis._pdfjsTestingUtils={HighlightOutliner:iy},globalThis.pdfjsLib={AbortException:Ur,AnnotationEditorLayer:nb,AnnotationEditorParamsType:rr,AnnotationEditorType:ir,AnnotationEditorUIManager:lo,AnnotationLayer:Qp,AnnotationMode:er,AnnotationType:fr,build:Uf,ColorPicker:tv,createValidAbsoluteUrl:Dr,DOMSVGFactory:yv,DrawLayer:fb,FeatureTest:Vr,fetchData:aa,getDocument:$d,getFilenameFromUrl:ca,getPdfFilenameFromUrl:da,getRGB:ba,getUuid:$r,getXfaPageViewport:wa,GlobalWorkerOptions:Cc,ImageKind:dr,InvalidPDFException:Br,isDataScheme:ua,isPdfFile:ha,isValidExplicitDest:Iu,MathClamp:ea,noContextMenu:pa,normalizeUnicode:Zr,OPS:br,OutputScale:xa,PasswordResponses:Sr,PDFDataRangeTransport:lf,PDFDateString:ya,PDFWorker:wf,PermissionFlag:ar,PixelsPerInch:ra,RenderingCancelledException:la,ResponseException:jr,setLayerDimensions:_a,shadow:Or,SignatureExtractor:Jm,stopEvent:ga,SupportedImageMimeTypes:Sa,TextLayer:Bd,TouchManager:yl,updateUrlHash:Lr,Util:Xr,VerbosityLevel:wr,version:Hf,XfaLayer:mv},t.AbortException=Ur,t.AnnotationEditorLayer=nb,t.AnnotationEditorParamsType=rr,t.AnnotationEditorType=ir,t.AnnotationEditorUIManager=lo,t.AnnotationLayer=Qp,t.AnnotationMode=er,t.AnnotationType=fr,t.ColorPicker=tv,t.DOMSVGFactory=yv,t.DrawLayer=fb,t.FeatureTest=Vr,t.GlobalWorkerOptions=Cc,t.ImageKind=dr,t.InvalidPDFException=Br,t.MathClamp=ea,t.OPS=br,t.OutputScale=xa,t.PDFDataRangeTransport=lf,t.PDFDateString=ya,t.PDFWorker=wf,t.PasswordResponses=Sr,t.PermissionFlag=ar,t.PixelsPerInch=ra,t.RenderingCancelledException=la,t.ResponseException=jr,t.SignatureExtractor=Jm,t.SupportedImageMimeTypes=Sa,t.TextLayer=Bd,t.TouchManager=yl,t.Util=Xr,t.VerbosityLevel=wr,t.XfaLayer=mv,t.build=Uf,t.createValidAbsoluteUrl=Dr,t.fetchData=aa,t.getDocument=$d,t.getFilenameFromUrl=ca,t.getPdfFilenameFromUrl=da,t.getRGB=ba,t.getUuid=$r,t.getXfaPageViewport=wa,t.isDataScheme=ua,t.isPdfFile=ha,t.isValidExplicitDest=Iu,t.noContextMenu=pa,t.normalizeUnicode=Zr,t.setLayerDimensions=_a,t.shadow=Or,t.stopEvent=ga,t.updateUrlHash=Lr,t.version=Hf}));
